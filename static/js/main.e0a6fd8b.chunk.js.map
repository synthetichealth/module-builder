{"version":3,"sources":["reducers/library.js","templates/Templates.js","utils/stringUtils.js","reducers/analysis.js","reducers/editor.js","store.js","reducers/index.js","components/editor/Code.js","components/editor/Reaction.js","components/editor/String.js","components/editor/Goal.js","components/editor/ImagingStudyAttributes.js","components/editor/Conditional.js","components/editor/DirectTransition.js","components/editor/DistributedTransition.js","components/editor/ConditionalTransition.js","components/editor/ComplexTransition.js","components/editor/Table.js","components/editor/TableTransition.js","components/editor/Transition.js","templates/Tutorial.js","components/editor/AutoCompleteText.js","components/editor/Attributes.js","components/editor/State.js","components/editor/ModuleProperties.js","utils/graphviz.js","components/graph/ModuleGraph.js","components/menu/StyledDropZone.js","utils/localStorageHelpers.js","components/menu/LoadModule.js","components/menu/Download.js","components/editor/NavTabs.js","components/editor/cancel-button.png","transforms/Module.js","utils/keys.js","data/example_module.js","components/editor/JsonEditor.js","components/analysis/cancel-button.png","components/analysis/StateList.js","components/analysis/AttributeList.js","components/analysis/WarningList.js","components/analysis/RelatedList.js","containers/synthea-animated-logo.svg","containers/synthea-logo.png","actions/analysis.js","actions/editor.js","actions/router.js","actions/library.js","containers/Editor.js","containers/state-button.png","containers/statelist.png","containers/attribute-button.png","containers/warning-button.png","containers/related-button.png","containers/fullscreen.png","containers/Info.png","containers/code-button.png","containers/minimize-panel.png","App.js","serviceWorker.js","index.js"],"names":["initialState","modules","analysis","state","action","type","data","location","getTemplate","path","parsedPath","split","template","shift","reducedPath","join","typeVar","TypeTemplates","AttributeTemplates","TransitionTemplates","StateTemplates","ContainedTemplates","StructureTemplates","ModuleTemplates","length","_","cloneDeep","get","Date","Year","Month","Day","Hour","Minute","Second","Millisecond","Code","Snomed","system","code","display","Loinc","RxNorm","Nubc","DicomDCM","DicomSOP","Condition","Gender","condition_type","gender","Age","operator","quantity","unit","year","codes","Race","Symptom","Observation","PriorState","Attribute","And","Or","Not","Exact","ExactWithUnit","Range","low","high","RangeWithUnit","Prescription","dosage","amount","frequency","period","duration","Goal","addresses","value","Since","Within","UnnamedDistribution","NamedDistribution","attribute","default","Supply","ImagingStudy","Instance","title","sop_class","Series","body_site","modality","instances","Direct","Conditional","transition","condition","Distributed","distribution","Complex","distributions","Table","lookuptable","viewTable","lookup_table_name_ModuleBuilder","transitions","default_probability","lookup_table_name","Initial","Terminal","Simple","Guard","allow","Delay","SetAttribute","Counter","CallSubmodule","submodule","Encounter","encounter_class","reason","EncounterEnd","ConditionOnset","target_encounter","ConditionEnd","AllergyOnset","allergy_type","category","reactions","AllergyEnd","MedicationOrder","MedicationEnd","CarePlanStart","CarePlanEnd","Procedure","VitalSign","vital_sign","kind","parameters","round","MultiObservation","number_of_observations","DiagnosticReport","observations","procedure_code","series","symptom","cause","probability","Device","DeviceEnd","SupplyList","supplies","Death","exact","CheckYearly","conditional_transition","ActiveCondition","HasCondition","direct_transition","ConditionIncidence","RiskPerMonth","distributed_transition","AcquireCondition","GenderDifference","Male","Female","Common","ConditionVariation","VariantDistribution","Condition1","Condition2","Condition3","Join","MedicationVariation","Medication1","Medication2","Medication3","ChildrensDose","DosageDecision","AdultDose","MedicationsByYear","VariantsByYear","Medication4","ProcedureVariation","BeginEncounter","Procedure1","Observation1","Procedure2","Observation2","Procedure3","Observation3","Blank","name","remarks","states","Yearly","DeadAt40","DelayUntil40","normalizeType","trim","test","parseFloat","toLowerCase","cleanString","mapObj","Object","keys","reduce","acc","cur","libraryModuleCodes","warnings","libraryRelatedModules","relatedModules","attributes","module","forEach","stateName","push","stateType","assign_to_attribute","sort","a","b","x","y","templateCodes","map","c","placeholderCodeWarnings","message","o","instance","tableTransitionWarnings","undefined","lookup_table_transition","tableHasError","tableColumns","parseLookupTable","i","parsed","isNumber","toString","Papa","parse","header","complete","results","textOk","parseOk","gmfVersionWarnings","gmf_version","stateCollisionWarnings","globalCodes","equivalentStates","checkCollision","libraryState","local","first","second","filter","e","collisions","moduleKey","orphanStateWarnings","visitedStateCheck","visitNext","nextStateKey","pop","nextState","complex_transition","notVisitedWarnings","s","visited","v","moduleState","relatedBySubmodule","relatedMap","related","newState","selectedStateKey","selectedStateTransition","selectedModuleKey","loadModuleVisible","downloadVisible","selectedModulePanel","modulePanelVisible","history","clipboard","historyIndex","refreshCodeFlag","targetModuleKey","key","transitionIndex","targetNode","currentModuleKey","stateKey","selectedState","alteredState","oldTransitionPoint","complexTransitions","rightNode","t","nodes","dist","saveHistory","structureName","libraryModule","newModule","selectStateTransition","newModules","tempModule","values","update","id","set","splitPath","Array","isArray","parent","slice","unset","splice","newVal","fixStateReferences","transitionMapping","transitionName","transitionType","oldTransitionName","nodeName","paths","pathIndex","transitionTo","newName","newRemarks","newType","pick","targetPanel","flag","condition_onset","allergy_onset","medication_order","careplan","concat","enhancers","middleware","createBrowserHistory","basename","createAppStore","routerMiddleware","thunk","composedEnhancers","compose","applyMiddleware","createStore","combineReducers","router","connectRouter","library","editor","createRootReducer","this","props","value_set","className","propName","change","onChange","checkValueSetKey","Component","Codes","templates","onClick","val","Severity","level","text","options","editProps","step","min","max","format","formatAsPercentage","validate","checkInRange","num","Reaction","reaction","possible_severities","ps","renderWarning","StringEditor","label","StringsEditor","goal","renderObservation","renderText","observation","goalObservationValue","Goals","goals","InstanceList","SeriesList","unitOfTimeOptions","unitOfAgeOptions","ConditionalEditor","conditional","k","renderConditionalType","renderType","month","date","yearInput","monthInput","dayInput","day","hourInput","hour","minuteInput","minute","secondInput","millisecondInput","millisecond","SocioeconomicStatus","race","value_code","renderValueOrCodeValue","String","valueInput","ActiveAllergy","ActiveMedication","ActiveCarePlan","renderSince","renderWithin","since","within","conditions","cond","AtLeast","minimum","AtMost","maximum","DirectTransitionEditor","to","DistributedTransition","currentValue","renderDistribution","index","sum","remainder","remainderOption","ConditionalTransition","indexTo","indexFrom","oldEntry","clone","newEntry","swapItems","isLast","renderIf","renderUpDown","ComplexTransition","d","transitionEditor","newDistributedTransition","DirectTransition","nextTransition","newDirectTransition","renderTransition","columnHeaders","rows","columns","item","str","replace","width","rowGetter","rowsCount","minHeight","TableTransition","lookupTableName","buttonText","displayTable","displayTableError","fixMissingValues","doesDataHaveInputError","parseTextArea","msg","checkTable","displayTableView","Transition","BasicTutorial","selector","EditTutorial","AutoCompleteText","onFocusGained","target","items","suggestions","match","indexOf","regex","RegExp","setState","onSubmitted","timer","setTimeout","onBlur","clearTimeout","keyPressed","event","handleChange","bind","suggestionSelected","onFocus","onKeyDown","renderSuggestions","React","StateEditor","updateRemarks","el","typeOptions","renameNode","changeType","renderStateType","addTransition","otherStates","helpFunction","Distribution","mean","standardDeviation","otherToggles","Uniform","Gaussian","form","legacyGMF","renderLegacyExactOrRange","renderExactOrRange","range","toggleLabel","displayLabel","handleTextChange","handleSubmit","lastSubmitted","fixTextBox","displayAttribute","valueForm","renderLegacyValueOrRange","renderValueContainer","AttributeData","others","moduleName","read","write","displayAttributes","Attributes","save","href","window","hash","wellness","renderWellness","renderReason","allOptions","classNameName","renderDischargeDisposition","discharge_disposition","renderTargetEncounter","renderAssignToAttribute","targetEncounter","referenced_by_attribute","renderConditionOnset","renderReferencedByAttribute","renderCodes","renderReactions","r","renderAllergyOnset","toggleLabelReason","displayLabelReason","handleTextChangeReason","handleSubmitReason","valueReason","lastSubmittedReason","renderPrescription","renderChronicMed","renderCreateAdministration","checked","chronic","administration","prescription","renderRefills","renderAsNeeded","renderDosage","renderDuration","renderInstructions","refills","as_needed","instructions","renderMedicationOrder","renderActivities","renderGoals","activities","renderCarePlan","durationEditor","renderLegacyDuration","distroForm","renderToggles","attachment","sampled_data","propsToClear","currentItem","console","log","toggles","clearProps","observationCount","renderProbability","renderCause","classInvalid","supplyCount","supply","renderSupply","renderManufacturer","renderModel","manufacturer","model","renderDevice","unshift","device","ModulePropertiesEditor","onRemarksChange","newval","generateDOT","relatedStates","findTransitions","assign","nodesAsDOT","transitionsAsDOT","node","escapeId","shape","style","fillcolor","fontcolor","details","stateDescription","escapeLabel","params","escapeName","escapedName","out_transitions","transitionClassName","distLabel","pct","cnd","logicDetails","nodeHighlighted","trans","distributionString","distro","p","primarySeries","primaryModality","primaryBodySite","vs","unitv","diagType","diagValue","diagUnits","supplyQuantity","supplyCode","system_val","escapeVerticalBar","code_val","display_val","valuSet_val","verb","activity","logic","obs","findReferencedType","leaveUndefinedBlank","threshold","subsOr","prior_description","plan","med","alg","obj","ret","children","inputStr","ModuleGraph","onPanZoom","onMouseUp","onMouseDown","bold","lastDOT","writeSVG","mount","addEventListener","nextProps","panZoomSettings","fullscreen","svgPanZoom","panBy","customPanBy","blockPanZoomEvent","zoom","pan","animationStep","intervalID","stepX","animationTime","stepY","setInterval","clearInterval","ref","height","xmlns","opacity","patternUnits","fill","stroke","strokeWidth","fireClickOnMouseUp","getPan","getZoom","setAttribute","linesShouldBold","Math","originalWidth","originalHeight","dot","innerHTML","Viz","svgDefs","ex","alert","svg","document","getElementById","stopPropagation","removeAttribute","unnecessaryGTitle","querySelector","remove","unnecessaryFill","querySelectorAll","group","originator","hitLine","cloneNode","transitionIndexClass","baseVal","find","startsWith","parseInt","appendChild","getAttribute","Number","offsetLeft","getBoundingClientRect","offsetTop","visibleWidth","visibleHeight","zoomFactor","controlIconsEnabled","minZoom","onPan","onZoom","panZoomControlsElement","zoomIn","zoomOut","pow","baseStyle","flex","flexDirection","alignItems","padding","borderWidth","borderRadius","marginBottom","borderColor","borderStyle","backgroundColor","outline","activeStyle","color","acceptStyle","cursor","rejectStyle","StyledDropzone","useDropzone","accept","onDrop","getRootProps","getInputProps","isDragActive","isDragAccept","isDragReject","useMemo","LOCAL_STORAGE_KEY","getLocalStorageModules","existingModules","localStorage","getItem","JSON","LoadModule","loadModule","json","Error","tableMessage","lttWrapper","substr","selectedOption","files","file","reader","FileReader","onload","result","readAsText","onLoadJSON","onOptionClick","updateJson","renderFooter","loadButton","data-dismiss","closeButton","welcome","onHide","renderDetails","n","colsize","Modules","Submodules","Branches","localStorageModules","moduleEntry","stringify","timestamp","aria-label","setItem","removeLocalStorageModule","updateLocalStorageModules","aria-hidden","renderWelcomeMessage","ID","list","fetch","then","response","branch","changeColor","fetchModuleList","catch","error","currentBranch","mapFolderContentsToList","aIsFile","endsWith","localeCompare","isFile","displayName","fetchFile","fetchFolder","prevProps","prevState","fetchBranchList","classDetails","visible","marginLeft","marginRight","marginTop","Download","saveToLocalStorage","shouldSave","localStorageModule","confirm","newModuleObject","toLocaleString","saveLocalStorageModule","saveSuccess","onDownload","blob","Blob","refs","codeInput","downloadCsvs","filename","FileSaver","saveAs","downloadCsv","encodeURIComponent","element","createElement","body","click","removeChild","role","disabled","prepareJSON","NavTabs","onChangeModule","onClose","onCloseModule","m","src","alt","extractStates","extractDirectTransition","extractDistributedTransition","extractConditionalTransition","extractComplexTransition","extractTableTransition","extractTransition","uuid","create","extractState","findAvailableKey","root","keys_index","next","matches","exec","createSafeKeyFromName","JsonEditor","mode","ace","StateList","search","includes","placeholder","CancelButton","clearSearch","scope","stateFilter","AttributeList","onSelect","option","loadSelectedModule","attributeFilter","dropDown","WarningList","warning","RelatedList","analyze","dispatchThenAnalyze","dispatch","getState","addGMFVersion","refreshCode","selectNode","addNode","addStructure","editNode","copyNode","jsonEdit","closeModule","editModuleName","editModuleRemarks","changeStateType","undo","redo","showLoadModule","hideLoadModule","showDownload","hideDownload","changeModulePanel","openModule","loadLibrary","charAt","Editor","pasteNode","takenKeys","startTutorial","steps","joyride","reset","run","renderAddStateButton","data-tip","renderUndoButton","undoEnabled","renderRedoButton","redoEnabled","renderDownloadButton","renderDeleteButton","renderCopyButton","renderPasteButton","renderStateEditor","moduleStates","leftNavClick","renderDownload","renderLoadModule","renderModulePropertiesEditor","renderModuleGraph","onPanelResize","panelWidth","deltaX","onPanelResizeDone","renderPanelContent","renderStateButton","dataTip","renderStateListButton","stateCount","renderAttributesButton","attributesCount","renderWarningButton","warningCount","renderRelatedModulesButton","relatedCount","nav","renderNav","SyntheaLogo","renderMainEditor","left","axis","onDrag","onStop","bounds","top","right","Infinity","bottom","originalPanelWidth","LoadingLogo","stepIndex","examplitis","ReactTooltip","rebuild","effect","delayShow","showOverlay","showSkipButton","showStepsProgress","autoStart","debug","allowClicksThruHole","keyboardNavigation","connect","bindActionCreators","store","dispatchLocationChange","listen","App","component","Boolean","hostname","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.e0a6fd8b.chunk.js","sourcesContent":["const initialState = {modules: {}, analysis: {}};\n\nexport default (state = initialState, action) => {\n  let newState = null;\n  switch (action.type) {\n    case 'LOAD_LIBRARY':\n      newState = {...state, modules: {...action.data}, location: action.location}\n      return newState\n\n    default:\n      return state;\n  }\n}\n","import _ from 'lodash';\n\n// do not allow direct access because it is easy to forget to clone these templates\nexport function getTemplate(path){\n\n  const parsedPath = path.split('.')\n  const template = parsedPath.shift();\n  const reducedPath = parsedPath.join('.')\n\n  let typeVar = null;\n  switch(template){\n    case 'Type':\n      typeVar = TypeTemplates;\n      break;\n\n    case 'Attribute':\n      typeVar = AttributeTemplates;\n      break;\n\n    case 'Transition':\n      typeVar = TransitionTemplates;\n      break;\n\n    case 'State':\n      typeVar = StateTemplates;\n      break;\n\n    case 'Contained':\n      typeVar = ContainedTemplates;\n      break;\n\n    case 'Structure':\n      typeVar = StructureTemplates;\n      break;\n\n    case 'Module':\n      typeVar = ModuleTemplates;\n      break;\n    default:\n      break;\n  }\n\n\n  if(reducedPath.length === 0){\n    return typeVar\n  }\n\n  return _.cloneDeep(_.get(typeVar, reducedPath));\n}\n\nconst TypeTemplates = {\n  Date: {\n    Year: 2000,\n    Month: 12,\n    Day: 25,\n    Hour: 0,\n    Minute: 0,\n    Second: 0,\n    Millisecond: 0\n  },\n  Code: {\n    Snomed: {\n      system: \"SNOMED-CT\",\n      code: \"1234\",\n      display: \"SNOMED Code\"\n    },\n    Loinc: {\n      system: \"LOINC\",\n      code: \"1234\",\n      display: \"LOINC Code\"\n    },\n    RxNorm: {\n      system: \"RxNorm\",\n      code: \"1234\",\n      display: \"RxNorm Code\"\n    },\n    Nubc: {\n      system: \"NUBC\",\n      code: \"1234\",\n      display: \"NUBC Code\"\n    },\n    DicomDCM: {\n      system: \"DICOM-DCM\",\n      code: \"XX\",\n      display: \"DICOM Modality Code\"\n    },\n    DicomSOP: {\n      system: \"DICOM-SOP\",\n      code: \"1.2.3.4.5.6.7.8\",\n      display: \"DICOM Subject-Object Pair Code\"\n    }\n  },\n\n  Condition: {\n    Gender: {\n      condition_type: 'Gender',\n      gender: 'F'\n    },\n    Age: {\n      condition_type: 'Age',\n      operator: \">\",\n      quantity: 0,\n      unit: \"years\"\n    },\n    Date: {\n      condition_type: 'Date',\n      operator: \">\",\n      year: 2000,\n    },\n    \"Active Condition\": {\n      condition_type: 'Active Condition',\n      codes: [{\n        system: \"SNOMED-CT\",\n        code: \"1234\",\n        display: \"SNOMED Code\"\n      }],\n    },\n    \"Socioeconomic Status\": {\n        \"condition_type\": \"Socioeconomic Status\",\n        \"category\": \"Middle\"\n    },\n    Race: {\n      \"condition_type\": \"Race\",\n      \"race\": \"Hispanic\"\n    },\n    Symptom: {\n      \"condition_type\": \"Symptom\",\n      \"symptom\" : \"Chest Pain\",\n      \"operator\": \">=\",\n      \"value\": 50\n    },\n    Observation: {\n      \"condition_type\": \"Observation\",\n      \"codes\": [\n        {\n          \"system\": \"LOINC\",\n          \"code\": \"72107-6\",\n          \"display\": \"Mini Mental State Examination\"\n        }\n      ],\n      \"operator\": \"==\",\n      \"value\": 0\n    },\n    \"Vital Sign\": {\n        \"condition_type\" : \"Vital Sign\",\n        \"vital_sign\" : \"Systolic Blood Pressure\",\n        \"operator\" : \">\",\n        \"value\" : 120\n    },\n    \"Active Allergy\": {\n      \"condition_type\": \"Active Allergy\",\n      \"codes\": [\n        {\n          \"system\": \"RxNorm\",\n          \"code\": \"7984\",\n          \"display\": \"Penicillin V\"\n        }\n      ]\n    },\n    \"Active Medication\": {\n      \"condition_type\": \"Active Medication\",\n      \"codes\": [\n        {\n          \"system\": \"RxNorm\",\n          \"code\": \"849727\",\n          \"display\": \"Naproxen sodium 220 MG [Aleve]\"\n        }\n      ]\n    },\n    \"Active CarePlan\": {\n      \"condition_type\": \"Active CarePlan\",\n      \"codes\": [\n        {\n          \"system\": \"SNOMED-CT\",\n          \"code\": \"698360004\",\n          \"display\": \"Diabetes self management plan\"\n        }\n      ]\n    },\n    PriorState: {\n      \"condition_type\": \"PriorState\",\n      \"name\": \"\"\n    },\n    Attribute: {\n      \"condition_type\": \"Attribute\",\n      \"attribute\": \"opiod_prescription\",\n      \"operator\": \"==\",\n      \"value\": \"Vicodin\"\n    },\n    And: {\n      \"condition_type\": \"And\",\n      \"conditions\": [\n        {\n          \"condition_type\": \"Gender\",\n          \"gender\": \"M\"\n        },\n        {\n          \"condition_type\": \"Age\",\n          \"operator\": \">=\",\n          \"quantity\": 40,\n          \"unit\": \"years\"\n        }\n      ]\n    },\n    Or: {\n      \"condition_type\": \"Or\",\n      \"conditions\": [\n        {\n          \"condition_type\": \"Gender\",\n          \"gender\": \"M\"\n        },\n        {\n          \"condition_type\": \"Age\",\n          \"operator\": \">=\",\n          \"quantity\": 40,\n          \"unit\": \"years\"\n        }\n      ]\n    },\n    \"At Least\" : {\n      \"condition_type\": \"At Least\",\n      \"minimum\": 2,\n      \"conditions\": [\n        {\n          \"condition_type\": \"Gender\",\n          \"gender\": \"M\"\n        },\n        {\n          \"condition_type\": \"Age\",\n          \"operator\": \">=\",\n          \"quantity\": 40,\n          \"unit\": \"years\"\n        },\n        {\n          \"condition_type\" : \"Active CarePlan\",\n          \"codes\": [\n            {\n              \"system\": \"SNOMED-CT\",\n              \"code\": \"698360004\",\n              \"display\": \"Diabetes self management plan\"\n            }\n          ]\n        }\n      ]\n    },\n    \"At Most\": {\n      \"condition_type\": \"At Most\",\n      \"maximum\" : 2,\n      \"conditions\": [\n        {\n          \"condition_type\": \"Gender\",\n          \"gender\": \"M\"\n        },\n        {\n          \"condition_type\": \"Age\",\n          \"operator\": \">=\",\n          \"quantity\": 40,\n          \"unit\": \"years\"\n        },\n        {\n          \"condition_type\": \"Active CarePlan\",\n          \"codes\": [\n            {\n              \"system\": \"SNOMED-CT\",\n              \"code\": \"698360004\",\n              \"display\": \"Diabetes self management plan\"\n            }\n          ]\n        }\n      ]\n    },\n    Not: {\n      \"condition_type\": \"Not\",\n      \"condition\": {\n        \"condition_type\": \"Gender\",\n        \"gender\": \"M\"\n      }\n    },\n    \"True\": {\n      condition_type: \"True\"\n    },\n    \"False\": {\n      condition_type: \"False\"\n    }\n  }\n}\n\nconst AttributeTemplates = {\n  Exact: {\n    quantity: 1\n  },\n  ExactWithUnit: {\n    quantity: 1,\n    unit: \"days\"\n  },\n  Range: {\n    low: 1,\n    high: 2,\n  },\n  RangeWithUnit: {\n    low: 1,\n    high: 2,\n    unit: \"days\"\n  },\n  Prescription: {\n    dosage: {\n      amount: 1,\n      frequency: 1,\n      period: 1,\n      unit: \"days\"\n    },\n    duration: {\n      quantity: 1,\n      unit: \"days\"\n    }\n  },\n  Goal: {\n    addresses: [\"text\"]\n  },\n  Observation: {\n    codes: [{...TypeTemplates.Code.Loinc}],\n    operator: \"==\",\n    value: 1\n  },\n  Since: \" \",\n  Within: {\n    quantity: 1,\n    unit: \"days\"\n  },\n  UnnamedDistribution: 1.0,\n  NamedDistribution: {\n    attribute: \"attribute\",\n    default: 1.0\n  },\n  Supply: {\n    quantity: 1,\n    code: {...TypeTemplates.Code.Snomed}\n  },\n\n  ImagingStudy: {\n    Instance: {\n      title: \"Title of this image\",\n      sop_class: {...TypeTemplates.Code.DicomSOP}\n    },\n    Series: {\n      body_site: {...TypeTemplates.Code.Snomed},\n      modality: {...TypeTemplates.Code.DicomDCM},\n      instances: [{\n        title: \"Title of this image\",\n        sop_class: {...TypeTemplates.Code.DicomSOP}\n      }]\n    }\n  }\n}\n\n\nconst TransitionTemplates = {\n  Direct: 'Initial',\n  Conditional: [{transition: 'Initial', condition: {...TypeTemplates.Condition.Age}}],\n  Distributed: [{transition: 'Initial', distribution: 1.0}],\n  Complex: [{condition: {...TypeTemplates.Condition.Age}, distributions: [{transition: 'Initial', distribution: 1.0}]}],\n  Table: {\n    type: 'Table',\n    lookuptable: 'age,Initial,Terminal\\n0-50,.1,.9\\n51-140,.4,.6',\n    viewTable: true,\n    lookup_table_name_ModuleBuilder: 'file.csv',\n    transitions:[{transition: 'Initial', default_probability: 1.0, lookup_table_name: 'table.csv'}]\n  }\n}\n\nconst StateTemplates = {\n  Initial: {\n    type: \"Initial\",\n  },\n\n  Terminal: {\n    type: \"Terminal\",\n  },\n\n  Simple: {\n    type: \"Simple\",\n  },\n\n  Guard: {\n    type: \"Guard\",\n    allow: {...TypeTemplates.Condition.Age}\n  },\n\n  Delay: {\n    type: \"Delay\",\n    distribution: {\"kind\": \"EXACT\",\n                   \"parameters\": {\n                     \"value\": 1\n                   }\n    },\n    \"unit\": \"years\"\n  },\n\n  SetAttribute: {\n    type: \"SetAttribute\",\n    attribute: \"\"\n  },\n\n  Counter: {\n    type: \"Counter\",\n    attribute: \"\",\n    action: \"increment\"\n  },\n\n  CallSubmodule: {\n    type: \"CallSubmodule\",\n    submodule: \"\"\n  },\n\n  Encounter: {\n    type: \"Encounter\",\n    encounter_class: \"ambulatory\",\n    reason: \"\",\n    codes: [{...TypeTemplates.Code.Snomed}]\n  },\n\n  EncounterEnd: {\n    type: \"EncounterEnd\"\n  },\n\n  ConditionOnset: {\n    type: \"ConditionOnset\",\n    target_encounter: \"\",\n    codes: [{...TypeTemplates.Code.Snomed}]\n  },\n\n  ConditionEnd: {\n    type: \"ConditionEnd\"\n  },\n\n  AllergyOnset: {\n    allergy_type: \"allergy\",\n    category: \"food\",\n    type: \"AllergyOnset\",\n    target_encounter: \"\",\n    codes: [{...TypeTemplates.Code.Snomed}],\n    reactions: []\n  },\n\n  AllergyEnd: {\n    type: \"AllergyEnd\"\n  },\n\n  MedicationOrder: {\n    type: \"MedicationOrder\",\n    codes: [{...TypeTemplates.Code.RxNorm}]\n  },\n\n  MedicationEnd: {\n    type: \"MedicationEnd\"\n  },\n\n  CarePlanStart: {\n    type: \"CarePlanStart\",\n    codes: [{...TypeTemplates.Code.Snomed}]\n  },\n\n  CarePlanEnd: {\n    type: \"CarePlanEnd\"\n  },\n\n  Procedure: {\n    type: \"Procedure\",\n    codes: [{...TypeTemplates.Code.Snomed}],\n    distribution: {\n      \"kind\": \"UNIFORM\",\n      \"parameters\": {\n        \"high\": 60,\n        \"low\": 30\n      }\n    },\n    \"unit\": \"minutes\"\n  },\n\n  VitalSign: {\n    type: \"VitalSign\",\n    vital_sign: \"\",\n    unit: \"\",\n    distribution: {kind: \"EXACT\", parameters: {value: 1}}\n  },\n\n  Observation: {\n    type: \"Observation\",\n    category: \"vital-signs\",\n    unit: \"\",\n    codes: [{...TypeTemplates.Code.Loinc}],\n    distribution: {kind: \"EXACT\", round: false, parameters: {value: 1}}\n  },\n\n  MultiObservation: {\n    type: \"MultiObservation\",\n    category: \"vital-signs\",\n    number_of_observations: 0,\n    codes: [{...TypeTemplates.Code.Loinc}]\n  },\n\n  DiagnosticReport: {\n    type: \"DiagnosticReport\",\n    codes: [{...TypeTemplates.Code.Loinc}],\n    observations: []\n  },\n\n  ImagingStudy: {\n    type: \"ImagingStudy\",\n    procedure_code: {...TypeTemplates.Code.Snomed},\n    series: [{...AttributeTemplates.ImagingStudy.Series}]\n  },\n\n  Symptom: {\n    type: \"Symptom\",\n    symptom: \"\",\n    cause: \"\",\n    probability: 1.0,\n    distribution: {kind: \"EXACT\", parameters: {value: 1}}\n  },\n\n  Device: {\n    type: \"Device\",\n    code: {...TypeTemplates.Code.Snomed}\n  },\n\n  DeviceEnd: {\n    type: \"DeviceEnd\"\n  },\n\n  SupplyList: {\n    type: \"SupplyList\",\n    supplies: [{...AttributeTemplates.Supply}]\n  },\n\n  Death: {\n    type: \"Death\",\n    exact: {...AttributeTemplates.ExactWithUnit}\n  }\n}\n\nconst ContainedTemplates = {\n  Observation: {\n    category: \"laboratory\",\n    unit: \"\",\n    codes: [{...TypeTemplates.Code.Loinc}],\n    exact: {...AttributeTemplates.Exact}\n  }\n}\n\nconst StructureTemplates = {\n  CheckYearly: {\n    CheckYearly: {...StateTemplates.Delay, exact: {...TypeTemplates.exact, quantity: 1, unit: 'years'},\n      conditional_transition: [{transition: 'HasCondition', condition: {...TypeTemplates.Condition.ActiveCondition}},{transition: 'CheckYearly'}]},\n    HasCondition: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  },\n\n  ConditionIncidence: {\n    RiskPerMonth: {...StateTemplates.Delay, exact: {...TypeTemplates.exact, quantity: 1, unit: 'months'},\n      distributed_transition: [{distribution: 0.99, transition: 'RiskPerMonth'},{distribution: 0.01, transition: 'AcquireCondition'}]},\n    AcquireCondition: {...StateTemplates.ConditionOnset, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Terminal'}\n  },\n\n  GenderDifference: {\n    GenderDifference: {...StateTemplates.Simple,\n          conditional_transition: [\n            {condition: {...TypeTemplates.Condition.Gender, gender: 'M'}, transition: 'Male'},\n            {condition: {...TypeTemplates.Condition.Gender, gender: 'F'}, transition: 'Female'}]},\n    Male: {...StateTemplates.Simple, direct_transition: 'Common'},\n    Female: {...StateTemplates.Simple, direct_transition: 'Common'},\n    Common: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  },\n\n  ConditionVariation: {\n    VariantDistribution: {...StateTemplates.Simple,\n      distributed_transition:[{distribution: 0.25, transition: 'Condition1'},{distribution: 0.35, transition: 'Condition2'},{distribution: 0.40, transition: 'Condition3'}]},\n    Condition1: {...StateTemplates.ConditionOnset, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Join'},\n    Condition2: {...StateTemplates.ConditionOnset, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Join'},\n    Condition3: {...StateTemplates.ConditionOnset, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Join'},\n    Join: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  },\n\n  MedicationVariation: {\n    VariantDistribution: {...StateTemplates.Simple,\n      distributed_transition:[{distribution: 0.25, transition: 'Medication1'},{distribution: 0.35, transition: 'Medication2'},{distribution: 0.40, transition: 'Medication3'}]},\n    Medication1: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Medication2: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Medication3: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Join: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  },\n\n  ChildrensDose: {\n    DosageDecision: {...StateTemplates.Simple,\n          conditional_transition: [\n            {condition: {...TypeTemplates.Condition.Age, operator: '>=', quantity: 18, unit: 'years'}, transition: 'AdultDose'},\n            {transition: 'ChildrensDose'}]},\n    AdultDose: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    ChildrensDose: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Join: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  },\n\n  MedicationsByYear: {\n    VariantsByYear: {...StateTemplates.Simple,\n          conditional_transition: [\n            {condition: {...TypeTemplates.Condition.Date, operator: '>=', year: 2007}, transition: 'Medication1'},\n            {condition: {...TypeTemplates.Condition.Date, operator: '>=', year: 1992}, transition: 'Medication2'},\n            {condition: {...TypeTemplates.Condition.Date, operator: '>=', year: 1978}, transition: 'Medication3'},\n            {transition: 'Medication4'}]},\n    Medication1: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Medication2: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Medication3: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Medication4: {...StateTemplates.MedicationOrder, codes:[{system: 'RxNorm', code: '', display: ''}], direct_transition: 'Join'},\n    Join: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  },\n\n  ProcedureVariation: {\n    BeginEncounter: {...StateTemplates.Encounter, codes:[{system: 'SNOMED-CT', code: '', display: ''}],\n      distributed_transition:[{distribution: 0.25, transition:'Procedure1'},{distribution: 0.35, transition:'Procedure2'},{distribution: 0.40, transition:'Procedure3'}]},\n    Procedure1: {...StateTemplates.Procedure, codes:[{system: 'LOINC', code: '', display: ''}], direct_transition: 'Observation1'},\n    Observation1: {...StateTemplates.Observation, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Join'},\n    Procedure2: {...StateTemplates.Procedure, codes:[{system: 'LOINC', code: '', display: ''}], direct_transition: 'Observation2'},\n    Observation2: {...StateTemplates.Observation, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Join'},\n    Procedure3: {...StateTemplates.Procedure, codes:[{system: 'LOINC', code: '', display: ''}], direct_transition: 'Observation3'},\n    Observation3: {...StateTemplates.Observation, codes:[{system: 'SNOMED-CT', code: '', display: ''}], direct_transition: 'Join'},\n    Join: {...StateTemplates.Simple, direct_transition: 'Terminal'}\n  }\n}\n\nconst ModuleTemplates = {\n  Blank: {\n    name: \"Untitled\",\n    remarks: [\"A blank module\"],\n    states: {\n      Initial: {...StateTemplates.Initial, direct_transition: 'Terminal'},\n      Terminal: {...StateTemplates.Terminal}\n    }\n  },\n\n  Yearly: {\n    name: \"Yearly Check for Condition\",\n    remarks: [\"Check yearly for patient to have a condition\"],\n    states: {\n      ...StructureTemplates.CheckYearly,\n      Initial: {...StateTemplates.Initial, direct_transition: 'CheckYearly'},\n      Terminal: {...StateTemplates.Terminal}\n    }\n  },\n\n  DeadAt40: {\n    name: \"Dead At 40\",\n    remarks: [\"This module is an example of writing a template\"],\n    states: {\n      Initial: {...StateTemplates.Initial, direct_transition: 'DelayUntil40'},\n      DelayUntil40: {...StateTemplates.Delay, exact: {...TypeTemplates.exact, quantity: 40, unit: 'years'}, direct_transition: 'Death'},\n      Death: {...StateTemplates.Death, direct_transition: 'Terminal'},\n      Terminal: {...StateTemplates.Terminal}\n    }\n  }\n}\n","// Converts strings that contain numbers or booleans into their corresponding type\n// because that is what GMF expects\n\nexport function normalizeType(value){\n  if(typeof value !== 'string'){\n    return value;\n  }\n  value = value.trim();\n  if(/^-?\\d*[\\.]?\\d+$/.test(value) && (parseFloat(value) || parseFloat(value) === 0)){\n    value = parseFloat(value);\n  }\n  if(/^(true|false)$/i.test(value)){\n    value = value.toLowerCase() === 'true';\n  }\n  return value\n}\n\nexport function cleanString(value, mapObj){\n  return Object.keys(mapObj).reduce( (acc, cur) => acc.split(cur).join(mapObj[cur]), value)\n}\n","import _ from 'lodash'\nimport { getTemplate } from '../templates/Templates'\nimport Papa from 'papaparse'\nimport { isNumber } from 'util';\nimport { stat } from 'fs';\n\nconst initialState = {\n  libraryModuleCodes: {}, // list types of nodes\n  warnings: [],\n  libraryRelatedModules: {},\n  relatedModules: [],\n  attributes: []\n};\n\nexport const CURRENT_GMF_VERSION = 2.0;\n\nconst attributes = module => {\n  const attributes = [];\n  Object.keys(module.states).forEach(stateName => {\n    let state = module.states[stateName];\n\n     if(state.type === 'SetAttribute'){\n       attributes.push({attribute: state.attribute, stateName: state.name, stateType: state.type});\n     } else if(state.assign_to_attribute){\n       attributes.push({attribute: state.assign_to_attribute, stateName: state.name, stateType: state.type});\n     }\n  });\n\n  return attributes.sort(function(a, b){\n    var x = a.attribute.toLowerCase();\n    var y = b.attribute.toLowerCase();\n    if (x < y) {return -1;}\n    if (x > y) {return 1;}\n    return 0;\n  })\n}\n\nconst templateCodes = {};\nObject.keys(getTemplate('Type').Code).map(c => getTemplate('Type').Code[c]).forEach(code => {\n  templateCodes[`${code.code}-${code.system}-${code.display}`] = true;\n});\n\nconst placeholderCodeWarnings = (module) => {\n  const warnings = [];\n  Object.keys(module.states).forEach(stateName => {\n    let state = module.states[stateName];\n    state.codes && state.codes.forEach(code => {\n      if(templateCodes[`${code.code}-${code.system}-${code.display}`]){\n        warnings.push({stateName: stateName, message: 'Code uses an invalid template code: ' + code.system + '[' + code.code + ']'});\n      }\n    });\n\n    switch(state.type){\n      case 'MultiObservation':\n      case 'DiagnosticReport':\n        if(state.observations){\n          state.observations.forEach(o => {\n          o.codes && o.codes.forEach(code => {\n            if(templateCodes[`${code.code}-${code.system}-${code.display}`]){\n              warnings.push({stateName: stateName, message: 'Code in observation uses an invalid template code: ' + code.system + '[' + code.code + ']'});\n            }\n          })\n        })}\n\n        break;\n      case 'ImagingStudy':\n        if(state.procedure_code){\n            if(templateCodes[`${state.procedure_code.code}-${state.procedure_code.system}-${state.procedure_code.display}`]){\n              warnings.push({stateName: stateName, message: 'Code in procedure code uses an invalid template code: ' + state.procedure_code.system + '[' + state.procedure_code.code + ']'});\n            }\n        }\n        if(state.series ){\n          state.series.forEach(series => {\n            if(series.body_site){\n              if(templateCodes[`${series.body_site.code}-${series.body_site.system}-${series.body_site.display}`]){\n                warnings.push({stateName: stateName, message: 'Code in imaging series uses an invalid template code: ' + series.body_site.system + '[' + series.body_site.code + ']'});\n              }\n            }\n            if(series.modality){\n              if(templateCodes[`${series.modality.code}-${series.modality.system}-${series.modality.display}`]){\n                warnings.push({stateName: stateName, message: 'Code in imaging series uses an invalid template code: ' + series.modality.system + '[' + series.modality.code + ']'});\n              }\n            }\n            if(series.instances){\n              series.instances.forEach(instance => {\n                if(instance.sop_class){\n                  if(templateCodes[`${instance.sop_class.code}-${instance.sop_class.system}-${instance.sop_class.display}`]){\n                    warnings.push({stateName: stateName, message: 'Code in imaging series uses an invalid template code: ' + instance.sop_class.system + '[' + instance.sop_class.code + ']'});\n                  }\n                }\n              })\n            }\n\n          })\n\n        }\n        break;\n      default:\n        break;\n\n\n    }\n  })\n  return warnings;\n\n}\n\nconst tableTransitionWarnings = (module) => {\n\n  const warnings = [];\n\n  Object.keys(module.states).forEach(stateName => {\n    let state = module.states[stateName];\n\n    // find table transitions and check table data\n    if (state.lookup_table_transition !== undefined){\n      let message = '';\n      if(state.lookup_table_transition.lookup_table_name_ModuleBuilder === \"\"){\n        message = 'Invalid filename ';\n      }\n      if (state.lookup_table_transition.lookuptable === \"Enter table\" || tableHasError(state.lookup_table_transition.lookuptable) ) {\n        if (message === ''){\n          message = 'Invalid data ';\n        } else {\n          message += 'and invalid data '\n        }\n      }\n      // check the last X columns vs X transitions\n      if (!tableHasError(state.lookup_table_transition.lookuptable)){\n        let tableColumns = [];\n        let data = parseLookupTable(state.lookup_table_transition.lookuptable);\n        if (data.length > 0){\n          tableColumns = Object.keys(data[0]);\n        }\n\n        for (let i = 0; i < state.lookup_table_transition.transitions.length; i++)\n        {\n          let transition = state.lookup_table_transition.transitions[state.lookup_table_transition.transitions.length - i - 1].transition;\n          let column = tableColumns[tableColumns.length-i -1];\n          if (transition != column)\n          {\n            if (message === '')\n            {\n              message += 'Invalid columns (table data and transitions to state don\\'t match) '\n            } else {\n              message += ' and invalid columns (table data and transitions to states don\\'t match) '\n            }\n            break;\n          }\n        }\n      }\n\n      if (message !== ''){\n        message += 'for table in ';\n        warnings.push({stateName, message: message + stateName + '. '});\n      }\n    }\n  });\n\n  return warnings;\n}\n\nconst parseLookupTable = (data) => {\n  let parsed;\n  if (isNumber(data))\n  {\n    data  = data.toString();\n  }\n  Papa.parse(data, {\n  header: true,\n  complete: function(results) {\n    parsed=results;\n  }\n  });\n\n  return parsed.data;\n}\n\nconst tableHasError = (lookuptable) =>{\n  let data = parseLookupTable(lookuptable);\n  let textOk = !(lookuptable == 'Enter table' || lookuptable == '')\n  let parseOk = (data.length > 0 && Object.keys(data[0]).length > 0)\n if (textOk && parseOk ){\n    return false;\n  } else {\n    return true;\n  }\n}\n\nconst gmfVersionWarnings = (module) => {\n  if(module.gmf_version === undefined || module.gmf_version < CURRENT_GMF_VERSION) {\n    return [{stateName: 'None', message: 'Module is using an older or undeclared version of GMF'}];\n  } else {\n    return [];\n  }\n}\n\nconst stateCollisionWarnings = (module, globalCodes) => {\n  const equivalentStates = [\n   ['MedicationOrder', 'MedicationEnd'],\n   ['ConditionOnset', 'ConditionEnd'],\n   ['CarePlanStart', 'CarePlanEnd'],\n   ['AllergyOnset', 'AllergyEnd'],\n  ];\n\n  const isEquivalentStates = (first, second) => {\n    return (first === second || equivalentStates.filter(e => (e[0] === first && e[1] === second) || (e[0] === second && e[1] === first)).length > 0)\n  }\n\n  const checkCollision = libraryState =>  (local => !isEquivalentStates(local.state.type, libraryState.type) && local.state.type !== 'Death' && libraryState.type !== 'Death');\n\n  const warnings = [];\n  Object.keys(module.states).forEach(stateName => {\n    let state = module.states[stateName];\n    state.codes && state.codes.forEach(code => {\n\n      if(globalCodes[code.code]){\n        let collisions = globalCodes[code.code].filter(checkCollision(state));\n        if(collisions.length > 0){\n          warnings.push({stateName, message: 'Code collision with state ' + collisions[0].stateName + ' in module ' + collisions[0].moduleKey + '. '});\n        }\n      }\n    });\n  });\n\n  return warnings;\n\n}\n\nconst orphanStateWarnings = (module) => {\n  const warnings = [];\n\n  const visitedStateCheck = Object.keys(module.states).reduce( (acc, value) => {acc[value] = false; return acc}, {})\n\n  const visitNext = [];\n\n  if(module.states['Initial']){\n    visitNext.push('Initial');\n  };\n\n  while(visitNext.length > 0){\n    let nextStateKey = visitNext.pop();\n    let nextState = module.states[nextStateKey];\n    visitedStateCheck[nextStateKey] = true;\n\n    if(nextState.direct_transition){\n      if(!module.states[nextState.direct_transition]){\n        warnings.push({stateName: nextStateKey, message: 'Transition to state that does not exist: ' + nextState.direct_transition});\n      } else {\n        if(!visitedStateCheck[nextState.direct_transition]){\n          visitNext.push(nextState.direct_transition);\n        }\n      }\n    } else if(nextState.distributed_transition){\n      nextState.distributed_transition.forEach(transition => {\n        if(!module.states[transition.transition]){\n          warnings.push({stateName: nextStateKey, message: 'Transition to state that does not exist: ' + transition.transition});\n        } else {\n          if(!visitedStateCheck[transition.transition]){\n            visitNext.push(transition.transition);\n          }\n        }\n      });\n    } else if(nextState.lookup_table_transition){\n      nextState.lookup_table_transition.transitions.forEach(transition => {\n        if(!module.states[transition.transition]){\n          warnings.push({stateName: nextStateKey, message: 'Transition to state that does not exist: ' + transition.transition});\n        } else {\n          if(!visitedStateCheck[transition.transition]){\n            visitNext.push(transition.transition);\n          }\n        }\n      });\n    }\n    else if(nextState.conditional_transition){\n      nextState.conditional_transition.forEach(transition => {\n        if(!module.states[transition.transition]){\n          warnings.push({stateName: nextStateKey, message: 'Transition to state that does not exist: ' + transition.transition});\n        } else {\n          if(!visitedStateCheck[transition.transition]){\n            visitNext.push(transition.transition);\n          }\n        }\n      });\n    } else if (nextState.complex_transition){\n      nextState.complex_transition.forEach( transition => {\n        if(transition.transition){\n          if(!module.states[transition.transition]){\n            warnings.push({stateName: nextStateKey, message: 'Transition to state that does not exist: ' + transition.transition});\n          } else {\n            if(!visitedStateCheck[transition.transition]){\n              visitNext.push(transition.transition);\n            }\n          }\n        }\n        if(transition.distributions){\n          transition.distributions.forEach( distribution => {\n            if(!module.states[distribution.transition]){\n              warnings.push({stateName: nextStateKey, message: 'Transition to state that does not exist: ' + distribution.transition});\n            } else {\n              if(!visitedStateCheck[distribution.transition]){\n                visitNext.push(distribution.transition);\n              }\n            }\n          })\n        }\n      })\n    }\n  }\n\n  let notVisitedWarnings = Object.keys(visitedStateCheck).map(s => {return {state: s, visited: visitedStateCheck[s]}}).filter(v => !v.visited).map(v => {\n    return {\n      stateName: v.state,\n      message: 'State cannot be reached.'\n    };\n  });\n\n  return [...warnings, ...notVisitedWarnings];\n\n}\n\nconst libraryModuleCodes = (modules) => {\n    const libraryModuleCodes = {};\n\n    Object.keys(modules).forEach(moduleKey => {\n      const module = modules[moduleKey];\n      Object.keys(module.states).forEach(stateName => {\n        const moduleState = module.states[stateName];\n        moduleState.codes && moduleState.codes.forEach(code => {\n          if(!libraryModuleCodes[code.code]){\n            libraryModuleCodes[code.code] = []\n          }\n          libraryModuleCodes[code.code].push({...code, moduleKey, stateName, state: moduleState});\n        });\n      });\n    });\n    return libraryModuleCodes;\n}\n\nconst libraryRelatedModules = (modules) => {\n  const libraryRelatedModules = {};\n\n  Object.keys(modules).forEach(moduleKey => {\n    const module = modules[moduleKey];\n    Object.keys(module.states).forEach(stateName => {\n      const moduleState = module.states[stateName];\n      if(moduleState.type === 'CallSubmodule'){\n        libraryRelatedModules[moduleKey] = libraryRelatedModules[stateName] || []\n        libraryRelatedModules[moduleKey].push({type: 'submodule', moduleKey: moduleState.submodule, stateName})\n\n        libraryRelatedModules[moduleState.submodule] = libraryRelatedModules[moduleState.submodule] || []\n        libraryRelatedModules[moduleState.submodule].push({type: 'submodule', moduleKey, stateName})\n      }\n    });\n  });\n  return libraryRelatedModules;\n\n}\n\nconst relatedBySubmodule = (moduleKey, module, relatedMap) => {\n  let related = [];\n\n  if(relatedMap[moduleKey]){\n    related = _.cloneDeep(relatedMap[moduleKey]);\n  }\n\n  Object.keys(module.states).forEach(stateName => {\n    const moduleState = module.states[stateName];\n     if(moduleState.type === 'CallSubmodule'){\n       related.push({type: 'submodule', module: moduleState.submodule, stateName});\n     }\n  });\n\n  return related;\n}\n\nexport default (state = initialState, action) => {\n  let newState = {...state};\n  switch (action.type) {\n    case 'ANALYZE':\n\n      newState.warnings = [...stateCollisionWarnings(action.data.module, newState.libraryModuleCodes),\n                           ...orphanStateWarnings(action.data.module),\n                           ...placeholderCodeWarnings(action.data.module),\n                           ...tableTransitionWarnings(action.data.module),\n                           ...gmfVersionWarnings(action.data.module)];\n\n      newState.relatedModules = [...relatedBySubmodule(action.data.moduleKey, action.data.module, newState.libraryRelatedModules)];\n\n      newState.attributes = attributes(action.data.module);\n\n      return newState;\n\n    case 'LOAD_LIBRARY':\n\n      newState.libraryModuleCodes = libraryModuleCodes(action.data);\n      newState.libraryRelatedModules = libraryRelatedModules(action.data);\n\n      return newState\n\n    default:\n      return state;\n  }\n}\n","import _ from 'lodash';\nimport { getTemplate } from '../templates/Templates';\nimport { normalizeType, cleanString } from '../utils/stringUtils';\nimport { CURRENT_GMF_VERSION } from './analysis'\n\nconst initialState = {\n    selectedStateKey: null,\n    selectedStateTransition: null,\n    selectedModuleKey: null,\n    loadModuleVisible: false,\n    downloadVisible: false,\n    selectedModulePanel: 'info',\n    modulePanelVisible: true,\n    modules: {},\n    history: [],\n    clipboard: null,\n    historyIndex: -1,\n    refreshCodeFlag: false\n};\n\nexport default (state = initialState, action) => {\n\n  let newState = {...state}\n\n  switch (action.type) {\n    case 'ADD_GMF_VERSION':\n      newState.modules[action.data.targetModuleKey]['gmf_version'] = CURRENT_GMF_VERSION;\n      return newState;\n    case 'SELECT_NODE':\n      let selectedModulePanel = state.selectedModulePanel;\n      if(action.data.key){\n        if(selectedModulePanel === 'info' || state.selectedStateKey === action.data.key){ // if on info or a 'double click'\n          selectedModulePanel = 'state';\n        }\n      } else {\n        if(selectedModulePanel === 'state'){\n          selectedModulePanel = 'info';\n        }\n      }\n\n      newState = { ...newState, selectedModulePanel, selectedStateKey: action.data.key, selectedStateTransition: action.data.transitionIndex};\n\n      // special case where we just want to reflect the selection change in the current history\n      newState.history = [...newState.history]\n      newState.history[0] = {...newState.history[0], selectedStateKey: action.data.key, selectedStateTransition: action.data.transitionIndex};\n\n      return newState;\n\n    case 'COPY_NODE':\n      // let newStateName = action.data.newName;\n      // let newModuleState = _.cloneDeep(newModuleCopy.states[action.data.targetNode.name]);\n      // newModuleState.name = newStateName;\n\n      // /* fix loopback transition case */\n      // renameLoopbackTransition(newModuleState, newStateName, action.data.targetNode.name);\n\n      // newModuleCopy.states[newStateName] = newModuleState;\n      // newState.modules[action.data.targetModuleKey] = newModuleCopy\n      // newState.selectedStateKey = action.data.newName;\n      // newState.selectedStateTransition = null;\n\n      newState.clipboard = _.cloneDeep(state.modules[action.data.targetModuleKey].states[action.data.targetNode.name])\n\n      // saveHistory(newState);\n\n      return newState\n\n    case 'ADD_NODE':\n\n      newState.modules = {...newState.modules}\n\n      newState.modules[action.data.currentModuleKey].states = {...newState.modules[action.data.currentModuleKey].states, [action.data.stateKey]:action.data.state};\n\n      if(action.data.selectedState && typeof action.data.selectedStateTransition === 'number'){\n        // We have been instructed to insert into the middle of an existing transition\n\n        let alteredState = _.cloneDeep(newState.modules[action.data.currentModuleKey].states[action.data.selectedState]);\n\n        if(alteredState.direct_transition && action.data.selectedStateTransition === 0 ){\n          let oldTransitionPoint = alteredState.direct_transition;\n          alteredState.direct_transition = action.data.stateKey;\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n          newState.modules[action.data.currentModuleKey].states[action.data.selectedState] = alteredState;\n        } else if(alteredState.distributed_transition){\n          let oldTransitionPoint = alteredState.distributed_transition[action.data.selectedStateTransition].transition;\n          alteredState.distributed_transition = [...alteredState.distributed_transition]\n          alteredState.distributed_transition[action.data.selectedStateTransition] = {...alteredState.distributed_transition[action.data.selectedStateTransition], transition: action.data.stateKey}\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n          newState.modules[action.data.currentModuleKey].states[action.data.selectedState] = alteredState;\n        } else if(alteredState.lookup_table_transition){\n          let oldTransitionPoint = alteredState.lookup_table_transition[action.data.selectedStateTransition].transition;\n          alteredState.lookup_table_transition = [...alteredState.lookup_table_transition]\n          alteredState.lookup_table_transition[action.data.selectedStateTransition] = {...alteredState.lookup_table_transition[action.data.selectedStateTransition], transition: action.data.stateKey}\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n          newState.modules[action.data.currentModuleKey].states[action.data.selectedState] = alteredState;\n        } else if(alteredState.conditional_transition){\n          let oldTransitionPoint = alteredState.conditional_transition[action.data.selectedStateTransition].transition;\n          alteredState.conditional_transition = [...alteredState.conditional_transition]\n          alteredState.conditional_transition[action.data.selectedStateTransition] = {...alteredState.conditional_transition[action.data.selectedStateTransition], transition: action.data.stateKey}\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n          newState.modules[action.data.currentModuleKey].states[action.data.selectedState] = alteredState;\n\n        } else if(alteredState.complex_transition){\n          alteredState = {...alteredState, complex_transition: _.cloneDeep(alteredState.complex_transition)};\n          let complexTransitions = {}\n          let transitionIndex = 0;\n          let rightNode = null;\n          alteredState.complex_transition.forEach( (t, i) => {\n\n            if(t.transition !== undefined){\n              let nodes = t.transition;\n              if(complexTransitions[nodes] === undefined){\n                complexTransitions[nodes] = true;\n                if(transitionIndex === action.data.selectedStateTransition || nodes === rightNode){\n                  rightNode = nodes;\n                  let oldTransitionPoint = t.transition;\n                  t.transition = action.data.stateKey;\n                  newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n                }\n                transitionIndex++;\n              } else if(nodes === rightNode){\n                let oldTransitionPoint = t.transition;\n                t.transition = action.data.stateKey;\n                newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n              }\n            } else {\n              t.distributions.forEach( dist => {\n                let nodes = dist.transition;\n                if(complexTransitions[nodes] === undefined){\n                  complexTransitions[nodes] = true;\n                  if(transitionIndex === action.data.selectedStateTransition){\n                    rightNode = nodes;\n                    let oldTransitionPoint = dist.transition;\n                    dist.transition = action.data.stateKey;\n                    newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n                  }\n                  transitionIndex++;\n                } else if(nodes == rightNode){\n                  let oldTransitionPoint = dist.transition;\n                  dist.transition = action.data.stateKey;\n                  newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = oldTransitionPoint;\n                }\n              })\n            }\n          })\n          newState.modules[action.data.currentModuleKey].states[action.data.selectedState] = alteredState;\n        }\n        newState.selectedStateTransition = 0;\n      } else if(action.data.selectedState){\n        // we have selected a state, so we will add it AFTER\n        let alteredState = _.cloneDeep(newState.modules[action.data.currentModuleKey].states[action.data.selectedState]);\n\n        delete newState.modules[action.data.currentModuleKey].states[action.data.stateKey]['direct_transition']\n        delete newState.modules[action.data.currentModuleKey].states[action.data.stateKey]['conditional_transition']\n        delete newState.modules[action.data.currentModuleKey].states[action.data.stateKey]['distributed_transition']\n        delete newState.modules[action.data.currentModuleKey].states[action.data.stateKey]['complex_transition']\n        delete newState.modules[action.data.currentModuleKey].states[action.data.stateKey]['lookup_table_transition']\n\n\n        if(alteredState.direct_transition){\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].direct_transition = alteredState.direct_transition;\n        } else if(alteredState.distributed_transition){\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].distributed_transition = _.cloneDeep(alteredState.distributed_transition);\n          delete alteredState['distributed_transition']\n        } else if(alteredState.lookup_table_transition){\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].lookup_table_transition = _.cloneDeep(alteredState.lookup_table_transition);\n          delete alteredState['lookup_table_transition']\n        } else if(alteredState.conditional_transition){\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].conditional_transition = _.cloneDeep(alteredState.conditional_transition);\n          delete alteredState['conditional_transition']\n        } else if(alteredState.complex_transition){\n          newState.modules[action.data.currentModuleKey].states[action.data.stateKey].complex_transition = _.cloneDeep(alteredState.complex_transition);\n          delete alteredState['complex_transition']\n        }\n        alteredState.direct_transition = action.data.stateKey;\n        newState.modules[action.data.currentModuleKey].states[action.data.selectedState] = alteredState;\n\n      }\n\n      newState.selectedStateKey = action.data.stateKey;\n      newState.selectedModulePanel= 'state';\n      newState.selectedStateTransition = null;\n\n\n      saveHistory(newState);\n\n      return newState;\n\n    case 'INSERT_NODE':\n\n      newState.modules = {...newState.modules}\n\n      newState.modules[action.data.currentModuleKey].states = {...newState.modules[action.data.currentModuleKey].states, [action.data.stateKey]:action.data.state};\n      newState.selectedStateKey = action.data.stateKey;\n      newState.selectedModulePanel= 'state';\n      newState.selectedStateTransition = null;\n\n      saveHistory(newState);\n\n      return {...newState};\n\n    case 'ADD_STRUCTURE':\n      newState.modules[action.data.currentModuleKey].states = {...newState.modules[action.data.currentModuleKey].states, ...getTemplate(`Structure.${action.data.structureName}`)};\n      newState.selectedStateTransition = null;\n\n      saveHistory(newState);\n\n      return {...newState}\n\n    case 'OPEN_MODULE':\n      let selectedModuleKey = state.selectedModuleKey;\n\n      selectedModuleKey = action.data.key\n      if(action.data.libraryModule){\n        delete newState.modules[action.data.key];\n        let newModule = {}\n        newModule[action.data.key] = _.cloneDeep(action.data.libraryModule);\n        newState.modules = {...newModule, ...newState.modules}\n      }\n\n      if(!newState.modules[action.data.key]){\n        selectedModuleKey = null;\n      }\n\n      newState.selectedModuleKey = selectedModuleKey;\n      newState.selectedStateKey = null;\n      newState.selectStateTransition = null;\n      newState.loadModuleVisible = false;\n      newState.history = [];\n      newState.historyIndex = 0;\n      newState.selectedModulePanel = 'info';\n\n      saveHistory(newState);\n\n      return { ...newState };\n\n    case 'NEW_MODULE':\n      let newModules = {...state.modules}\n      delete newModules[action.data.key]\n\n      let tempModule = {}; // put in the right order in the object for the tabs\n      tempModule[action.data.key] = action.data.module;\n\n\n      newState.history = [];\n      newState.historyIndex = 0;\n      saveHistory(newState);\n\n      return {...newState, modules: {...tempModule, ...newModules}, selectedStateKey: null, selectedStateTransition: null, selectedModuleKey: action.data.key}\n\n    case 'JSON_EDIT':\n      newState.modules = {...newState.modules}\n      newState.modules[state.selectedModuleKey] = _.cloneDeep(action.data.module);\n      saveHistory(newState);\n      return {...newState};\n\n    case 'EDIT_NODE':\n      let path = action.data.path.join('.');\n      let value = Object.values(action.data.update)[0]\n      if(typeof value === 'object') {\n        value = value.id;\n      }\n      if(value !== null && value !== undefined) {\n        _.set(newState.modules, path, normalizeType(value));\n\n        // FIX DEPENDENT THINGS\n        let splitPath = []\n        if(Array.isArray(path)){\n          splitPath = path.join('.').split('.')\n        } else {\n          splitPath = path.split('.')\n        }\n\n        // If change operator on attribute, clean up value if needed\n        if(splitPath[splitPath.length-1] === 'operator'){\n          const parent = _.get(newState.modules, splitPath.slice(0,-1).join('.'));\n          if((parent.operator === 'is nil' || parent.operator === 'is not nil')){\n            _.unset(newState.modules, splitPath.slice(0,-1).join('.') + '.value')\n          } else {\n            if(parent.operator.value === undefined){\n              _.set(newState.modules, splitPath.slice(0,-1).join('.') + '.value', 0)\n            }\n          }\n        }\n      }\n      else{\n        _.unset(newState.modules, path);\n        let parent = [...action.data.path].splice(0, action.data.path.length -1).join(\".\");\n        if (action.data.path[2] == 'lookup_table_transition'){\n         parent  += '.transitions'\n        }\n        let newVal = _.get(newState.modules, parent);\n        if(Array.isArray(newVal)) {\n          _.set(newState.modules, parent, newVal.filter(x => x));\n        }\n\n        // check to see if it is a node deletion, in which case we need to references\n        let splitPath = []\n        if(Array.isArray(path)){\n          splitPath = path.join('.').split('.')\n        } else {\n          splitPath = path.split('.')\n        }\n\n        if(splitPath.length === 3 && splitPath[1] === 'states'){\n          let stateName = splitPath[2]\n          fixStateReferences(newState.modules[splitPath[0]], stateName, null)\n\n          if(splitPath[2] == newState.selectedStateKey){\n            newState.selectedStateKey = null; // deleselect\n          }\n        }\n\n      }\n\n      saveHistory(newState);\n\n      return newState\n\n    case 'ADD_TRANSITION':\n\n      let transitionMapping = {\n        Conditional: 'conditional_transition',\n        Distributed: 'distributed_transition',\n        Direct: 'direct_transition',\n        Complex: 'complex_transition',\n        Table: 'lookup_table_transition',\n      };\n\n      let transitionName = transitionMapping[action.data.transitionType];\n      let oldTransitionName = null;\n      if (action.data.nodeName.transition != null) {\n        oldTransitionName = transitionMapping[action.data.nodeName.transition.type];\n      }\n\n      let paths = Object.values(transitionMapping);\n      for (var pathIndex in paths) {\n        delete newState.modules[action.data.currentModuleKey].states[action.data.nodeName.name][paths[pathIndex]];\n      }\n      newState.modules[action.data.currentModuleKey].states[action.data.nodeName.name][transitionName] = getTemplate(`Transition.${action.data.transitionType}`);\n\n      // Get first of previous transition locations if available\n      let transitionTo = null;\n      switch(oldTransitionName) {\n        case 'direct_transition':\n          transitionTo = _.get(action, 'data.nodeName.transition.to', null);\n          break;\n        case 'distributed_transition':\n        case 'conditional_transition':\n          transitionTo = _.get(action, 'data.nodeName.transition.transition[0].to', null);\n          break;\n        case 'complex_transition':\n          transitionTo = _.get(action, 'data.nodeName.transition.transition[0].distributions[0].to', null);\n          break;\n        case 'lookup_table_transition':\n          transitionTo = _.get(action, 'data.nodeName.transition.transitions.transition[0].to', null);\n          break;\n      }\n\n      // Provide previous transition location to new if available\n      if (transitionTo !== null) {\n        switch(transitionName) {\n          case 'direct_transition':\n            newState.modules[action.data.currentModuleKey].states[action.data.nodeName.name][transitionName] = transitionTo;\n            break;\n          case 'distributed_transition':\n          case 'conditional_transition':\n            newState.modules[action.data.currentModuleKey].states[action.data.nodeName.name][transitionName][0].transition = transitionTo;\n            break;\n          case 'complex_transition':\n            newState.modules[action.data.currentModuleKey].states[action.data.nodeName.name][transitionName][0].distributions[0].transition = transitionTo;\n            break;\n          case 'lookup_table_transition':\n            newState.modules[action.data.currentModuleKey].states[action.data.nodeName.name][transitionName].transitions[0].transition = transitionTo;\n            break;\n        }\n      }\n\n      saveHistory(newState);\n\n      return newState\n\n    case 'RENAME_NODE':\n\n      let stateName = action.data.targetNode.name;\n      let newName = action.data.newName.name;\n      let newModule = _.cloneDeep(state.modules[action.data.targetModuleKey])\n      let moduleState = newModule.states[stateName]\n\n\n      if(moduleState === undefined){\n        // if we can't find it, then it might be a blank state (Unnamed state)\n        // Check in the blank key\n        moduleState = newModule.states[\"\"]\n        stateName = \"\"\n      }\n\n      if(moduleState === undefined){\n        // If we still can't find the state, let's just hop out of here.\n        return newState;\n      }\n\n      delete newModule.states[stateName];\n\n      moduleState.name = newName\n      newModule.states[newName] = moduleState\n\n      fixStateReferences(newModule, stateName, newName);\n      newState.modules[action.data.targetModuleKey] = newModule;\n      newState.selectedStateKey = action.data.newName.name;\n\n      saveHistory(newState);\n\n      return newState\n\n    case 'EDIT_MODULE_NAME':\n      newState.modules[action.data.targetModuleKey].name = action.data.newName;\n\n      saveHistory(newState);\n\n      return newState;\n\n    case 'EDIT_MODULE_REMARKS':\n\n      newState.modules[action.data.targetModuleKey].remarks = action.data.newRemarks ? action.data.newRemarks.split(\"\\n\") : null;\n      if(newState.modules[action.data.targetModuleKey].remarks === null){\n        delete newState.modules[action.data.targetModuleKey].remarks;\n      }\n      saveHistory(newState);\n\n      return newState;\n\n    case 'CHANGE_STATE_TYPE':\n      let newType = action.data.newType.type.id;\n      // This line is weird because we need to add the new fields, overwrite any shared fields, then overwrite the type fields\n      // TODO figure out how to remove unused fields\n      newState.modules[action.data.targetModuleKey].states[action.data.targetNode.name] =\n        { ...getTemplate(`State.${newType}`),\n          ..._.pick(newState.modules[action.data.targetModuleKey].states[action.data.targetNode.name], ['direct_transition', 'conditional_transition', 'distributed_transition', 'complex_transition', 'lookup_table_transition', 'remarks']),\n          type: getTemplate(`State.${newType}`).type\n        };\n\n      saveHistory(newState);\n\n      return newState\n\n    case 'LOAD_JSON':\n\n      newState.history = []\n      newState.historyIndex = 0;\n      saveHistory(newState);\n\n      return { ...newState, selectedModuleKey: action.data.selectedModuleKey, selectedStateKey: null, selectedStateTransition: null};\n\n    case 'CLOSE_MODULE':\n\n      delete newState.modules[action.data.selectedModuleKey];\n\n      newState.history = []\n      newState.historyIndex = 0;\n      saveHistory(newState);\n\n      return { ...newState};\n\n    case 'SHOW_LOAD_MODULE':\n      return { ...newState, loadModuleVisible: true};\n\n    case 'HIDE_LOAD_MODULE':\n      return { ...newState, loadModuleVisible: false};\n\n    case 'SHOW_DOWNLOAD':\n      return { ...newState, downloadVisible: true};\n\n    case 'HIDE_DOWNLOAD':\n      return { ...newState, downloadVisible: false};\n\n    case 'CHANGE_MODULE_PANEL':\n      return { ...newState, selectedModulePanel: action.data.targetPanel, modulePanelVisible: action.data.targetPanel !== 'hide'};\n\n    case 'REFRESH_CODE_FLAG':\n      return {...newState, refreshCodeFlag: action.data.flag}\n\n    case 'UNDO':\n      if(newState.history.length > newState.historyIndex + 1){\n        newState.historyIndex++;\n        newState.modules = {...newState.modules}\n        newState.modules[newState.selectedModuleKey] = _.cloneDeep(newState.history[newState.historyIndex].module);\n        newState.selectedStateKey = newState.history[newState.historyIndex].selectedStateKey;\n        newState.selectedStateTransition = newState.history[newState.historyIndex].selectedStateTransition;\n      }\n      return {...newState}\n\n    case 'REDO':\n      if(newState.historyIndex > 0){\n        newState.historyIndex--;\n        newState.modules = {...newState.modules}\n        newState.modules[newState.selectedModuleKey] = _.cloneDeep(newState.history[newState.historyIndex].module);\n        newState.selectedStateKey = newState.history[newState.historyIndex].selectedStateKey;\n        newState.selectedStateTransition = newState.history[newState.historyIndex].selectedStateTransition;\n      }\n      return {...newState}\n\n    default:\n      return newState;\n\n  }\n}\n\n// updates the module in-place with fixed state refences\n// if newName is null, then delete all references instead\nconst fixStateReferences = (module, stateName, newName) => {\n\n  Object.keys(module.states).map(s => module.states[s]).forEach( state => {\n\n    if(state.direct_transition === stateName){\n      if(newName === null){\n        delete state.direct_transition\n      } else {\n        state.direct_transition = newName\n      }\n\n    } else if (state.distributed_transition){\n      state.distributed_transition.forEach( transition => {\n        if(transition.transition === stateName){\n          if(newName === null){\n            delete transition.transition\n          } else {\n            transition.transition = newName\n          }\n        }\n      })\n    } else if (state.lookup_table_transition){\n      state.lookup_table_transition.transitions.forEach( transition => {\n        if(transition.transition === stateName){\n          if(newName === null){\n            delete transition.transition\n          } else {\n            transition.transition = newName\n          }\n        }\n      })\n    }  else if (state.conditional_transition){\n      state.conditional_transition.forEach( transition => {\n        if(transition.transition === stateName){\n          if(newName === null){\n            delete transition.transition\n          } else {\n            transition.transition = newName\n          }\n        }\n        if(transition.condition){\n          if(transition.condition.condition_type === 'PriorState' && transition.condition.name === stateName){\n            if(newName === null){\n              delete transition.condition.name\n            } else {\n              transition.condition.name = newName\n            }\n          }\n        }\n      })\n    } else if (state.complex_transition){\n      state.complex_transition.forEach( transition => {\n        if(transition.transition === stateName){\n          if(newName === null){\n            delete transition.transition\n          } else {\n            transition.transition = newName\n          }\n        }\n        if(transition.condition){\n          if(transition.condition.condition_type === 'PriorState' && transition.condition.name === stateName){\n            if(newName === null) {\n              delete transition.condition.name\n            } else {\n              transition.condition.name = newName\n            }\n          }\n        }\n        if(transition.distributions){\n          transition.distributions.forEach( distribution => {\n            if(distribution.transition === stateName){\n              if(newName === null){\n                delete distribution.transition\n              } else {\n                distribution.transition = newName\n              }\n            }\n          })\n        }\n      })\n    }\n    if(state.reason === stateName){\n      if(newName === null){\n        delete state.reason\n      } else {\n        state.reason = newName;\n      }\n    }\n    if(state.target_encounter === stateName){\n      if(newName === null){\n        state.target_encounter = \"\" // this is a requried field\n      } else {\n        state.target_encounter = newName;\n      }\n    }\n    if(state.condition_onset === stateName){\n      if(newName === null){\n        delete state.condition_onset\n      } else {\n        state.condition_onset = newName;\n      }\n    }\n    if(state.allergy_onset === stateName){\n      if(newName === null){\n        delete state.allergy_onset\n      } else {\n        state.allergy_onset = newName;\n      }\n    }\n    if(state.medication_order === stateName){\n      if(newName === null){\n        delete state.medication_order\n      } else {\n        state.medication_order = newName;\n      }\n    }\n    if(state.careplan === stateName){\n      if(newName === null){\n        delete state.careplan;\n      } else {\n        state.careplan = newName;\n      }\n    }\n    if(state.allow && state.allow.condition_type === 'PriorState' && state.allow.name === stateName){\n      if(newName === null){\n        delete state.allow.name\n      } else {\n        state.allow.name = newName;\n      }\n    }\n  });\n}\n\nconst saveHistory = (state) => {\n  let selectedStateKey = state.selectedStateKey;\n  let selectedStateTransition = state.selectedStateTransition;\n\n  if(state.historyIndex > 0){\n    while(state.historyIndex > 0 && state.history.length > 0){\n      state.historyIndex--;\n      state.history.shift()\n    }\n\n    state.historyIndex = 0; // should always be 0 anyhow\n\n  }\n\n  state.history = [{selectedStateKey, selectedStateTransition, module: _.cloneDeep(state.modules[state.selectedModuleKey])}].concat(state.history);\n\n  state.history.splice(20) // only save the last 20 changes\n}\n\n// When nodes are cloned, loopback transitions point to node being cloned, instead of new copy\nconst renameLoopbackTransition = (state, newStateName, oldStateName) => {\n  if(state.direct_transition === oldStateName){\n    state.direct_transition = newStateName;\n  } else if (state.distributed_transition){\n    state.distributed_transition.forEach( transition => {\n      if(transition.transition === oldStateName){\n        transition.transition = newStateName\n      }\n    })\n  } else if (state.lookup_table_transition){\n    state.lookup_table_transition.forEach( transition => {\n      if(transition.transition === oldStateName){\n        transition.transition = newStateName\n      }\n    })\n  } else if (state.conditional_transition){\n    state.conditional_transition.forEach( transition => {\n      if(transition.transition === oldStateName){\n        transition.transition = newStateName\n      }\n    })\n  } else if (state.complex_transition){\n    state.complex_transition.forEach( transition => {\n      if(transition.transition === oldStateName){\n        transition.transition = newStateName\n      }\n      if(transition.distributions){\n        transition.distributions.forEach( distribution => {\n          if(distribution.transition === oldStateName){\n            distribution.transition = newStateName\n          }\n        })\n      }\n    })\n  }\n}\n\n","import { createBrowserHistory } from 'history';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport { routerMiddleware } from 'connected-react-router';\nimport thunk from 'redux-thunk';\n\nimport createRootReducer from './reducers';\n\nconst initialState = {}\nconst enhancers = [];\nconst middleware = [];\n\nif (process.env.NODE_ENV === 'development') {\n  const devToolsExtension = window.devToolsExtension\n\n  if (typeof devToolsExtension === 'function') {\n    enhancers.push(devToolsExtension())\n  }\n}\n\nexport const history = createBrowserHistory({basename: '/module-builder'})\n\nconst createAppStore = (history) => {\n  middleware.push(routerMiddleware(history))\n  middleware.push(thunk)\n  const composedEnhancers = compose(\n    applyMiddleware(...middleware),\n    ...enhancers\n  )\n\n  const store = createStore(\n    createRootReducer(history), // root reducer with router state\n    initialState,\n    composedEnhancers\n  )\n  return store;\n}\n\nexport default createAppStore;\n","import { combineReducers } from 'redux';\nimport { connectRouter } from 'connected-react-router'\n\nimport library from './library';\nimport editor from './editor';\nimport analysis from './analysis';\n\nexport default (history) => combineReducers({\n  router : connectRouter(history),\n  library,\n  editor,\n  analysis\n});\n","// @flow\n\nimport React, { Component } from 'react';\nimport { RIEInput } from 'riek';\nimport _ from 'lodash';\n\nimport type { Code as CodeType } from '../../types/Code';\nimport { getTemplate } from '../../templates/Templates';\n\ntype Props = {\n  code: CodeType,\n  system: string,\n  onChange: any,\n  value_set?: string\n}\n\nexport class Code extends Component<Props> {\n  checkValueSetKey() {\n    if(this.props.code.value_set) {\n      return (\n        <div>\n        Value Set (Optional): <RIEInput className='editable-text' value={this.props.code.value_set} propName=\"value_set\" change={this.props.onChange('value_set')} />\n        </div>\n      );\n    }else {\n      return (\n        <div>\n        Value Set (Optional): <RIEInput className='editable-text' value=\"\" propName=\"value_set\" change={this.props.onChange('value_set')} />\n        </div>\n      );\n    }\n  }\n\n  render() {\n    let code = this.props.code;\n    let system = this.props.system;\n    return (\n      <div>\n        System: { system ? system : code.system}\n        <br />\n        Code: <RIEInput className='editable-text' value={code.code} propName=\"code\" change={this.props.onChange('code')} />\n        <br />\n        Display: <RIEInput className='editable-text' value={code.display} propName=\"display\" change={this.props.onChange('display')} />\n        {this.checkValueSetKey()}\n      </div>\n    );\n  }\n}\n\ntype CodesProps = {\n  codes: CodeType[],\n  system: string,\n  onChange: any\n}\nexport class Codes extends Component<CodesProps> {\n  render() {\n\n    if(!this.props.codes){\n      return null;\n    }\n    let system = this.props.system;\n    let templates = {\n      \"SNOMED-CT\": getTemplate('Type.Code.Snomed'),\n      \"LOINC\": getTemplate('Type.Code.Loinc'),\n      \"RxNorm\": getTemplate('Type.Code.RxNorm'),\n      \"NUBC\": getTemplate('Type.Code.Nubc'),\n      \"DICOM-DCM\": getTemplate('Type.Code.DicomDCM'),\n      \"DICOM-SOP\": getTemplate('Type.Code.DicomSOP')\n    };\n    return (\n      <div>\n        {this.props.codes.map((code, i) => {\n          return (\n            <div className='section' key={i}>\n              <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n              <Code onChange={this.props.onChange(i)} code={code} system={system}/>\n            </div>\n          )\n        })}\n        <a className='editable-text' onClick={() => this.props.onChange(`[${this.props.codes.length}]`)({val: {id: _.cloneDeep(templates[system])}})}>+</a>\n      </div>\n    );\n  }\n}\n","// @flow\n\nimport React, { Component } from 'react';\nimport { RIENumber, RIESelect } from 'riek';\nimport _ from 'lodash';\n\nimport type { Code as CodeType } from '../../types/Code';\nimport type { Reaction as ReactionType, Severity as SeverityType } from '../../types/State';\nimport { getTemplate } from '../../templates/Templates';\nimport { Code }  from './Code';\n\ntype SeverityComponent = SeverityType & {\n  onChange: any\n}\n\nexport class Severity extends Component<SeverityComponent> {\n  render() {\n    let level = this.props.level;\n    let value = this.props.value;\n    return (\n      <div>\n        Level: <RIESelect className='editable-text'\n                          value={{id: level, text: level}} propName=\"level\"\n                          change={this.props.onChange('level')}\n                          options={[{id:'severe', text: 'Severe'},\n                                    {id:'moderate', text: 'Moderate'},\n                                    {id:'mild', text: 'Mild'},\n                                    {id:'none', text: 'None'}]}/>\n        <br />\n        Probability: <RIENumber className='editable-text'\n                                value={value} propName=\"value\"\n                                change={this.props.onChange('value')}\n                                editProps={{step: .01, min: 0, max: 1}}\n                                format={this.formatAsPercentage} validate={this.checkInRange}/>\n      </div>\n    );\n  }\n\n  formatAsPercentage(num: number) {\n    return (num * 100) + \"%\";\n  }\n\n  checkInRange(num: number) {\n    return ((num >= 0) && (num <= 1));\n  }\n}\n\ntype ReactionComponent = ReactionType & {\n  onChange: any\n}\n\nexport class Reaction extends Component<ReactionComponent> {\n  render() {\n    return (\n      <div>\n        <Code onChange={this.props.onChange('reaction')}\n              code={this.props.reaction.reaction} system={\"SNOMED-CT\"}/>\n        Severity Probabilities:\n        {this.props.reaction.possible_severities.map((ps, i) => {\n            return (\n              <div className='section' key={i}>\n                <a className='editable-text delete-button' onClick={() => this.props.onChange(`possible_severities[${i}]`)({val: {id: null}})}>remove</a>\n                <Severity onChange={this.props.onChange(`possible_severities[${i}]`)} level={ps.level} value={ps.value}/>\n              </div>\n            )\n        })}\n        {this.renderWarning()}\n        <a className='editable-text' onClick={() => this.props.onChange(`possible_severities[${this.props.reaction.possible_severities.length}]`)({val: {id: {level: \"none\", value: 0}}})}>+</a>\n      </div>\n    );\n  }\n\n  renderWarning() {\n    if(this.props.reaction.possible_severities.length == 0) {\n      return null;\n    }\n    let warn = (this.props.reaction.possible_severities.reduce((acc, val) => acc + val.value, 0) !== 1);\n    if (warn) {\n      return (\n        <label className='warning'>Probabilities do not add up to 100%.</label>\n      );\n    }\n  }\n}\n","// @flow\nimport React, { Component } from 'react';\nimport { RIEInput } from 'riek';\n\ntype Props = {\n  label: string,\n  value: string,\n  onChange: any\n};\n\nexport class StringEditor extends Component<Props> {\n  render() {\n    let value = this.props.value;\n    return (\n      <div>\n        {this.props.label}: <RIEInput className='editable-text' value={value} propName=\"value\" change={this.props.onChange} />\n        <br />\n      </div>\n    );\n  }\n}\n\ntype StringsProps = {\n  label: string,\n  values: string[],\n  onChange: any\n};\nexport class StringsEditor extends Component<StringsProps> {\n  render() {\n    if(!this.props.values){\n      return null;\n    }\n    return (\n      <div>\n        {this.props.values.map((value, i) => {\n          return (\n            <div className='section' key={i}>\n              <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n              <StringEditor onChange={this.props.onChange(i)} value={value} label={this.props.label} />\n            </div>\n          )\n        })}\n        <a className='editable-text' onClick={() => this.props.onChange(`[${this.props.values.length}]`)({val: {id: \"text\"}})}>+</a>\n      </div>\n    );\n  }\n}\n","// @flow\n\nimport React, { Component } from 'react';\nimport { RIESelect, RIEInput, RIENumber } from 'riek';\nimport _ from 'lodash';\n\nimport type { Goal as GoalType } from '../../types/Attributes';\nimport { Codes } from './Code';\nimport { StringsEditor } from './String';\nimport { getTemplate } from '../../templates/Templates';\n\ntype Props = {\n  goal: GoalType,\n  onChange: any\n}\n\nexport class Goal extends Component<Props> {\n\n  render() {\n    let goal = this.props.goal;\n    return (\n      <div>\n        {this.renderObservation()}\n        {this.renderText()}\n        <div className='section'>\n          Addresses\n          <br />\n          <StringsEditor values={goal.addresses} label={\"Address\"} onChange={this.props.onChange('addresses')} />\n          <br />\n        </div>\n      </div>\n    );\n  }\n\n  renderObservation() {\n    let goal = this.props.goal;\n    let options = [\n      {id: '==' , text: '==' },\n      {id: '!=' , text: '!=' },\n      {id: \"<\" , text: \"<\" },\n      {id: \"<=\" , text: \"<=\" },\n      {id: \">\" , text: \">\" },\n      {id: \">=\", text: \">=\"},\n      {id: \"is nil\", text: \"is nil\"},\n      {id: \"is not nil\", text: \"is not nil\"}\n    ];\n    if (!goal.observation) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('observation')({val: {id: getTemplate('Attribute.Observation')}})}>Add Observation</a>\n          <br />\n        </div>\n      );\n    } else {\n      let goalObservationValue = (\n        <div>\n          Goal Observation Value: <RIENumber className='editable-text' value={goal.observation.value} propName={'value'} change={this.props.onChange('observation.value')} />\n        </div>\n      );\n\n      if(goal.observation.operator === 'is nil' || goal.observation.operator === 'is not nil'){\n        goalObservationValue = <div/>\n      }\n      \n      return (\n        <div className='section'>\n          Observation\n          <br />\n          <div className='section'>\n            Codes\n            <br />\n            <Codes codes={goal.observation.codes} system={\"LOINC\"} onChange={this.props.onChange('observation.codes')} />\n            <br />\n          </div>\n          Goal Observation Operator: <RIESelect className='editable-text' value={{id: goal.observation.operator, text: goal.observation.operator}} propName={'operator'} change={this.props.onChange('observation.operator')} options={options} />\n          {goalObservationValue}\n          <br/>\n          <a className='editable-text' onClick={() => this.props.onChange('observation')({val: {id: null}})}>Remove Observation</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderText() {\n    let goal = this.props.goal;\n    if (!goal.text) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('text')({val: {id: \"text\"}})}>Add Text</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Goal Text: <RIEInput className='editable-text' value={goal.text} propName={'text'}  change={this.props.onChange('text')} />\n          <a className='editable-text' onClick={() => this.props.onChange('text')({val: {id: null}})}>(remove)</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n}\n\ntype GoalsProps = {\n  goals: GoalType[],\n  onChange: any\n}\nexport class Goals extends Component<GoalsProps> {\n  render() {\n\n    if(!this.props.goals){\n      return null;\n    }\n    return (\n      <div>\n        {this.props.goals.map((goal, i) => {\n          return (\n            <div className='section' key={i}>\n              <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n              <Goal onChange={this.props.onChange(i)} goal={goal} />\n            </div>\n          )\n        })}\n        <a className='editable-text' onClick={() => this.props.onChange(`[${this.props.goals.length}]`)({val: {id: getTemplate('Attribute.Goal')}})}>+</a>\n      </div>\n    );\n  }\n}\n","// @flow\n\nimport React, { Component } from 'react';\nimport { RIEInput } from 'riek';\nimport _ from 'lodash';\n\nimport type { Instance as InstanceType, Series as SeriesType } from '../../types/Attributes';\n\nimport { Code } from './Code';\nimport { getTemplate } from '../../templates/Templates';\n\ntype InstanceProps = {\n  title: string,\n  sop_class: CodeType,\n  onChange: any\n}\n\nexport class Instance extends Component<InstanceProps> {\n\n  render() {\n    let title = this.props.title;\n    let sop_class = this.props.sop_class;\n    return (\n      <div>\n        Title: <RIEInput className='editable-text' value={title} propName=\"title\" change={this.props.onChange('title')} />\n        <br />\n        <br />\n        <b>SOP Class:</b>\n        <br />\n        <Code code={sop_class} system={\"DICOM-SOP\"} onChange={this.props.onChange('sop_class')} />\n      </div>\n    );\n  }\n\n}\n\ntype InstanceListProps = {\n  instances: InstanceType[],\n  onChange: any\n}\n\nexport class InstanceList extends Component<InstanceListProps> {\n\n  render() {\n    if (!this.props.instances) {\n      return null;\n    }\n    return (\n      <div>\n        {this.props.instances.map((instance, i) => {\n          return (\n            <div className='section' key={i}>\n              <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n              <Instance onChange={this.props.onChange(i)} title={instance.title} sop_class={instance.sop_class}/>\n            </div>\n          )\n        })}\n        <a className='editable-text' onClick={() => this.props.onChange(`[${this.props.instances.length}]`)({val: {id: getTemplate('Attribute.ImagingStudy.Instance')}})}>+</a>\n      </div>\n    );\n  }\n\n}\n\ntype SeriesProps = {\n  body_site: CodeType,\n  modality: CodeType,\n  instances: InstanceType[],\n  onChange: any\n}\n\nexport class Series extends Component<SeriesProps> {\n\n  render() {\n    let body_site = this.props.body_site;\n    let modality = this.props.modality;\n    let instances = this.props.instances;\n    return (\n      <div className='section'>\n        <b>Body Site:</b>\n        <br />\n        <Code code={body_site} system={\"SNOMED-CT\"} onChange={this.props.onChange('body_site')} />\n        <br/>\n        <b>Modality:</b>\n        <br />\n        <Code code={modality} system={\"DICOM-DCM\"} onChange={this.props.onChange('modality')} />\n        <br />\n        <b>Instances:</b>\n        <InstanceList instances={instances} onChange={this.props.onChange('instances')} />\n      </div>\n    )\n  }\n\n}\n\n\ntype SeriesListProps = {\n  series: SeriesType[],\n  onChange: any\n}\n\nexport class SeriesList extends Component<SeriesListProps> {\n\n  render() {\n    if (!this.props.series) {\n      return null;\n    }\n    return (\n      <div>\n        {this.props.series.map((series, i) => {\n          return (\n            <div className='section' key={i}>\n                <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n                <br />\n                <Series onChange={this.props.onChange(i)} body_site={series.body_site} modality={series.modality} instances={series.instances} />\n            </div>\n          )\n        })}\n        <a className='editable-text' onClick={() => this.props.onChange(`[${this.props.series.length}]`)({val: {id: getTemplate('Attribute.ImagingStudy.Series')}})}>+</a>\n      </div>\n    );\n  }\n\n}\n","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect, RIEInput, RIENumber } from 'riek';\nimport _ from 'lodash';\nimport type { Conditional, GenderConditional , AgeConditional , DateConditional , SocioeconomicStatusConditional , RaceConditional , SymptomConditional , ObservationConditional , VitalSignConditional , ActiveAllergyConditional , ActiveConditionConditional , ActiveMedicationConditional , ActiveCarePlanConditional , PriorStateConditional , AttributeConditional , AndConditional , OrConditional , AtLeastConditional , AtMostConditional , NotConditional } from '../../types/Conditional';\nimport type { State } from '../../types/State';\nimport { Codes } from './Code';\nimport { Code } from './Code';\nimport { getTemplate } from '../../templates/Templates';\n\ntype Props = {\n  conditional: Conditional,\n  options: State[],\n  onChange: any\n}\n\nconst unitOfTimeOptions = [\n  {id: 'years', text: 'years'},\n  {id: 'months', text: 'months'},\n  {id: 'weeks', text: 'weeks'},\n  {id: 'days', text: 'days'},\n  {id: 'hours', text: 'hours'},\n  {id: 'minutes', text: 'minutes'},\n  {id: 'seconds', text: 'seconds'}\n];\n\nconst unitOfAgeOptions = [\n  {id: 'years', text: 'years'},\n  {id: 'months', text: 'months'},\n  {id: 'weeks', text: 'weeks'},\n  {id: 'days', text: 'days'},\n  {id: 'hours', text: 'hours'},\n  {id: 'minutes', text: 'minutes'},\n  {id: 'seconds', text: 'seconds'}\n];\n\nclass ConditionalEditor extends Component<Props> {\n\n  renderConditionalType() {\n    switch (this.props.conditional.condition_type) {\n      case \"Gender\":\n        return <Gender {...this.props} />\n      case \"Age\":\n        return <Age {...this.props} />\n      case \"Date\":\n        return <Date {...this.props} />\n      case \"Socioeconomic Status\":\n        return <SocioeconomicStatus {...this.props} />\n      case \"Race\":\n        return <Race {...this.props} />\n      case \"Symptom\":\n        return <Symptom {...this.props} />\n      case \"Observation\":\n        return <Observation {...this.props} />\n      case \"Vital Sign\":\n        return <VitalSign {...this.props} />\n      case \"Active Allergy\":\n        return <ActiveAllergy {...this.props} />\n      case \"Active Condition\":\n        return <ActiveCondition {...this.props} />\n      case \"Active Medication\":\n        return <ActiveMedication {...this.props} />\n      case \"Active CarePlan\":\n        return <ActiveCarePlan {...this.props} />\n      case \"PriorState\":\n        return <PriorState {...this.props} />\n      case \"Attribute\":\n        return <Attribute {...this.props} />\n      case \"And\":\n        return <And {...this.props} />\n      case \"Or\":\n        return <Or {...this.props} />\n      case \"At Least\":\n        return <AtLeast {...this.props} />\n      case \"At Most\":\n        return <AtMost {...this.props} />\n      case \"Not\":\n        return <Not {...this.props} />\n      default:\n        return this.props.conditional.condition_type\n\n    }\n  }\n\n  render() {\n    if (!this.props.conditional) {\n      return null;\n    }\n    let template = getTemplate('Type.Condition');\n    let options = Object.keys(template).sort().map((k) => {return {id: k, text: k}});\n    return (\n      <div>\n        Condition Type: <RIESelect className='editable-text' propName='condition' value={{id: this.props.conditional.condition_type, text: this.props.conditional.condition_type}} change={(val) => this.props.onChange({condition:{id: template[val.condition.id]}})} options={options} />\n        <br/>\n        {this.renderConditionalType()}\n      </div>\n    );\n  }\n}\n\nclass Gender extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): GenderConditional);\n    return (\n      <label> Gender:\n        <RIESelect className='editable-text'\n          propName='gender'\n          value={{id: conditional.gender, text: conditional.gender}}\n          change={this.props.onChange('gender')}\n          options={[{id:'M', text: 'M'}, {id:'F', text: 'F'}]}\n        />\n      </label>\n    );\n  }\n\n}\n\nclass Age extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): AgeConditional);\n    let options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"<\" , text:\"<\" }, {id: \"<=\" , text:\"<=\" }, {id: \">\" , text:\">\" }, {id: \">=\", text:\">=\"}];\n    return (\n      <label> Age:\n      <RIESelect className='editable-text' value={{id: conditional.operator, text: conditional.operator}} propName=\"operator\" change={this.props.onChange('operator')} options={options} />\n      <RIENumber className='editable-text' value={conditional.quantity} propName='quantity' change={this.props.onChange('quantity')} />\n      <RIESelect className='editable-text' value={{id: conditional.unit, text: conditional.unit}} propName=\"unit\" change={this.props.onChange('unit')} options={unitOfAgeOptions} />\n      </label>\n    );\n  }\n\n}\n\nclass Date extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): DateConditional);\n    let options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"<\" , text:\"<\" }, {id: \"<=\" , text:\"<=\" }, {id: \">\" , text:\">\" }, {id: \">=\", text:\">=\"}];\n    return (\n      <label>\n      <RIESelect className='editable-text' value={{id: conditional.operator, text: conditional.operator}} propName=\"operator\" change={this.props.onChange('operator')} options={options} />\n      {this.renderType()}\n      {this.renderWarning()}\n      </label>\n    );\n  }\n\n  renderType() {\n    let conditional = ((this.props.conditional: any): DateConditional);\n\n    if(conditional.month) {\n      let month = <RIENumber className='editable-text' value={conditional.month} propName='month' change={this.props.onChange('month')} />\n      return (\n        <div>\n          Month:\n          {month}\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('year')({val: {id: getTemplate('Type.Date.Year')}}); this.props.onChange('month')({val: {id: null}}); this.props.onChange('date')({val: {id: null}})}}>Change to Year</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('date.year')({val: {id: getTemplate('Type.Date.Year')}}); this.props.onChange('date.month')({val: {id: getTemplate('Type.Date.Month')}}); this.props.onChange('date.day')({val: {id: getTemplate('Type.Date.Day')}}); this.props.onChange('date.hour')({val: {id: getTemplate('Type.Date.Hour')}}); this.props.onChange('date.minute')({val: {id: getTemplate('Type.Date.Minute')}}); this.props.onChange('date.second')({val: {id: getTemplate('Type.Date.Second')}}); this.props.onChange('date.millisecond')({val: {id: getTemplate('Type.Date.Millisecond')}}); this.props.onChange('month')({val: {id: null}}); this.props.onChange('year')({val: {id: null}})}}>Change to Date</a>\n        </div>\n      );\n    } else if (conditional.date) {\n      let yearInput = <RIENumber className='editable-text' value={conditional.date.year} propName='date.year' change={this.props.onChange('date.year')} />\n      let monthInput = <RIENumber className='editable-text' value={conditional.date.month} propName='date.month' change={this.props.onChange('date.month')} />\n      let dayInput = <RIENumber className='editable-text' value={conditional.date.day} propName='date.day' change={this.props.onChange('date.day')} />\n      let hourInput = <RIENumber className='editable-text' value={conditional.date.hour} propName='date.hour' change={this.props.onChange('date.hour')} />\n      let minuteInput = <RIENumber className='editable-text' value={conditional.date.minute} propName='date.minute' change={this.props.onChange('date.minute')} />\n      let secondInput = <RIENumber className='editable-text' value={conditional.date.second} propName='date.second' change={this.props.onChange('date.second')} />\n      let millisecondInput = <RIENumber className='editable-text' value={conditional.date.millisecond} propName='date.millisecond' change={this.props.onChange('date.millisecond')} />\n\n      return (\n        <div>\n          Date:\n          <br />\n          {yearInput}/{monthInput}/{dayInput} {hourInput}:{minuteInput}:{secondInput}.{millisecondInput}\n          <br />\n          (yyyy/MM/dd HH:mm:ss.SSS)\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('year')({val: {id: getTemplate('Type.Date.Year')}}); this.props.onChange('month')({val: {id: null}}); this.props.onChange('date')({val: {id: null}})}}>Change to Year</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('month')({val: {id: getTemplate('Type.Date.Month')}}); this.props.onChange('date')({val: {id: null}}); this.props.onChange('year')({val: {id: null}})}}>Change to Month</a>\n        </div>\n      );\n\n    } else { //year\n      let year = <RIENumber className='editable-text' value={conditional.year} propName='year' change={this.props.onChange('year')} />\n      return (\n        <div>\n          Year:\n          {year}\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('month')({val: {id: getTemplate('Type.Date.Month')}}); this.props.onChange('year')({val: {id: null}}); this.props.onChange('date')({val: {id: null}})}}>Change to Month</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('date.year')({val: {id: getTemplate('Type.Date.Year')}}); this.props.onChange('date.month')({val: {id: getTemplate('Type.Date.Month')}}); this.props.onChange('date.day')({val: {id: getTemplate('Type.Date.Day')}}); this.props.onChange('date.hour')({val: {id: getTemplate('Type.Date.Hour')}}); this.props.onChange('date.minute')({val: {id: getTemplate('Type.Date.Minute')}}); this.props.onChange('date.second')({val: {id: getTemplate('Type.Date.Second')}}); this.props.onChange('date.millisecond')({val: {id: getTemplate('Type.Date.Millisecond')}}); this.props.onChange('year')({val: {id: null}}); this.props.onChange('month')({val: {id: null}})}}>Change to Date</a>\n        </div>\n      );\n    }\n  }\n\n  renderWarning(){\n    if (this.props.conditional.year < 1) {\n      return (\n        <label className='warning'>Invalid Year.</label>\n      );\n    } else if (this.props.conditional.month < 1 || this.props.conditional.month > 12) {\n      return (\n        <label className='warning'>Invalid Month. Must be between 1 and 12.</label>\n      );\n    } else if (this.props.conditional.date) {\n      if (this.props.conditional.date.year < 1) {\n        return (\n          <label className='warning'>Invalid Year</label>\n        );\n      } else if (this.props.conditional.date.month < 1 || this.props.conditional.date.month > 12) {\n        return (\n          <label className='warning'>Invalid Month. Must be between 1 and 12.</label>\n        );\n      } else if (this.props.conditional.date.day < 1 || this.props.conditional.date.day > 31) {\n        return (\n          <label className='warning'>Invalid Day. Must at least 1 and never greater than 31.</label>\n        );\n      } else if (this.props.conditional.date.hour < 0 || this.props.conditional.date.hour > 24) {\n        return (\n          <label className='warning'>Invalid Hour. Must be between 0 and 24.</label>\n        );\n      } else if (this.props.conditional.date.minute < 0 || this.props.conditional.date.minute > 60) {\n        return (\n          <label className='warning'>Invalid Minute. Must be between 0 and 60.</label>\n        );\n      } else if (this.props.conditional.date.second < 0 || this.props.conditional.date.second > 60) {\n        return (\n          <label className='warning'>Invalid Second. Must be between 0 and 60.</label>\n        );\n      } else if (this.props.conditional.date.millisecond < 0 || this.props.conditional.date.millisecond > 999) {\n        return (\n          <label className='warning'>Invalid Millisecond. Must be between 0 and 999.</label>\n        );\n      } else {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n}\n\nclass SocioeconomicStatus extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): SocioeconomicStatusConditional);\n    let options = [\n      {id: 'Low', text: 'Low'},\n      {id: 'Middle', text: 'Middle'},\n      {id: 'High', text: 'High'}\n    ];\n    return (\n      <label> Socioeconomic Status:\n        <RIESelect className='editable-text' value={{id: conditional.category, text: conditional.category}} propName=\"category\" change={this.props.onChange('category')} options={options} />\n      </label>\n    )\n  }\n\n}\n\nclass Race extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): RaceConditional);\n    let options = [\n      {id: \"White\", text: \"White\"},\n      {id: \"Native\", text: \"Native\"},\n      {id: \"Hispanic\", text: \"Hispanic\"},\n      {id: \"Black\", text: \"Black\"},\n      {id: \"Asian\", text: \"Asian\"},\n      {id: \"Hawaiian\", text: \"Hawaiian\"},\n      {id: \"Other\", text: \"Other\"}\n    ];\n    return (\n      <label> Race:\n        <RIESelect className='editable-text' value={{id: conditional.race, text: conditional.race}} propName=\"race\" change={this.props.onChange('race')} options={options} />\n      </label>\n    );\n  }\n\n}\n\nclass Symptom extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): SymptomConditional);\n    let options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"<\" , text:\"<\" }, {id: \"<=\" , text:\"<=\" }, {id: \">\" , text:\">\" }, {id: \">=\", text:\">=\"}];\n\n    return (\n      <label> Symptom:\n      <RIEInput className='editable-text' value={conditional.symptom} propName=\"symptom\" change={this.props.onChange('symptom')} />\n      <RIESelect className='editable-text' value={{id: conditional.operator, text: conditional.operator}} propName=\"operator\" change={this.props.onChange('operator')} options={options} />\n      <RIENumber className='editable-text' value={conditional.value} propName='value' change={this.props.onChange('value')} />\n\n      </label>\n    );\n  }\n\n}\n\nclass Observation extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): ObservationConditional);\n    let options = [];\n    if (conditional.value_code) {\n      options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"is nil\", text: \"is nil\"}, {id: \"is not nil\", text: \"is not nil\"}];\n    } else {\n      options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"<\" , text:\"<\" }, {id: \"<=\" , text:\"<=\" }, {id: \">\" , text:\">\" }, {id: \">=\", text:\">=\"}, {id: \"is nil\", text: \"is nil\"}, {id: \"is not nil\", text: \"is not nil\"}];\n    }\n\n    return (\n      <label> Observation:\n        <Codes system={getTemplate('Type.Code.Loinc.system')} codes={conditional.codes} onChange={this.props.onChange('codes')} />\n        <RIESelect className='editable-text' value={{id: conditional.operator, text: conditional.operator}} propName=\"operator\" change={this.props.onChange('operator')} options={options} />\n        {this.renderValueOrCodeValue()}\n      </label>\n    );\n  }\n\n  renderValueOrCodeValue() { // renders numerical or code value\n    let conditional = ((this.props.conditional: any): ObservationConditional);\n    let value_code = <Code className='editable-text' system={getTemplate('Type.Code.Snomed.display')} code={conditional.value_code} onChange={this.props.onChange('value_code')} />\n    let value = conditional.value;\n    if(typeof value === 'boolean'){\n      value = String(value);\n    }\n    let valueInput = <RIEInput className='editable-text' value={value} propName='value' change={this.props.onChange('value')} />\n    if (conditional.operator !== 'is nil' && conditional.operator !== 'is not nil' && conditional.operator.id !== 'is nil' && conditional.operator.id !== 'is not nil'){\n      if (conditional.value_code) {\n        return (\n          <div>\n            Value Code:\n            <div className='section'>\n            {value_code}\n            </div>\n            <a className='editable-text' onClick={() => {this.props.onChange('value')({val: {id: \"0\"}}); this.props.onChange('value_code')({val: {id: null}})}}>Change to Numeric Value</a>\n          </div>\n        );\n      } else {\n        return (\n          <div>\n            Value:\n            {valueInput}\n            <br />\n            <a className='editable-text' onClick={() => {this.props.onChange('value_code')({val: {id: getTemplate('Type.Code.Snomed')}}); this.props.onChange('value')({val: {id: null}})}}>Change to Value Code</a>\n            <br />\n          </div>\n        );\n      }\n    } else {\n      return (\n        <div>\n          No value needed for '{conditional.operator}'\n        </div>\n      )\n    }\n  }\n}\n\nclass VitalSign extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): VitalSignConditional);\n    let options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"<\" , text:\"<\" }, {id: \"<=\" , text:\"<=\" }, {id: \">\" , text:\">\" }, {id: \">=\", text:\">=\"}];\n\n    return (\n      <label> Vital Sign:\n      <RIEInput className='editable-text' value={conditional.vital_sign} propName=\"vital_sign\" change={this.props.onChange('vital_sign')} />\n      <RIESelect className='editable-text' value={{id: conditional.operator, text: conditional.operator}} propName=\"operator\" change={this.props.onChange('operator')} options={options} />\n      <RIENumber className='editable-text' value={conditional.value} propName='value' change={this.props.onChange('value')} />\n\n      </label>\n    );\n  }\n\n}\n\nclass ActiveCondition extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): ActiveConditionConditional);\n\n    return (\n      <label> Active Condition:\n        <Codes system={getTemplate('Type.Code.Snomed.system')} codes={conditional.codes} onChange={this.props.onChange('codes')} />\n      </label>\n    );\n  }\n\n}\n\nclass ActiveAllergy extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): ActiveAllergyConditional);\n\n    return (\n      <label> Active Allergy:\n        <Codes system={getTemplate('Type.Code.Snomed.system')} codes={conditional.codes} onChange={this.props.onChange('codes')} />\n      </label>\n    );\n  }\n\n}\n\nclass ActiveMedication extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): ActiveMedicationConditional);\n    return (\n      <label> ActiveMedication:\n      <Codes system={getTemplate('Type.Code.RxNorm.system')} codes={conditional.codes} onChange={this.props.onChange('codes')} />\n      </label>\n    );\n  }\n\n}\n\nclass ActiveCarePlan extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): ActiveCarePlanConditional);\n    return (\n      <label> ActiveCarePlan:\n      <Codes system={getTemplate('Type.Code.Snomed.system')} codes={conditional.codes} onChange={this.props.onChange('codes')} />\n      </label>\n    );\n  }\n\n}\n\nclass PriorState extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): PriorStateConditional);\n    let options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n    let name = conditional.name;\n    return (\n      <label>\n        Prior State Name: <RIESelect className='editable-text' value={{id: name, text: name}} propName=\"name\" change={this.props.onChange('name')} options={options} />\n        <br />\n        {this.renderSince()}\n        <br />\n        {this.renderWithin()}\n      </label>\n    );\n  }\n\n  renderSince() {\n    let conditional = ((this.props.conditional: any): PriorStateConditional);\n    if (conditional.since == null) {\n      return (\n        <label>\n          <a className='editable-text' onClick={() => this.props.onChange('since')({val: {id: getTemplate('Attribute.Since')}})}>Add Since</a>\n        </label>\n      );\n    } else {\n      let options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n      let since = conditional.since;\n      return (\n        <label>\n          Prior State Since: <RIESelect className='editable-text' value={{id: since, text: since}} propName=\"since\" change={this.props.onChange('since')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('since')({val: {id: null}})}> (remove)</a>\n        </label>\n      );\n    }\n  }\n\n  renderWithin() {\n    let conditional = ((this.props.conditional: any): PriorStateConditional);\n    if (conditional.within == null) {\n      return (\n        <label>\n          <a className='editable-text' onClick={() => this.props.onChange('within')({val: {id: getTemplate('Attribute.Within')}})}>Add Within</a>\n          <br />\n        </label>\n      );\n    } else {\n      return (\n        <label>\n          Prior State Within Quantity: <RIENumber className='editable-text' value={conditional.within.quantity} propName=\"quantity\" change={this.props.onChange('within.quantity')} />\n          <br />\n          Prior State Within Unit: <RIESelect className='editable-text' value={{id: conditional.within.unit, text: conditional.within.unit}} propName=\"unit\" change={this.props.onChange('within.unit')} options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange('within')({val: {id: null}})}>Remove Within</a>\n        </label>\n      );\n    }\n  }\n\n}\n\nclass Attribute extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): AttributeConditional);\n    let options = [{id: '==' , text:'==' }, {id: '!=' , text:'!=' }, {id: \"<\" , text:\"<\" }, {id: \"<=\" , text:\"<=\" }, {id: \">\" , text:\">\" }, {id: \">=\", text:\">=\"}, {id: \"is nil\", text: \"is nil\"}, {id: \"is not nil\", text: \"is not nil\"}];\n\n    let val = conditional.value;\n    if(typeof val === 'boolean'){\n      val = String(val);\n    }\n\n    let valueInput = <div/>\n\n    // It appears that conditional is inconsistent, sometimes values are in ids\n    // This should be tracked down\n    if(conditional.operator !== 'is nil' && conditional.operator !== 'is not nil' && conditional.operator.id !== 'is nil' && conditional.operator.id !== 'is not nil'){\n      valueInput = <RIEInput className='editable-text' value={val||0} propName='value' change={this.props.onChange('value')} />\n    }\n\n    return (\n      <label>\n        <RIEInput className='editable-text' value={conditional.attribute} propName=\"attribute\" change={this.props.onChange('attribute')} />\n        <RIESelect className='editable-text' value={{id: conditional.operator, text: conditional.operator}} propName=\"operator\" change={this.props.onChange('operator')} options={options} />\n        {valueInput}\n      </label>\n    );\n  }\n\n}\n\nclass And extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): AndConditional);\n    return (\n      <label> And:\n        {conditional.conditions.map((cond, i) => {\n          return (\n            <div className=\"section\"  key={i}>\n              <ConditionalEditor {...this.props} conditional={cond} onChange={this.props.onChange(`conditions.${i}`)} />\n            </div>\n          )\n        })}\n      </label>\n    );\n  }\n\n}\n\nclass Or extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): OrConditional);\n    return (\n      <label> Or:\n        {conditional.conditions.map((cond, i) => {\n          return (\n              <div className=\"section\" key={i}>\n                <ConditionalEditor {...this.props} conditional={cond} onChange={this.props.onChange(`conditions.${i}`)} />\n              </div>\n          )\n        })}\n      </label>\n    );\n  }\n\n}\n\nclass AtLeast extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): AtLeastConditional);\n    return (\n      <label> At Least\n        <RIENumber className='editable-text' value={conditional.minimum||0} propName='minimum' change={this.props.onChange('minimum')} />:\n        {conditional.conditions.map((cond, i) => {\n          return (\n            <div className=\"section\" key={i}>\n              <ConditionalEditor {...this.props} conditional={cond} onChange={this.props.onChange(`conditions.${i}`)} />\n            </div>\n          )\n        })}\n      </label>\n    );\n  }\n\n}\n\nclass AtMost extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): AtMostConditional);\n    return (\n      <label> At Most\n        <RIENumber className='editable-text' value={conditional.maximum||0} propName='maximum' change={this.props.onChange('maximum')} />:\n\n        {conditional.conditions.map((cond, i) => {\n          return (\n            <div className=\"section\" key={i}>\n              <ConditionalEditor {...this.props} conditional={cond} onChange={this.props.onChange(`conditions.${i}`)} />\n            </div>\n          )\n        })}\n      </label>\n    );\n  }\n\n}\n\nclass Not extends Component<Props> {\n\n  render() {\n    let conditional = ((this.props.conditional: any): NotConditional);\n    return (\n      <label> Not:\n        <div className=\"section\">\n          <ConditionalEditor {...this.props} conditional={conditional.condition} onChange={this.props.onChange('condition')} />\n        </div>\n      </label>\n    );\n  }\n\n}\n\nexport default ConditionalEditor;\n","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect } from 'riek';\n\nimport type { DirectTransition } from '../../types/Transition';\nimport type { State } from '../../types/State';\n\ntype Props = {\n  options: State[],\n  transition?: DirectTransition,\n  onChange: any\n}\n\nclass DirectTransitionEditor extends Component<Props> {\n  render() {\n    let options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n\n    return (\n      <label>\n        Transition To:\n        <RIESelect className='editable-text' propName='to' value={{id:this.props.transition.to, text:this.props.transition.to}} change={this.props.onChange} options={options} />\n      </label>\n    );\n  }\n}\n\nexport default DirectTransitionEditor;\n","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect, RIEInput, RIENumber } from 'riek';\nimport _ from 'lodash';\n\n\nimport type { DistributedTransition as DistributedTransitionType } from '../../types/Transition';\nimport { getTemplate } from '../../templates/Templates';\nimport type { State } from '../../types/State';\nimport './Transition.css';\n\n\ntype Props = {\n  options: State[],\n  transition?: DistributedTransitionType,\n  onChange: any\n}\n\nclass DistributedTransition extends Component<Props> {\n  render() {\n    let currentValue = [];\n    if (this.props.transition) {\n      currentValue = this.props.transition.transition;\n    }\n    if(!this.props.transition) {\n      return null;\n    }\n    let options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n\n    return (\n      <label>\n        Distributed Transition:\n        {currentValue.map((t, i) => {\n          return <div key={i} className=\"transition-option\">\n            <label>To:\n              <RIESelect className='editable-text' propName='transition' value={{id:t.to, text:t.to}} change={this.props.onChange(`[${i}].transition`)} options={options} />\n            </label>\n            <br/>\n            {this.renderDistribution(t.distribution, i)}\n            <br/>\n            <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n          </div>\n        })}\n        <a className='editable-text add-button' onClick={() => this.props.onChange(`[${currentValue.length}]`)({val: {id: getTemplate('Transition.Distributed[0]')}})}>+</a>\n        <br/>\n        {this.renderWarning()}\n      </label>\n    );\n  }\n\n  renderDistribution(distribution: mixed, index: number) {\n    let sum = this.props.transition.transition.reduce( (acc, val) => acc + (typeof val.distribution === 'object' ? val.distribution.default : val.distribution),0);\n    let remainder = 0;\n    if(typeof distribution === 'object') {\n      remainder = 1 - (sum - distribution.default);\n      let remainderOption = null\n      if (sum != 1) {\n        remainderOption = <a className='editable-text' onClick={() => this.props.onChange(`[${index}].distribution.default`)({val: remainder})}>(Change to Remainder)</a>\n      }\n      return (\n        <label>\n          Attribute: <RIEInput className='editable-text' value={distribution.attribute} propName='attribute' change={this.props.onChange(`[${index}].distribution.attribute`)} />\n          <br />\n          Default Weight: <RIENumber className='editable-text' value={distribution.default} propName='default' editProps={{step: .01, min: 0, max: 1}} format={this.formatAsPercentage} validate={this.checkInRange} change={this.props.onChange(`[${index}].distribution.default`)} />\n          {remainderOption}\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange(`[${index}].distribution`)({val: {id: getTemplate('Attribute.UnnamedDistribution')}})}>Change to Unnamed Distribution</a>\n        </label>\n      );\n    } else {\n      remainder = 1 - (sum - distribution);\n      let remainderOption = null\n      if (sum != 1) {\n        remainderOption = <a className='editable-text' onClick={() => this.props.onChange(`[${index}].distribution`)({val: remainder})}>(Change to Remainder)</a>\n      }\n      return (\n        <label> Weight:\n          <RIENumber className='editable-text' value={distribution} propName='distribution' editProps={{step: .01, min: 0, max: 1}} format={this.formatAsPercentage} validate={this.checkInRange} change={this.props.onChange(`[${index}].distribution`)} />\n          {remainderOption}\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange(`[${index}].distribution`)({val: {id: getTemplate('Attribute.NamedDistribution')}})}>Change to Named Distribution</a>\n        </label>\n      );\n    }\n  }\n\n  renderWarning() {\n    if(!this.props.transition) {\n      return null;\n    }\n    let warn = (this.props.transition.transition.reduce((acc, val) => acc + (typeof val.distribution === 'object' ? val.distribution.default : val.distribution), 0) !== 1);\n    if (warn) {\n      return (\n        <label className='warning'>Weights do not add up to 100%.</label>\n      );\n    }\n  }\n\n  formatAsPercentage(num: number) {\n    return (num * 100) + \"%\";\n  }\n\n  checkInRange(num: number) {\n    return ((num >= 0) && (num <= 1));\n  }\n}\n\nexport default DistributedTransition;\n","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect } from 'riek';\nimport _ from 'lodash';\n\nimport type { ConditionalTransition as ConditionalTransitionType } from '../../types/Transition';\nimport { getTemplate } from '../../templates/Templates';\nimport ConditionalEditor from './Conditional';\nimport type { State } from '../../types/State';\nimport './Transition.css';\n\n\n\ntype Props = {\n  options: State[],\n  transition?: ConditionalTransitionType,\n  onChange: any\n}\n\nclass ConditionalTransition extends Component<Props> {\n\n  swapItems(indexTo,indexFrom) {\n    if(indexTo >= 0 && indexTo < this.props.transition.transition.length){\n\n      let oldEntry = {\n        transition: this.props.transition.transition[indexTo].to,\n        condition: _.clone(this.props.transition.transition[indexTo].condition)\n      };\n\n      let newEntry = {\n        transition: this.props.transition.transition[indexFrom].to,\n        condition: _.clone(this.props.transition.transition[indexFrom].condition)\n      }\n          \n      return () => {\n        this.props.onChange(indexTo)({val: {id: newEntry}});\n        this.props.onChange(indexFrom)({val: {id: oldEntry}});\n      }\n    }\n\n    return () => {};\n  }\n\n  renderUpDown(index: number) {\n  \n    if(this.props.transition && this.props.transition.transition){\n      if(index < this.props.transition.transition.length - 1 && index > 0){\n        return <span>\n            <a className=\"editable-text delete-button\" onClick={this.swapItems(index-1, index)}>move up</a> | \n            <a className=\"editable-text delete-button\" onClick={this.swapItems(index, index+1)}>move down</a>\n          </span>\n      } else if(index < this.props.transition.transition.length - 1){\n        return <a className=\"editable-text delete-button\" onClick={this.swapItems(index, index+1)}>move down</a>\n      } else if(index > 0){\n        return <a className=\"editable-text delete-button\" onClick={this.swapItems(index-1, index)}>move up</a>\n      }\n    }\n  }\n  renderIf(index, isLast){\n    if(!this.props.transition.transition[index].condition && isLast && index !== 0){\n      return <span>\n                Else: <a className=\"editable-text delete-button\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: getTemplate('Type.Condition.Age')}})}}>\n                        (add condition)\n                      </a>\n            </span>\n    } else if(!this.props.transition.transition[index].condition){\n      return <span>\n                <a className=\"editable-text delete-button editable-error\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: getTemplate('Type.Condition.Age')}})}}>\n                        Add Condition\n                      </a>\n            </span>\n    } else if(index === 0 && !this.props.transition.transition[index].condition){\n      return <span>\n                If: <a className=\"editable-text delete-button\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: getTemplate('Type.Condition.Age')}})}}>\n                        (add condition)\n                      </a>\n            </span>\n\n    } else if(index === 0){\n      return <span>If:</span>\n\n    } else if(!isLast){\n      return <span>\n              Else If:\n            </span>\n\n    }else{\n      return <span>\n            Else If: <a className=\"editable-text delete-button\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: null}})}}>\n                (remove condition)\n              </a>\n            </span>\n    }\n  }\n\n  render() {\n    let currentValue = [];\n    if (this.props.transition) {\n      currentValue = this.props.transition.transition;\n    }\n    if(!this.props.transition) {\n      return null;\n    }\n\n    return (\n      <label>\n        Conditional Transition To:\n        {currentValue.map((t, i) => {\n          let options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n          return <div key={i} className='transition-option'>\n            <label>\n              {this.renderIf(i, i === currentValue.length-1)} \n              <ConditionalEditor {...this.props} conditional={t.condition} onChange={this.props.onChange(`${i}.condition`)}/>\n            </label>\n            <br/>\n            <label>\n              Transition To: <RIESelect className='editable-text' propName='to' value={{id:t.to, text:t.to}} change={this.props.onChange(`${i}.transition`)} options={options} />\n            </label>\n            <br/>\n            {this.renderUpDown(i)}\n            <br/>\n            <a className=\"editable-text delete-button\" onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n\n          </div>\n        })}\n        <a className='editable-text add-button' onClick={() => this.props.onChange(`[${currentValue.length}]`)({val: {id: getTemplate('Transition.Conditional[0]')}})}>+</a>\n\n      </label>\n    );\n  }\n}\n\nexport default ConditionalTransition;\n","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect } from 'riek';\nimport _ from 'lodash';\n\nimport type { ConditionalTransition as ConditionalTransitionType } from '../../types/Transition';\nimport { getTemplate } from '../../templates/Templates';\nimport ConditionalEditor from './Conditional';\nimport DistributedTransitionEditor from './DistributedTransition';\nimport DirectTransitionEditor from './DirectTransition';\nimport type { State } from '../../types/State';\n\nimport './Transition.css';\n\n\n\ntype Props = {\n  options: State[],\n  transition?: ConditionalTransitionType,\n  onChange: any\n}\n\nclass ComplexTransition extends Component<Props> {\n\n  swapItems(indexTo,indexFrom) {\n    if(indexTo >= 0 && indexTo < this.props.transition.transition.length){\n      let oldEntry = {};\n      let newEntry = {};\n\n      if(this.props.transition.transition[indexTo].condition){\n        oldEntry.condition = _.clone(this.props.transition.transition[indexTo].condition)\n      }\n      if(this.props.transition.transition[indexTo].distributions){\n        oldEntry.distributions = _.clone(this.props.transition.transition[indexTo].distributions.map((d) => ({distribution: d.distribution, transition: d.to})))\n      }\n      if(this.props.transition.transition[indexTo].transition.to){\n        oldEntry.transition = this.props.transition.transition[indexTo].transition.to\n      }\n\n      if(this.props.transition.transition[indexFrom].condition){\n        newEntry.condition = _.clone(this.props.transition.transition[indexFrom].condition)\n      }\n      if(this.props.transition.transition[indexFrom].distributions){\n        newEntry.distributions = _.clone(this.props.transition.transition[indexFrom].distributions.map((d) => ({distribution: d.distribution, transition: d.to})))\n      }\n      if(this.props.transition.transition[indexFrom].transition.to){\n        newEntry.transition = this.props.transition.transition[indexFrom].transition.to\n      }\n\n      return () => {\n        this.props.onChange(indexTo)({val: {id: newEntry}});\n        this.props.onChange(indexFrom)({val: {id: oldEntry}});\n      }\n    }\n\n    return () => {};\n  }\n\n  renderUpDown(index: number) {\n  \n    if(this.props.transition && this.props.transition.transition){\n      if(index < this.props.transition.transition.length - 1 && index > 0){\n        return <span>\n            <a className=\"editable-text delete-button\" onClick={this.swapItems(index-1, index)}>move up</a> | \n            <a className=\"editable-text delete-button\" onClick={this.swapItems(index, index+1)}>move down</a>\n          </span>\n      } else if(index < this.props.transition.transition.length - 1){\n        return <a className=\"editable-text delete-button\" onClick={this.swapItems(index, index+1)}>move down</a>\n      } else if(index > 0){\n        return <a className=\"editable-text delete-button\" onClick={this.swapItems(index-1, index)}>move up</a>\n      }\n    }\n  }\n\n  renderIf(index, isLast){\n    if(!this.props.transition.transition[index].condition && isLast && index !==0){\n      return <span>\n                Else: <a className=\"editable-text delete-button\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: getTemplate('Type.Condition.Age')}})}}>\n                        (add condition)\n                      </a>\n            </span>\n    } else if(!this.props.transition.transition[index].condition){\n      return <span>\n                <a className=\"editable-text delete-button editable-error\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: getTemplate('Type.Condition.Age')}})}}>\n                        Add Condition\n                      </a>\n            </span>\n    } else if(index === 0 && !this.props.transition.transition[index].condition){\n      return <span>\n                If: <a className=\"editable-text delete-button\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: getTemplate('Type.Condition.Age')}})}}>\n                        (add condition)\n                      </a>\n            </span>\n\n    } else if(index === 0){\n      return <span>If:</span>\n\n    } else if(!isLast){\n      return <span>\n              Else If:\n            </span>\n\n    }else{\n      return <span>\n            Else If: <a className=\"editable-text delete-button\" onClick={()=>{this.props.onChange(`[${index}].condition`)({val: {id: null}})}}>\n                (remove condition)\n              </a>\n            </span>\n    }\n  }\n\n  renderTransition(t, i, isLast){\n\n    let transitionEditor = null;\n\n    if(t.transition.to !== undefined){\n      const newDistributedTransition = {...t, distributions: [{distribution: 1, transition: t.transition.to}]};\n      delete newDistributedTransition.transition;\n      transitionEditor = <div>\n                           <DirectTransitionEditor \n                             transition={t.transition}\n                             options={this.props.options} \n                             onChange={this.props.onChange(`[${i}].transition`)} />\n                           <br/>\n                           <a className=\"editable-text delete-button\" \n                              onClick={()=>{this.props.onChange(`[${i}]`)({val: {id: newDistributedTransition}})}}>Change to Distributed Transition</a>\n                          </div>\n    } else {\n      let nextTransition = 'Initial';\n      if(t.distributions.length > 0){\n        nextTransition = t.distributions[0].to\n      }\n\n      const newDirectTransition = {...t, distributions: [], transition: nextTransition};\n\n      transitionEditor = <div>\n                          <DistributedTransitionEditor \n                             transition={{transition: t.distributions}} \n                             options={this.props.options} \n                             onChange={this.props.onChange(`[${i}].distributions`)} />\n                           <br/>\n                           <a className=\"editable-text delete-button\" \n                              onClick={()=>{this.props.onChange(`[${i}]`)({val: {id: newDirectTransition}})}}>Change to Direct Transition</a>\n                          </div>\n    }\n\n    return <div className='transition-option' key={i}>\n            <label>\n            {this.renderIf(i, isLast)} <ConditionalEditor {...this.props} conditional={t.condition} onChange={this.props.onChange(`${i}.condition`)}/>\n            </label>\n            <br/>\n            <label>\n            {transitionEditor}\n            </label>\n            <br/>\n            {this.renderUpDown(i)}\n            <br/>\n            <a className='editable-text delete-button' onClick={() => this.props.onChange(`[${i}]`)({val: {id: null}})}>remove</a>\n          </div>\n  }\n\n  render() {\n    let currentValue = [];\n    if (this.props.transition) {\n      currentValue = this.props.transition.transition;\n    }\n    if(!this.props.transition) {\n      return null;\n    }\n    const states = this.props.options;\n    const options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n\n    return (\n      <label>\n        Complex Transition:\n\n        {currentValue.map((t, i) => {\n          return this.renderTransition(t, i, i === currentValue.length-1);\n        })}\n\n        <a className='editable-text add-button' onClick={() => this.props.onChange(`[${currentValue.length}]`)({val: {id: getTemplate('Transition.Complex[0]')}})}>+</a>\n\n      </label>\n    );\n  }\n}\n\nexport default ComplexTransition;\n","import React from \"react\";\nimport ReactDataGrid from \"react-data-grid\";\n    \n    function Table({columnHeaders, rows }) {\n        const columns = [];\n        \n        columnHeaders.forEach(function(item){\n            let str = item.replace(/\\s/g, '')\n            let a = {                    \n                key: str,\n                name: str,\n                width: 180,\n            }\n            columns.push(a);\n        })   \n        \n        return (\n        <ReactDataGrid \n            columns={columns}\n            rowGetter={i => rows[i]}\n            rowsCount={rows.length}\n            minHeight={300}\n            />\n        );\n    }\n\nexport default Table;","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect, RIEInput, RIENumber, RIETextArea } from 'riek';\nimport Papa from 'papaparse'\n\nimport { getTemplate } from '../../templates/Templates';\nimport './Transition.css';\nimport Table from './Table'\nimport './TableTransition.css';\nimport { isNumber } from 'util';\n\n\ntype Props = {\n  options: State[],\n  transition?: TableTransitionType,\n  onChange: any\n}\n\nclass TableTransition extends Component<Props> {\n\n  render() {\n    let currentValue = [];\n    let lookupTableName;\n    if (this.props.transition) {\n      this.fixMissingValues();\n      currentValue = this.props.transition.transition;\n      lookupTableName = this.props.transition.lookup_table_name_ModuleBuilder;\n    } else {\n      return null;\n    }\n\n    let buttonText;\n    let displayTable;\n    let displayTableError;\n    \n    if (this.props.transition.viewTable && !this.doesDataHaveInputError()){\n      buttonText = 'Display Editable Text Area';\n      let data = this.parseTextArea(this.props.transition.lookuptable);\n      displayTable = \n        <div className=\"TableTransition-table\">\n          <Table columnHeaders={Object.keys(data[0])} rows={data} />\n        </div>\n    }else{\n      buttonText = 'Display Read Only Table';\n      if (this.props.transition.lookuptable === ''){\n        this.props.onChange(`lookuptable`)({val: 'Enter table'});\n      }else if (isNumber(this.props.transition.lookuptable)){\n        this.props.transition.lookuptable = this.props.transition.lookuptable.toString();\n      }\n      displayTable = \n        <div className='TableTransition-remarks'>\n          <RIETextArea value={this.props.transition.lookuptable} propName='lookuptable' change={this.props.onChange(`lookuptable`)}/>\n        </div>\n    }\n    if (this.doesDataHaveInputError()){\n      displayTableError= <label className='warning'>Invalid table data. The table must have a header row and be separated by commas.</label>\n    }else {\n      let msg = this.checkTable();\n      displayTableError = <label className='warning'>{msg}</label>\n    }\n\n    let options = this.props.options.map((s) => {return {id: s.name, text: s.name}});\n    return (\n      <div>\n      <label>\n        Table Transition:\n        {\n          currentValue.map((t, i) => {\n          return <div key={i} className=\"transition-option\">\n            <label>To:\n              <RIESelect className='editable-text' propName='transition' value={{id:t.transition, text:t.transition}} change={this.props.onChange(`transitions[${i}].transition`)} options={options} />\n            </label>\n            <br/>\n            {this.renderDistribution(t.default_probability, i)}\n            <br />\n            <a className='editable-text delete-button' onClick={() => this.props.onChange(`transitions.[${i}]`)({val: {id: null}})}>remove</a>\n          </div>\n        })}\n        <a className='editable-text add-button' onClick={() => this.props.onChange(`transitions[${currentValue.length}]`)({val: {id: getTemplate('Transition.Table.transitions[0]')}})}>+</a>\n        <br/>\n        {this.renderWarning()}\n        <br/>\n        </label>\n        <div>\n          <label>Lookup Table: \n            <RIEInput className='editable-text' value={lookupTableName} propName='lookup_table_name_ModuleBuilder' change={this.props.onChange(`lookup_table_name_ModuleBuilder`)} />\n          </label>\n          <br/>\n          {displayTableError}\n          <br/>\n         <button onClick={() => this.displayTableView()}>{buttonText}</button>\n        <br/> \n        {displayTable}\n      </div>\n      </div>\n    );\n  }\n\n  renderDistribution(distribution: mixed, index: number) {    \n    let sum = this.props.transition.transition.reduce( (acc, val) => acc + val.default_probability, 0);\n    let remainder = 1 - (sum - distribution);\n    let remainderOption = null\n    if (sum !== 1) {\n      remainderOption = <a className='editable-text' onClick={() => this.props.onChange(`transitions[${index}].default_probability`)({val: remainder})}>(Change to Remainder)</a>\n    }\n    return (\n      <label> Default Weight:\n        <RIENumber className='editable-text' value={distribution} propName='default_probability' editProps={{step: .01, min: 0, max: 1}} format={this.formatAsPercentage} validate={this.checkInRange} change={this.props.onChange(`transitions[${index}].default_probability`)} />\n        {remainderOption}\n        </label>\n    );\n  }\n\n  renderWarning() {\n    if(!this.props.transition) {\n      return null;\n    }\n    let warn = (this.props.transition.transition.reduce((acc, val) => acc + (typeof val.default_probability === 'object' ? val.default_probability.default : val.default_probability), 0) !== 1);\n    if (warn) {\n      return (\n        <label className='warning'>Weights do not add up to 100%.</label>\n      );\n    }\n  }\n\n  formatAsPercentage(num: number) {\n    return (num * 100) + \"%\";\n  }\n\n  checkInRange(num: number) {\n    return ((num >= 0) && (num <= 1));\n  }\n\n  parseTextArea(data) {\n    let parsed;\n    if (isNumber(data))\n    {\n      data  = data.toString();\n    }\n    Papa.parse(data, {\n    header: true,\n    complete: function(results) {\n      parsed=results;\n    }\n    });\n\n    return parsed.data;\n  }    \n\n  displayTableView() {        \n    // need to check if the table is correct and that it will be ok being displayed as a table before changing this to true\n    // otherwise the undo take an extra click\n    if (!this.doesDataHaveInputError())\n    {\n      this.props.onChange('viewTable')({val: !this.props.transition.viewTable})\n    }\n  }\n\n  fixMissingValues(){\n    if (this.props.transition.lookuptable === undefined)\n    {\n      this.props.transition.lookuptable = '';\n    }\n    if (this.props.transition.viewTable === undefined)\n    {\n      this.props.transition.viewTable = false;\n    }\n    if (this.props.transition.lookup_table_name_ModuleBuilder === undefined)\n    {\n      if (this.props.transition.transition[0].lookup_table_name !== ''){\n        this.props.transition.lookup_table_name_ModuleBuilder = this.props.transition.transition[0].lookup_table_name;\n      }else{\n        this.props.transition.lookup_table_name_ModuleBuilder = '';\n      }\n    }\n  }\n\n  doesDataHaveInputError(){    \n    let data = this.parseTextArea(this.props.transition.lookuptable);\n    let textOk = !(this.props.transition.lookuptable === 'Enter table' || this.props.transition.lookuptable === '')\n    let parseOk = (data.length > 0 && Object.keys(data[0]).length > 0)\n    if (textOk && parseOk ){\n        return false;\n      } else {\n        return true;\n      } \n  }\n\n  checkTable(){\n    let message = ''\n    // check the last X columns vs X transitions\n    if (this.doesDataHaveInputError()){\n      return message;\n    }\n    let tableColumns = [];\n    let data = this.parseTextArea(this.props.transition.lookuptable);\n    if (data.length > 0){ \n      tableColumns = Object.keys(data[0]);\n    }\n\n    for (let i = 0; i < this.props.transition.transition.length; i++)\n    {\n      let transition = this.props.transition.transition[this.props.transition.transition.length - i - 1].transition;\n      let column = tableColumns[tableColumns.length-i -1];\n      if (transition !== column)\n      {\n        message += 'Invalid columns (table data and transitions to state don\\'t match) '\n        break;\n      }\n    }\n\n    return message;    \n  }\n}\n\nexport default TableTransition;\n","// @flow\nimport React, { Component } from 'react';\nimport type { Transition as TransitionType } from '../../types/Transition';\nimport type { State } from '../../types/State';\nimport DirectTransition from './DirectTransition';\nimport DistributedTransition from './DistributedTransition';\nimport ConditionalTransition from './ConditionalTransition';\nimport ComplexTransition from './ComplexTransition';\nimport TableTransition from './TableTransition';\n\ntype Props = {\n  options: State[],\n  transition?: Transition,\n  onChange: any\n}\n\nclass Transition extends Component<Props> {\n  render() {\n    if(this.props.transition){\n      switch (this.props.transition.type) {\n        case \"Direct\":\n          return <DirectTransition {...this.props} onChange={this.props.onChange('direct_transition')} />\n        case \"Distributed\":\n          return <DistributedTransition {...this.props} onChange={this.props.onChange('distributed_transition')} />\n        case \"Conditional\":\n          return <ConditionalTransition {...this.props} onChange={this.props.onChange('conditional_transition')} />\n        case \"Complex\":\n          return <ComplexTransition {...this.props} onChange={this.props.onChange('complex_transition')} />\n        case \"Table\":\n          return <TableTransition {...this.props} onChange={this.props.onChange('lookup_table_transition')} />\n        case \"None\":\n          return <div> No transition </div>\n        default:\n          return <div> {this.props.transition.type} Transition is not supported at this time </div>\n      }\n    }\n    return <div> No Transition </div>\n  }\n}\n\nexport default Transition;\n","export const BasicTutorial = [\n  {title: \"Create Module\", selector: \".Editor-top-open :nth-child(1)\", text: \"Create a new module\"},\n  {title: \"Open Module\", selector: \".Editor-top-open :nth-child(2)\", text: \"Open a module by selecting Open Module\"},\n  {title: \"Download Module\", selector: \".Editor-top-open :nth-child(3)\", text: \"Download module by selecting Download\"},\n  {title: \"Edit Node\", selector: \"#node_Initial\", text: \"To edit a node you can click on it in the graph\"},\n  {title: \"Module Remarks\", selector: \".ModuleProperties-remarks\", text: \"This is a place to put any remarks or citations for this module.\"},\n  {title: \"Adding a State\", selector: \".navbar-nav :nth-child(4)\", text: \"This will add a new state to the module, it can then be edited like any other state.\"},\n  {title: \"Adding a Structure\", selector: \".navbar-nav :nth-child(5)\", text: \"We have a few commonly used structures, this will allow you to add them to your module. This feature is not yet available.\"},\n]\n\nexport const EditTutorial = [\n  {title: \"Change State Name\", selector: \".State h3\", text: \"This text is editable, you can change the name of this state here.\"},\n  {title: \"Change State Type\", selector: \".State :nth-child(2)\", text: \"You can change the type of this state here, you can find a listing of state types at <a href='https://github.com/synthetichealth/synthea/wiki/Generic-Module-Framework%3A-States' target='_blank'> the wiki </a>.\"},\n  {title: \"State Editor\", selector: \".State-Editor\", text: \"Here is a context aware editor, depending on what your state has it will list the various attributes.\"},\n  {title: \"Delete State\", selector: \"div.State > a.delete-button\", text: \"This will remove the currently selected state from the editor.\"},\n  {title: \"Transition Type\", selector: \".Transition-Type\", text: \"You can change the type of the transition the module has here, <a href='https://github.com/synthetichealth/synthea/wiki/Generic-Module-Framework%3A-Transitions' target='_blank'> here </a> is a list of transition types.\"},\n\n\n]\n","import React from 'react'\nimport './AutoCompleteText.css'\n\nexport default class AutoCompleteText extends React.Component {\n    constructor (props) {\n        super(props);\n        this.handleChange = this.handleChange.bind(this);\n        this.state = {\n            suggestions: [],\n            text: this.props.text\n        }\n    }\n\n    suggestionSelected (value) {\n        this.props.onChange(value); \n        this.setState(() => ({\n            suggestions: [],\n        }));\n    }\n\n    renderSuggestions () {\n        const { suggestions } = this.state;\n        return (\n            <ul>\n                {suggestions.map((item, i) => <li key={i} onClick={() => this.suggestionSelected(item)}>{item}</li>)}\n            </ul>)\n    }\n\n    onFocusGained = (e) => {\n        let value =  e.target.value;\n        const { items } = this.props;\n        let suggestions = []\n        if (!value.match(/^[a-z0-9'-_() ]*$/i) || value.indexOf('\\\\') !== -1 || value.indexOf('*') === 0)\n        {\n            suggestions = ['Invalid Input'];\n        }\n        else \n        {\n            const regex = new RegExp (`^${value}`, 'i');\n            suggestions = items.sort().filter(v => regex.test(v));\n        }\n        \n        this.setState (() => ({suggestions, text: value}));    \n    }\n\n    onSubmitted = (props) => {\n        const timer = setTimeout(() => {\n            let suggestions = [];\n            this.setState (() => ({suggestions}))\n            this.props.onBlur(props); \n          }, 250);\n          return () => clearTimeout(timer);\n        \n    }\n\n    handleChange(event) {\n        const text = event.target.value;\n        this.props.onChange(text); \n        const { items } = this.props;\n        let suggestions = [];\n\n            if (text.match(/^[a-z0-9'-_() ]*$/i) && text.indexOf('\\\\') === -1 && text.indexOf('*') !== 0)\n            {\n                const regex = new RegExp (`^${text.toString()}`, 'i');\n                suggestions = items.sort().filter(v => regex.test(v));\n            }\n            else\n            {\n                suggestions = ['Invalid Input'];\n            }\n            \n            this.setState (() => ({suggestions, text: text}));\n      }\n\n      keyPressed = (event) => {\n        if (event.key === \"Enter\" ) {\n            this.onSubmitted(true);\n        }\n        if (event.key === \"Escape\") {\n            this.onSubmitted(false);\n        }\n      } \n\n    render () {\n        return (\n            <div className=\"AutoCompleteText\" onBlur={this.onSubmitted} >\n                <input value={this.props.text} onChange={this.handleChange} onFocus={this.onFocusGained} onKeyDown={this.keyPressed}  type=\"text\" />\n                {this.renderSuggestions()}\n            </div>\n        )\n    }\n}","export default `3decho\nAGE\nAGE_MONTHS\nAlzheimer\\'s Medication\nBMI\nBreast Cancer\nCF_Complication\nCystic_Fibrosis\nDALY\nER_PR_medication\nER_medication\nEarly menopause due to treatment\nG155D Mutation\nGlucose\nHER2_medication\nLung Cancer\nLung Cancer Condition\nLung Cancer Type\nMDD care plan\nMemory Loss\nMucus\nOTC_Bronchitis_Med\nQALY\nQOLS\nRH_NEG\nSSRI\nSinusitis Condition\nSore Throat Antibiotic\nSore Throat Condition\nSuspected Lung Cancer\nSystolic Blood Pressure\nTriglycerides\nType of Alzheimer\\'s\nUnusual Vaginal Bleeding\nactive_emergency_encounter\nactive_urgent_care_encounter\nactive_wellness_encounter\naddress\nadhd_medication\nadherence\nadherence probability\nadv_drug\nalcoholic\nalcoholism\nallergic_rhinitis\nanemia\nanemia_medication\nanemia_pregnancy\nantibiotic_prescription\narthritis_careplan\nassessment_done\nasthma_careplan\nasthma_condition\nasthma_type\natopic\natrial_fibrillation\natrial_fibrillation_risk\nbirth_city\nbirth_country\nbirth_state\nbirth_type\nbirthdate\nbirthplace\nblindness\nblood_pressure_controlled\nbmi_percentile\nbreast_cancer_ER\nbreast_cancer_HER2\nbreast_cancer_Location\nbreast_cancer_M\nbreast_cancer_N\nbreast_cancer_PR\nbreast_cancer_T\nbreast_cancer_aromatase_inhibitors\nbreast_cancer_chemoCount\nbreast_cancer_condition\nbreast_cancer_init_followup_counter\nbreast_cancer_neoCount\nbreast_cancer_neoMed\nbreast_cancer_survival\nbreast_cancer_tamoxifen\nbreast_cancer_treat_count\nbreast_cancer_triple_negative\nbreast_cancer_years_after_treatment\nbroken_bone\nbronchitis_careplan\nburn_injury\ncardio_risk\ncardiovascular_disease_med_changes\ncardiovascular_procedures\ncause_of_death\nchemoMed\nchemotherapy1\nchemotherapy2\nchf\nckd\ncolorectal_adenoma\ncolorectal_cancer\ncolorectal_cancer_stage\nconcussion_injury\ncontraceptive\ncontraceptive_type\ncopd_variant\ncoronary_heart_disease\ncr_chemo_count\ncurrent_weight_length_percentile\ndermatitis\ndiabetes\ndiabetes_amputation_necessary\ndiabetes_severity\ndiabetes_stage\ndiabetic_eye_damage\ndiabetic_nerve_damage\ndialysis_reason\neducation_level\nend_stage_renal_disease\nethnicity\nfatal_pregnancy_complication\nfibromyalgia_careplan\nfibromyalgia_prescription\nfirst_language\nfirst_name\nfood_allergy\nfood_allergy_careplan\ngender\ngout_careplan\ngout_nsaid\ngunshot_wound\nhomeless\nhomelessness_category\nhyperglycemia\nhyperlipidemia\nhypertension\nhypertension_dx\nhypertension_medication\nhypertension_medication_2\nhypertension_medication_3\nhypertriglyceridemia\nhypothyroidism\nid\nidentifier_drivers\nidentifier_passport\nidentifier_ssn\nimmunizations\nimmunotherapy_counter\nimmunotherapy_status\nincome\ninfertile\ninjury_careplan\ninpatient-count\ninpatient-los\ninstances_of_homelessness\njoint_replacement\nknee_injury\nlaceration_injury\nlast_name\nlast_visit_symptom_total\nleft_ventricular_hypertrophy\nlung_cancer\nlung_cancer_nondiagnosis_counter\nlung_transplant\nlupus_careplan\nlupus_corticosteroid\nmTBI\nmacular_edema\nmaiden_name\nmarital_status\nmdd\nmdd_psych\nmetabolic_syndrome\nmicroalbuminuria\nmiscarriage\nmost-recent-daly\nmost-recent-qaly\nmultiple_birth_status\nname\nname_father\nname_mother\nname_prefix\nname_suffix\nnephropathy\nneuropathy\nnon_low_risk_pregnancy\nnonproliferative_retinopathy\nnumber_of_children\nobesity\noccupation_level\nopioid_addiction\nopioid_addiction_careplan\nopioid_prescription\nosteoarthritis\nosteoporosis\notc_antihistamine\notc_pain_reliever\noutgrew_food_allergies\nprediabetes\npregnancy_birth_sex\npregnancy_careplan\npregnancy_complication\npregnant\nprobability_of_fall_injury\nprobability_of_lung_cancer\nprobability_of_suicide\nproliferative_retinopathy\nprostate_cancer\nproteinuria\nptsd\nptsd_careplan\nquit alcoholism age\nquit alcoholism probability\nquit smoking age\nquit smoking probability\nra_careplan\nrace\nrecurrent_colorectal_adenoma\nretinopathy\nseizure\nseizure_meds\nsexual_orientation\nsexually_active\nsmoker\nsmoking\nsmoking_medication\nsocioeconomic_category\nspinal_injury\nsprain_injury\nssri\nstatin_initial\nstatin_renewal\nstroke_history\nstroke_points\nstroke_risk\nsuicide\nsuicide_attempt\nsuicide_careplan\nsuicide_risk\ntelecom\ntext\nuti\nveteran\nveteran_population_override\nvisit_allergist\nwatchful_waiting\nzip`.split('\\n');","// @flow\nimport React, { Component } from 'react';\nimport { RIESelect, RIEInput, RIENumber, RIEToggle, RIETextArea } from 'riek';\nimport _ from 'lodash';\n\nimport type {\n  State, InitialState, TerminalState, SimpleState,\n  GuardState, DelayState, SetAttributeState, CounterState,\n  CallSubmoduleState, EncounterState, EncounterEndState,\n  ConditionOnsetState, ConditionEndState, AllergyOnsetState,\n  AllergyEndState, MedicationOrderState, MedicationEndState,\n  CarePlanStartState, CarePlanEndState, ProcedureState,\n  VitalSignState, ObservationState, MultiObservationState,\n  DiagnosticReportState, ImagingStudyState, SymptomState,\n  SupplyListState, DeviceState, DeviceEndState, DeathState\n} from '../../types/State';\n\nimport { Code, Codes } from './Code';\nimport { Reaction } from './Reaction';\nimport { Goals } from './Goal';\nimport { SeriesList } from './ImagingStudyAttributes';\nimport ConditionalEditor from './Conditional';\nimport Transition from './Transition';\nimport { getTemplate } from '../../templates/Templates';\nimport { BasicTutorial, EditTutorial } from '../../templates/Tutorial';\nimport AutoCompleteText from './AutoCompleteText';\nimport Attributes from './Attributes.js';\nimport AttributeData from '../analysis/AttributeData.json';\nimport './State.css';\n\ntype Props = {\n  moduleName: string,\n  state: State,\n  otherStates: State[],\n  onChange: any,\n  renameNode: any,\n  copyNode: any,\n  changeType: any,\n  addTransition: any,\n  helpFunction: any,\n  displayAttributes: any\n}\n\ntype Distro = {\n  kind: string,\n  parameters: any,\n  otherToggles: Component\n}\n\nconst unitOfTimeOptions = [\n  {id: 'years', text: 'years'},\n  {id: 'months', text: 'months'},\n  {id: 'weeks', text: 'weeks'},\n  {id: 'days', text: 'days'},\n  {id: 'hours', text: 'hours'},\n  {id: 'minutes', text: 'minutes'},\n  {id: 'seconds', text: 'seconds'}\n];\n\nclass StateEditor extends Component<Props> {\n\n  renderStateType() {\n    let props = {...this.props};\n    props.state.name = props.state.name || 'Unnamed_State';\n    props.onChange = this.props.onChange(`states.${props.state.name}`);\n    switch (this.props.state.type) {\n      case \"Initial\":\n        return <Initial {...props} />\n      case \"Terminal\":\n        return <Terminal {...props} />\n      case \"Simple\":\n        return <Simple {...props} />\n      case \"Guard\":\n        return <Guard {...props} />\n      case \"Delay\":\n        return <Delay {...props} />\n      case \"SetAttribute\":\n        return <SetAttribute {...props} />\n      case \"Counter\":\n        return <Counter {...props} />\n      case \"CallSubmodule\":\n        return <CallSubmodule {...props} />\n      case \"Encounter\":\n        return <Encounter {...props} />\n      case \"EncounterEnd\":\n        return <EncounterEnd {...props} />\n      case \"ConditionOnset\":\n        return <ConditionOnset {...props} />\n      case \"ConditionEnd\":\n        return <ConditionEnd {...props} />\n      case \"AllergyOnset\":\n        return <AllergyOnset {...props} />\n      case \"AllergyEnd\":\n        return <AllergyEnd {...props} />\n      case \"MedicationOrder\":\n        return <MedicationOrder {...props} />\n      case \"MedicationEnd\":\n        return <MedicationEnd {...props} />\n      case \"CarePlanStart\":\n        return <CarePlanStart {...props} />\n      case \"CarePlanEnd\":\n        return <CarePlanEnd {...props} />\n      case \"Procedure\":\n        return <Procedure {...props} />\n      case \"VitalSign\":\n        return <VitalSign {...props} />\n      case \"Observation\":\n        return <Observation {...props} />\n      case \"MultiObservation\":\n        return <MultiObservation {...props} />\n      case \"DiagnosticReport\":\n        return <DiagnosticReport {...props} />\n      case \"ImagingStudy\":\n        return <ImagingStudy {...props} />\n      case \"Symptom\":\n        return <Symptom {...props} />\n      case \"Device\":\n        return <Device {...props} />\n      case \"DeviceEnd\":\n        return <DeviceEnd {...props} />\n      case \"SupplyList\":\n        return <SupplyList {...props} />\n      case \"Death\":\n        return <Death {...props} />\n      default:\n        return this.props.state.type\n    }\n  }\n\n  updateRemarks = (el:any) => {\n    const remarks = el.remarks? el.remarks.split(\"\\n\") : null;\n    this.props.onChange(`states.${this.props.state.name}.remarks`)({remarks:{id:remarks}});\n  }\n\n  render() {\n    if(!this.props.state) {\n      return null;\n    }\n\n    let typeOptions = Object.keys(getTemplate('State')).sort().map((k) => {return {id: k, text: k}});\n    const transitionOptions = [\n      {id:\"None\" ,text:\"None\"},\n      {id:\"Direct\" ,text:\"Direct\"},\n      {id:\"Distributed\" ,text:\"Distributed\"},\n      {id:\"Conditional\" ,text:\"Conditional\"},\n      {id:\"Complex\" ,text:\"Complex\"},\n      {id:\"Table\" ,text:\"Table\"}\n    ]\n\n    let remarks = this.props.state.remarks ||\"\";\n    remarks = Array.isArray(remarks)? remarks.join(\"\\n\"): remarks;\n\n    const transitionType = (this.props.state.transition||{}).type;\n    return (\n        <div className=\"State\">\n          <div className='Editor-panel-title'>\n            State Editor\n          </div>\n          <h3><RIEInput className='editable-text' propName={'name'} value={this.props.state.name} change={this.props.renameNode} /></h3>\n          State Type: <RIESelect className='editable-text' value={{id: this.props.state.type, text: this.props.state.type}} propName='type'change={this.props.changeType} options={typeOptions}/>\n          <hr/>\n          <RIETextArea className='editable-text' value={remarks} propName=\"remarks\" change={this.updateRemarks} />\n          <br/>\n          <hr/>\n          <div className=\"State-Editor\">\n            {this.renderStateType()}\n          </div>\n          <br />\n          <hr />\n          <div>\n            <div className=\"Transition-Type\">Transition Type:\n              <RIESelect className='editable-text' value={{id: transitionType, text: transitionType}} propName='transition' change={(e) => this.props.addTransition(e.transition.id)} options={transitionOptions}/>\n            </div>\n          </div>\n          <div className=\"Transition\">\n            <Transition\n              options={this.props.otherStates.sort((a,b) => a.name > b.name? 1 : -1)}\n              transition={this.props.state.transition}\n              onChange={this.props.onChange(`states.${this.props.state.name}`)} />\n          </div>\n          <br/>\n          <a onClick={this.props.helpFunction(EditTutorial)}>Help</a>\n        </div>\n    )\n  }\n\n}\n\nclass Initial extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): InitialState);\n    return (\n      null\n    );\n  }\n\n}\n\nclass Terminal extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): TerminalState);\n    return (\n      null\n    );\n  }\n\n}\n\nclass Simple extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): SimpleState);\n    return (\n      null\n    );\n  }\n\n}\n\nclass Guard extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): GuardState);\n    return (\n      <div>\n        <ConditionalEditor {...this.props} conditional={state.allow} options={this.props.otherStates} onChange={this.props.onChange('allow')} />\n      </div>\n    );\n  }\n\n}\n\nclass Distribution extends Component<Distro> {\n  render() {\n    switch (this.props.kind) {\n      case \"EXACT\":\n        return <Exact {...this.props} onChange={this.props.onChange} />\n      case \"GAUSSIAN\":\n        return <Gaussian {...this.props} onChange={this.props.onChange} />\n      case \"UNIFORM\":\n        return <Uniform {...this.props} onChange={this.props.onChange} />\n    }\n  }\n}\n\nclass Exact extends Component<Distro> {\n  render() {\n    return (\n      <div>\n        Exact Quantity: <RIENumber className='editable-text' value={this.props.parameters.value} propName='value' change={this.props.onChange('parameters.value')} />\n        <br />\n        <a className='editable-text' onClick={() => {this.props.onChange('kind')({val: {id: 'UNIFORM'}}); this.props.onChange('parameters')({val: {id: {high: 20, low: 10}}})}}>Change to Range</a>\n        <br />\n        <a className='editable-text' onClick={() => {this.props.onChange('kind')({val: {id: 'GAUSSIAN'}}); this.props.onChange('parameters')({val: {id: {mean: 10, standardDeviation: 1}}})}}>Change to Gaussian</a>\n        <br />\n        {this.props.otherToggles}\n      </div>\n    );\n  }\n}\n\nclass Uniform extends Component<Distro> {\n  render() {\n    return (\n      <div>\n        Range Low: <RIENumber className='editable-text' value={this.props.parameters.low} propName='low' change={this.props.onChange('parameters.low')} />\n        <br />\n        Range High: <RIENumber className='editable-text' value={this.props.parameters.high} propName='high' change={this.props.onChange('parameters.high')} />\n        <br />\n        {this.props.round!=null &&\n        <div>Round Result: <RIEToggle value={this.props.round} propName='round' change={this.props.onChange('round')} />\n        <br /></div> }\n        <a className='editable-text' onClick={() => {this.props.onChange('kind')({val: {id: 'EXACT'}}); this.props.onChange('parameters')({val: {id: {value: 10}}})}}>Change to Exact</a>\n        <br />\n        <a className='editable-text' onClick={() => {this.props.onChange('kind')({val: {id: 'GAUSSIAN'}}); this.props.onChange('parameters')({val: {id: {mean: 10, standardDeviation: 1}}})}}>Change to Gaussian</a>\n        <br />\n        {this.props.otherToggles}\n      </div>\n    );\n  }\n}\n\nclass Gaussian extends Component<Distro> {\n  render() {\n    return (\n      <div>\n        Mean: <RIENumber className='editable-text' value={this.props.parameters.mean} propName='mean' change={this.props.onChange('parameters.mean')} />\n        <br />\n        Standard Deviation: <RIENumber className='editable-text' value={this.props.parameters.standardDeviation} propName='standardDeviation' change={this.props.onChange('parameters.standardDeviation')} />\n        <br />\n        {this.props.round!=null &&\n        <div>Round Result: <RIEToggle value={this.props.round} propName='round' change={this.props.onChange('round')} />\n        <br /></div> }\n        <a className='editable-text' onClick={() => {this.props.onChange('kind')({val: {id: 'EXACT'}}); this.props.onChange('parameters')({val: {id: {value: 10}}})}}>Change to Exact</a>\n        <br />\n        <a className='editable-text' onClick={() => {this.props.onChange('kind')({val: {id: 'UNIFORM'}}); this.props.onChange('parameters')({val: {id: {high: 20, low: 10}}})}}>Change to Range</a>\n        <br />\n        {this.props.otherToggles}\n      </div>\n    );\n  }\n}\n\n\nclass Delay extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): DelayState);\n    let form;\n    if (this.legacyGMF()) {\n      form = this.renderLegacyExactOrRange();\n    } else {\n      form = this.renderExactOrRange();\n    }\n    return (\n      <div>\n        {form}\n      </div>\n    );\n  }\n\n  renderExactOrRange() {\n    let state = ((this.props.state: any): DelayState);\n    return (\n      <div>\n        <Distribution kind={state.distribution.kind}\n                      parameters={state.distribution.parameters}\n                      onChange={this.props.onChange('distribution')} />\n        Unit: <RIESelect className='editable-text'\n                         value={{id: state.unit, text: state.unit}}\n                         propName=\"unit\"\n                         change={this.props.onChange('unit')}\n                         options={unitOfTimeOptions} />\n        <br />\n      </div>\n    );\n  }\n\n  renderLegacyExactOrRange() {\n    let state = ((this.props.state: any): DelayState);\n    if (state.exact) {\n      return (\n        <div>\n          Exact Quantity: <RIENumber className='editable-text' value={state.exact.quantity} propName='quantity' change={this.props.onChange('exact.quantity')} />\n          <br />\n          Exact Unit: <RIESelect className='editable-text' value={{id: state.exact.unit, text: state.exact.unit}} propName=\"unit\" change={this.props.onChange('exact.unit')} options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.RangeWithUnit')}}); this.props.onChange('exact')({val: {id: null}})}}>Change to Range</a>\n          <br />\n        </div>\n      );\n    }\n    else {\n      return (\n        <div>\n          Range Low: <RIENumber className='editable-text' value={state.range.low} propName='low' change={this.props.onChange('range.low')} />\n          <br />\n          Range High: <RIENumber className='editable-text' value={state.range.high} propName='high' change={this.props.onChange('range.high')} />\n          <br />\n          Range Unit: <RIESelect className='editable-text' value={{id: state.range.unit, text: state.range.unit}} propName=\"unit\" change={this.props.onChange('range.unit')} options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('exact')({val: {id: getTemplate('Attribute.ExactWithUnit')}}); this.props.onChange('range')({val: {id: null}})}}>Change to Exact</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  legacyGMF() {\n    let state = ((this.props.state: any): DelayState);\n    if (state.exact || state.range) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nclass SetAttribute extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.attribute,\n      lastSubmitted : this.props.state.attribute,\n      displayLabel : true,\n      value_code : this.props.state.value_code\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): SetAttributeState);\n    let displayAttribute;\n    let valueForm;\n    if (this.legacyGMF()) {\n      valueForm = this.renderLegacyValueOrRange();\n    } else {\n      valueForm = this.renderValueContainer()\n    }\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.attribute]!= undefined)\n        {\n          Object.keys(data[state.attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (state.attribute === '')\n        {\n          state.attribute = 'text';\n        }\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    return (\n      <div>\n        Attribute: {displayAttribute}\n        <br/>\n        {valueForm}\n      </div>\n    );\n  }\n\n  legacyGMF() {\n    let state = ((this.props.state: any): SetAttributeState);\n    if (state.range) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  renderValueContainer() {\n    let state = ((this.props.state: any): SetAttributeState);\n    if (state.distribution) {\n      return (\n        <div>\n          <Distribution kind={state.distribution.kind}\n                        round={state.distribution.round}\n                        parameters={state.distribution.parameters}\n                        onChange={this.props.onChange('distribution')} />\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange('distribution')({val: {id: null}})}>(remove)</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('value')({val: {id: \"text\"}}); this.props.onChange('distribution')({val: {id: null}})}}>Change to Value</a>\n        </div>\n      );\n    } else if (state.value) {\n      let val = state.value;\n      if(typeof val === 'boolean'){\n        val = String(val);\n      }\n      return (\n        <div>\n          Value: <RIEInput className='editable-text' value={val} propName={'value'} change={this.props.onChange('value')} />\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange('value')({val: {id: null}})}>(remove)</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('distribution')({val: {id: {kind: \"EXACT\", round: false, parameters: {value: 1}}}}); this.props.onChange('value')({val: {id: null}})}}>Change to Distribution</a>\n        </div>\n      );\n    } else if (state.value_code) {\n      return (\n        <div className='section'>\n          <Code code={state.value_code} system={\"LOINC\"} onChange={this.props.onChange('value_code')} />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('value')({val: {id: \"text\"}})}>Add Value</a><br />\n          <a className='editable-text' onClick={() => this.props.onChange('distribution')({val: {id: {kind: \"EXACT\", round: false, parameters: {value: 1}}}})}>Add Distribution</a><br />\n          <a className='editable-text' onClick={() => {this.props.onChange('value_code')({val: {id:  getTemplate('Type.Code.Loinc')}});}}>Add Code</a>\n          <br />\n        </div>\n      );\n    }\n\n  }\n\n  renderLegacyValueOrRange() {\n    let state = ((this.props.state: any): SetAttributeState);\n\n    if (state.value == null && state.range == null) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('value')({val: {id: \"text\"}})}>Add Value</a><br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.Range')}})}}>Add Range</a>\n          <br />\n        </div>\n      );\n    } else if (state.value != null) {\n      let val = state.value;\n      if(typeof val === 'boolean'){\n        val = String(val);\n      }\n      return (\n        <div>\n          Value: <RIEInput className='editable-text' value={val} propName={'value'} change={this.props.onChange('value')} />\n          <a className='editable-text' onClick={() => this.props.onChange('value')({val: {id: null}})}>(remove)</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.Range')}}); this.props.onChange('value')({val: {id: null}})}}>Change to Range</a>\n        </div>\n      );\n    } else if (state.range != null) {\n      return (\n        <div className='section'>\n          Range Low: <RIENumber className='editable-text' value={state.range.low} propName='low' change={this.props.onChange('range.low')} />\n          <br />\n          Range High: <RIENumber className='editable-text' value={state.range.high} propName='high' change={this.props.onChange('range.high')} />\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange('range')({val: {id: null}})}>(Remove Range)</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('value')({val: {id: 1}}); this.props.onChange('range')({val: {id: null}})}}>Change to Value</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.attribute != this.state.value)\n    {\n      this.props.onChange('attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.attribute});\n    this.setState({lastSubmitted: this.props.state.attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass Counter extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.attribute,//'',\n      lastSubmitted : this.props.state.attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): CounterState);\n    let options = [\n      {id: 'increment', text: 'increment'},\n      {id: 'decrement', text: 'decrement'}\n    ];\n\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.attribute]!= undefined)\n        {\n          Object.keys(data[state.attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (state.attribute === '')\n        {\n          state.attribute = 'text';\n        }\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    return (\n      <div>\n        Attribute: {displayAttribute}\n        <br/>\n        Action: <RIESelect className='editable-text' value={{id: state.action, text: state.action}} propName=\"action\" change={this.props.onChange('action')} options={options} />\n        <br/>\n        Amount: <RIENumber className='editable-text' value={state.amount || 1} propName='amount' change={this.props.onChange('amount')} />\n      </div>\n    );\n  }\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.attribute != this.state.value)\n    {\n      this.props.onChange('attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.attribute});\n    this.setState({lastSubmitted: this.props.state.attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass CallSubmodule extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): CallSubmoduleState);\n    return (\n      <div>\n        Submodule: <RIEInput className='editable-text' value={state.submodule} propName={'submodule'} change={this.props.onChange('submodule')} />\n        <br/>\n        <a href={`${window.location.href.replace(window.location.hash,\"\")}#${state.submodule}`} target=\"_blank\">View Submodule</a>\n\n      </div>\n    );\n  }\n\n}\n\nclass Encounter extends Component<Props> {\n\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.reason,\n      lastSubmitted : this.props.state.reason,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.reason != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): EncounterState);\n    let options = [\n      {id: 'emergency', text: 'emergency'},\n      {id: 'inpatient', text: 'inpatient'},\n      {id: 'ambulatory', text: 'ambulatory'},\n      {id: 'urgentcare', text: 'urgentcare'},\n      {id: 'hospice', text: 'hospice'},\n      {id: 'home', text: 'home'},\n      {id: 'snf', text: 'snf'}\n    ];\n    if (state.wellness == null) {\n      return (\n        <div>\n          {this.renderWellness()}\n          Encounter Class: <RIESelect className='editable-text' value={{id: state.encounter_class, text: state.encounter_class}} propName=\"encounter_class\" change={this.props.onChange('encounter_class')} options={options} />\n          <br />\n          {this.renderReason()}\n          <div className='section'>\n            Codes\n            <br />\n            <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          {this.renderWellness()}\n          {this.renderReason()}\n        </div>\n      );\n    }\n\n  }\n\n  renderWellness() {\n    let state = ((this.props.state: any): EncounterState);\n    if (state.wellness == null) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => {this.props.onChange('wellness')({val: {id: true}}); this.props.onChange('codes')({val: {id: null}}); this.props.onChange('encounter_class')({val: {id: null}})}}>Add Wellness</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Wellness\n          <a className='editable-text' onClick={() => {this.props.onChange('wellness')({val: {id: null}}); this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.Snomed')]}})}}>(remove)</a>\n          <br />\n        </div>\n      );\n    }\n\n  }\n\n  renderReason() {\n    let state = ((this.props.state: any): EncounterState);\n    if (!state.reason) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: \"Select Condition/Enter Attribute\"}})}>Add Reason</a>\n          <br />\n        </div>\n      );\n    } else {\n      let conditionOnset = this.props.otherStates.filter((s) => {return s.type === \"ConditionOnset\"});\n      let options = conditionOnset.map((e) => {return {id: e.name, text: e.name}});\n      let inputAttribute = [{id: \"*Input Attribute*\", text: \"*Input Attribute*\"}];\n      let allOptions = options.concat(inputAttribute);\n      let reason = <RIESelect className='editable-text' value={{id: state.reason, text: state.reason}} propName={'reason'}  change={this.props.onChange('reason')} options={allOptions} />\n      if (state.reason === \"*Input Attribute*\") {\n        let displayAttribute;\n        if (this.state.displayLabel)\n        {\n            const data = AttributeData;\n            let others = [this.props.moduleName];\n            if (data[state.reason]!= undefined)\n            {\n              Object.keys(data[state.reason].read).forEach(i => {others.push(i)})\n              Object.keys(data[state.reason].write).forEach(i => {others.push(i)})\n            }\n            others = others.filter((x, i, a) => a.indexOf(x) == i)\n            others.splice(others.indexOf[this.props.moduleName], 1);\n\n            if (state.reason === '')\n            {\n              state.reason = 'text';\n            }\n            if (others.length > 0)\n            {\n              displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.reason}</label>\n              <button classNameName=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n              </span>\n            }\n            else{\n              displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.reason}</label>\n            }\n\n        }\n        else\n        {\n         displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n        }\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n            Attribute: {displayAttribute}\n            <br/>\n          </div>\n        );\n      } else {\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n          </div>\n        );\n      }\n    }\n  }\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.reason != this.state.value)\n    {\n      this.props.onChange('reason')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.reason});\n    this.setState({lastSubmitted: this.props.state.reason})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n\n}\n\nclass EncounterEnd extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): EncounterEndState);\n    return (\n      <div>\n        {this.renderDischargeDisposition()}\n      </div>\n    );\n  }\n\n  renderDischargeDisposition() {\n    let state = ((this.props.state: any): EncounterEndState);\n    if (!state.discharge_disposition) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('discharge_disposition')({val: {id: getTemplate('Type.Code.Nubc')}})}>Add Discharge Disposition</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <Code code={state.discharge_disposition} system={\"NUBC\"} onChange={this.props.onChange('discharge_disposition')} />\n          <a className='editable-text' onClick={() => this.props.onChange('discharge_disposition')({val: {id: null}})}>Remove Discharge Disposition</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n}\n\nclass ConditionOnset extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.assign_to_attribute,//'',\n      lastSubmitted : this.props.state.assign_to_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.assign_to_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n\n    let state = ((this.props.state: any): ConditionOnsetState);\n    return (\n      <div>\n        {this.renderTargetEncounter()}\n        {this.renderAssignToAttribute()}\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n        </div>\n      </div>\n    );\n  }\n\n  renderTargetEncounter() {\n    let state = ((this.props.state: any): ConditionOnsetState);\n    let encounters = this.props.otherStates.filter((s) => {return s.type === \"Encounter\"});\n    let options = encounters.map((e) => {return {id: e.name, text: e.name}});\n    let targetEncounter = <RIESelect className='editable-text' value={{id: state.target_encounter, text: state.target_encounter}} propName={'target_encounter'}  change={this.props.onChange('target_encounter')} options={options} />\n    if (state.target_encounter) {\n      return (\n        <div>\n          Target Encounter: {targetEncounter}\n          <br/>\n          <a className='editable-text' onClick={() => this.props.onChange('target_encounter')({val: {id: null}})}>(remove to diagnose immediately)</a>\n          <br/>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('target_encounter')({val: {id: \"text\"}})}>Add Target Encounter</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderAssignToAttribute() {\n    let state = ((this.props.state: any): ConditionOnsetState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.assign_to_attribute]!= undefined)\n        {\n          Object.keys(data[state.assign_to_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.assign_to_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.assign_to_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: \"text\"}})}>Add Assign to Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Assign to Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.assign_to_attribute != this.state.value)\n    {\n      this.props.onChange('assign_to_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.assign_to_attribute});\n    this.setState({lastSubmitted: this.props.state.assign_to_attribute})\n  }\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\n\nclass ConditionEnd extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.referenced_by_attribute,\n      lastSubmitted : this.props.state.referenced_by_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.referenced_by_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): ConditionEndState);\n    return (\n      <div>\n        {this.renderConditionOnset()}\n        {this.renderReferencedByAttribute()}\n        {this.renderCodes()}\n      </div>\n    );\n  }\n\n  renderConditionOnset() {\n    let state = ((this.props.state: any): ConditionEndState);\n    let conditionOnset = this.props.otherStates.filter((s) => {return s.type === \"ConditionOnset\"});\n    let options = conditionOnset.map((e) => {return {id: e.name, text: e.name}});\n    if (!state.condition_onset) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('condition_onset')({val: {id: \"text\"}})}>Add Condition Onset</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Condition Onset: <RIESelect className='editable-text' value={{id: state.condition_onset, text: state.condition_onset}} propName={'condition_onset'}  change={this.props.onChange('condition_onset')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('condition_onset')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReferencedByAttribute() {\n    let state = ((this.props.state: any): ConditionEndState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.referenced_by_attribute]!= undefined)\n        {\n          Object.keys(data[state.referenced_by_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.referenced_by_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.referenced_by_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: \"text\"}})}>Add Referenced by Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Referenced by Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderCodes() {\n    let state = ((this.props.state: any): ConditionEndState);\n    if (!state.codes) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Codes</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: null}})}>Remove Codes</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.referenced_by_attribute != this.state.value)\n    {\n      this.props.onChange('referenced_by_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.referenced_by_attribute});\n    this.setState({lastSubmitted: this.props.state.referenced_by_attribute})\n  }\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass AllergyOnset extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.assign_to_attribute,//'',\n      lastSubmitted : this.props.state.assign_to_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.assign_to_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): AllergyOnsetState);\n    let encounters = this.props.otherStates.filter((s) => {return s.type === \"Encounter\"});\n    let options = encounters.map((e) => {return {id: e.name, text: e.name}});\n    return (\n      <div>\n        Target Encounter: <RIESelect className='editable-text' value={{id: state.target_encounter, text: state.target_encounter}} propName={'target_encounter'} change={this.props.onChange('target_encounter')} options={options} />\n        <br />\n        {this.renderAssignToAttribute()}\n        <div className='section'>\n          Codes\n          <br />\n          { state.category == \"medication\" ? <Codes codes={state.codes} system={\"RxNorm\"} onChange={this.props.onChange('codes')} /> : <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} /> }\n        </div>\n        <div>\n          <label>Allergy Type:\n            <RIESelect className='editable-text'\n              propName='allergy_type'\n              value={{id: state.allergy_type, text: state.allergy_type}}\n              change={this.props.onChange('allergy_type')}\n              options={[{id:'allergy', text: 'Allergy'}, {id:'intolerance', text: 'Intolerance'}]}\n            />\n          </label>\n        </div>\n        <div>\n          <label>Category:\n            <RIESelect className='editable-text'\n              propName='category'\n              value={{id: state.category, text: state.category}}\n              change={this.props.onChange('category')}\n              options={[{id:'food', text: 'Food'},\n                        {id:'medication', text: 'Medication'},\n                        {id:'environment', text: 'Environment'}]}\n            />\n          </label>\n        </div>\n        <div className='section'>\n        Reactions:\n        {this.renderReactions(state)}\n        <a className='editable-text' onClick={() => this.props.onChange(`reactions[${this.props.state.reactions.length}]`)({val: {id: {reaction: {code: \"1234\", system: \"SNOMED-CT\", display: \"SNOMED Code\"}, possible_severities: [{level: \"mild\", value: 1}]}}})}>+</a>\n        </div>\n      </div>\n    );\n  }\n\n  renderReactions(state) {\n    if(state.reactions == null) {\n      return null;\n    } else {\n      return state.reactions.map((r, i) => {\n          return (\n            <div className='section' key={i}>\n              <a className='editable-text delete-button' onClick={() => this.props.onChange(`reactions[${i}]`)({val: {id: null}})}>remove</a>\n              <Reaction reaction={r} onChange={this.props.onChange(`reactions[${i}]`)}/>\n            </div>\n          );\n      });\n    }\n  }\n\n  renderAssignToAttribute() {\n    let state = ((this.props.state: any): AllergyOnsetState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.assign_to_attribute]!= undefined)\n        {\n          Object.keys(data[state.assign_to_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.assign_to_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.assign_to_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: \"text\"}})}>Add Assign to Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Assign to Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.assign_to_attribute != this.state.value)\n    {\n      this.props.onChange('assign_to_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.assign_to_attribute});\n    this.setState({lastSubmitted: this.props.state.assign_to_attribute})\n  }\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass AllergyEnd extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.referenced_by_attribute,\n      lastSubmitted : this.props.state.referenced_by_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.referenced_by_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): AllergyEndState);\n    return (\n      <div>\n        {this.renderAllergyOnset()}\n        {this.renderReferencedByAttribute()}\n        {this.renderCodes()}\n      </div>\n    );\n  }\n\n  renderAllergyOnset() {\n    let state = ((this.props.state: any): AllergyEndState);\n    let allergyOnset = this.props.otherStates.filter((s) => {return s.type === \"AllergyOnset\"});\n    let options = allergyOnset.map((e) => {return {id: e.name, text: e.name}});\n    if (!state.allergy_onset) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('allergy_onset')({val: {id: \"text\"}})}>Add Allergy Onset</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Allergy Onset: <RIESelect className='editable-text' value={{id: state.allergy_onset, text: state.allergy_onset}} propName={'allergy_onset'}  change={this.props.onChange('allergy_onset')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('allergy_onset')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReferencedByAttribute() {\n    let state = ((this.props.state: any): AllergyEndState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.referenced_by_attribute]!= undefined)\n        {\n          Object.keys(data[state.referenced_by_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.referenced_by_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.referenced_by_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: \"text\"}})}>Add Referenced by Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Referenced by Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderCodes() {\n    let state = ((this.props.state: any): AllergyEndState);\n    if (!state.codes) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Codes</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: null}})}>Remove Codes</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.referenced_by_attribute != this.state.value)\n    {\n      this.props.onChange('referenced_by_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.referenced_by_attribute});\n    this.setState({lastSubmitted: this.props.state.referenced_by_attribute})\n  }\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass MedicationOrder extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleTextChangeReason = this.handleTextChangeReason.bind(this);\n    this.handleSubmitReason = this.handleSubmitReason.bind(this);\n    this.state = {\n      value : this.props.state.assign_to_attribute,\n      lastSubmitted : this.props.state.assign_to_attribute,\n      displayLabel : true,\n      valueReason : this.props.state.reason,\n      lastSubmittedReason : this.props.state.reason,\n      displayLabelReason : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.assign_to_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): MedicationOrderState);\n    return (\n      <div>\n        {this.renderAssignToAttribute()}\n        {this.renderReason()}\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"RxNorm\"} onChange={this.props.onChange('codes')} />\n          <br />\n        </div>\n        {this.renderPrescription()}\n        {this.renderChronicMed()}\n        {this.renderCreateAdministration()}\n      </div>\n    );\n  }\n\n  renderChronicMed() {\n    let state = ((this.props.state: any): MedicationOrder);\n    return (\n      <div>\n        <input type=\"checkbox\" checked={state.chronic} onChange={() => this.props.onChange('chronic')({ val: { id: !state.chronic } })} /> Chronic Medication.\n      </div>\n    );\n  }\n\n  renderCreateAdministration() {\n    let state = ((this.props.state: any): MedicationOrder);\n    return (\n      <div>\n        <input type=\"checkbox\" checked={state.administration} onChange={() => this.props.onChange('administration')({ val: { id: !state.administration } })} /> Administration of the medication.\n      </div>\n    );\n  }\n\n  renderAssignToAttribute() {\n    let state = ((this.props.state: any): ConditionOnsetState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.assign_to_attribute]!= undefined)\n        {\n          Object.keys(data[state.assign_to_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.assign_to_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.assign_to_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: \"text\"}})}>Add Assign to Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Assign to Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReason() {\n    let state = ((this.props.state: any): MedicationOrder);\n    if (!state.reason) {\n      if( this.state.valueReason !== 'text')\n      {\n        this.setState({valueReason: 'text'});\n      }\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: \"Select Condition/Enter Attribute\"}})}>Add Reason</a>\n          <br />\n        </div>\n      );\n    } else {\n      let conditionOnset = this.props.otherStates.filter((s) => {return s.type === \"ConditionOnset\"});\n      let options = conditionOnset.map((e) => {return {id: e.name, text: e.name}});\n      let inputAttribute = [{id: \"*Input Attribute*\", text: \"*Input Attribute*\"}];\n      let allOptions = options.concat(inputAttribute);\n      let reason = <RIESelect className='editable-text' value={{id: state.reason, text: state.reason}} propName={'reason'}  change={this.props.onChange('reason')} options={allOptions} />\n      if (state.reason === \"*Input Attribute*\") {\n        let displayAttribute;\n        if (this.state.displayLabelReason)\n        {\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabelReason}>{state.reason}</label>\n\n        }\n        else\n        {\n         displayAttribute = <AutoCompleteText onChange={this.handleTextChangeReason} onBlur={this.handleSubmitReason} text={this.state.valueReason} items={Attributes}/>\n        }\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n            Attribute: {displayAttribute}\n            <br/>\n          </div>\n        );\n      } else {\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n          </div>\n        );\n      }\n    }\n  }\n\n  renderPrescription() {\n    let state = ((this.props.state: any): MedicationOrderState);\n    if (!state.prescription) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('prescription')({val: {id: getTemplate('Attribute.Prescription')}})}>Add Prescription</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Prescription\n          {this.renderRefills()}\n          {this.renderAsNeeded()}\n          {this.renderDosage()}\n          {this.renderDuration()}\n          {this.renderInstructions()}\n          <a className='editable-text' onClick={() => this.props.onChange('prescription')({val: {id: null}})}> Remove Prescription</a>\n        </div>\n      );\n    }\n  }\n\n  renderRefills() {\n    let state = ((this.props.state: any): MedicationOrderState);\n    if (!state.prescription.refills) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('prescription.refills')({val: {id: 1}})}>Add Prescription Refills</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Prescription Refills: <RIENumber className='editable-text' value={state.prescription.refills} propName={'refills'}  change={this.props.onChange('prescription.refills')} />\n          <a className='editable-text' onClick={() => this.props.onChange('prescription.refills')({val: {id: null}})}>(remove)</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderAsNeeded() {\n    let state = ((this.props.state: any): MedicationOrderState);\n    if (state.prescription.as_needed == null) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('prescription.as_needed')({val: {id: true}})}>Add Prescription As Needed</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Prescription As Needed\n          <a className='editable-text' onClick={() => this.props.onChange('prescription.as_needed')({val: {id: null}})}>(remove)</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderDosage() {\n    let state = ((this.props.state: any): MedicationOrderState);\n    if (!state.prescription.dosage) {\n      return null;\n    }\n    return (\n      <div className='section'>\n        Dosage Amount: <RIENumber className='editable-text' value={state.prescription.dosage.amount} propName={'amount'}  change={this.props.onChange('prescription.dosage.amount')} />\n        <br />\n        Dosage Frequency: <RIENumber className='editable-text' value={state.prescription.dosage.frequency} propName={'frequency'}  change={this.props.onChange('prescription.dosage.frequency')} />\n        <br />\n        Dosage Period: <RIENumber className='editable-text' value={state.prescription.dosage.period} propName={'period'}  change={this.props.onChange('prescription.dosage.period')} />\n        <br />\n        Dosage Unit: <RIESelect className='editable-text' value={{id: state.prescription.dosage.unit, text: state.prescription.dosage.unit}} propName=\"unit\" change={this.props.onChange('prescription.dosage.unit')} options={unitOfTimeOptions} />\n        <br />\n      </div>\n    );\n  }\n\n  renderDuration() {\n    let state = ((this.props.state: any): MedicationOrderState);\n    if (!state.prescription.duration) {\n      return null;\n    }\n    return (\n      <div className='section'>\n        Duration Quantity: <RIENumber className='editable-text' value={state.prescription.duration.quantity} propName={'quantity'}  change={this.props.onChange('prescription.duration.quantity')} />\n        <br />\n        Duration Unit: <RIESelect className='editable-text' value={{id: state.prescription.duration.unit, text: state.prescription.duration.unit}} propName=\"unit\" change={this.props.onChange('prescription.duration.unit')} options={unitOfTimeOptions} />\n        <br />\n      </div>\n    );\n  }\n\n  renderInstructions() {\n    let state = ((this.props.state: any): MedicationOrderState);\n    if (!state.prescription.instructions) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('prescription.instructions')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Instructions</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Instructions\n          <br />\n          <Codes codes={state.prescription.instructions} system={\"SNOMED-CT\"} onChange={this.props.onChange('prescription.instructions')} />\n          <a className='editable-text' onClick={() => this.props.onChange('prescription.instructions')({val: {id: null}})}>Remove Instructions</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.assign_to_attribute != this.state.value)\n    {\n      this.props.onChange('assign_to_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.assign_to_attribute});\n    this.setState({lastSubmitted: this.props.state.assign_to_attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n  handleTextChangeReason(value) {\n    this.setState({valueReason: value});\n\n  }\n\n  handleSubmitReason(save) {\n    if (save && this.props.state.reason != this.state.valueReason)\n    {\n      this.props.onChange('reason')({val: this.state.valueReason})\n      this.setState({lastSubmittedReason: this.state.valueReason})\n    }\n    else {\n      this.setState({valueReason: this.state.lastSubmittedReason})\n    }\n    this.toggleLabelReason();\n  }\n\n  toggleLabelReason = () =>  {\n    this.setState({displayLabelReason: !this.state.displayLabelReason});\n  }\n\n}\n\nclass MedicationEnd extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.referenced_by_attribute,\n      lastSubmitted : this.props.state.referenced_by_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.referenced_by_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): MedicationEndState);\n    return (\n      <div>\n        {this.renderMedicationOrder()}\n        {this.renderReferencedByAttribute()}\n        {this.renderCodes()}\n      </div>\n    );\n  }\n\n  renderMedicationOrder() {\n    let state = ((this.props.state: any): MedicationEndState);\n    let medicationOrder = this.props.otherStates.filter((s) => {return s.type === \"MedicationOrder\"});\n    let options = medicationOrder.map((e) => {return {id: e.name, text: e.name}});\n    if (!state.medication_order) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('medication_order')({val: {id: \"text\"}})}>Add Medication Order</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Medication Order: <RIESelect className='editable-text' value={{id: state.medication_order, text: state.medication_order}} propName={'medication_order'}  change={this.props.onChange('medication_order')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('medication_order')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReferencedByAttribute() {\n    let state = ((this.props.state: any): MedicationEndState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.referenced_by_attribute]!= undefined)\n        {\n          Object.keys(data[state.referenced_by_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.referenced_by_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.referenced_by_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: \"text\"}})}>Add Referenced by Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Referenced by Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderCodes() {\n    let state = ((this.props.state: any): MedicationEndState);\n    if (!state.codes) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.RxNorm')]}})}>Add Codes</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: null}})}>Remove Codes</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.referenced_by_attribute != this.state.value)\n    {\n      this.props.onChange('referenced_by_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.referenced_by_attribute});\n    this.setState({lastSubmitted: this.props.state.referenced_by_attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass CarePlanStart extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleTextChangeReason = this.handleTextChangeReason.bind(this);\n    this.handleSubmitReason = this.handleSubmitReason.bind(this);\n    this.state = {\n      value : this.props.state.assign_to_attribute,\n      lastSubmitted : this.props.state.assign_to_attribute,\n      displayLabel : true,\n      valueReason : this.props.state.reason,\n      lastSubmittedReason : this.props.state.reason,\n      displayLabelReason : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.assign_to_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): CarePlanStartState);\n    return (\n      <div>\n        {this.renderAssignToAttribute()}\n        {this.renderReason()}\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <br />\n        </div>\n        {this.renderActivities()}\n        {this.renderGoals()}\n      </div>\n    );\n  }\n\n  renderAssignToAttribute() {\n    let state = ((this.props.state: any): CarePlanStartState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.assign_to_attribute]!= undefined)\n        {\n          Object.keys(data[state.assign_to_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.assign_to_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.assign_to_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: \"text\"}})}>Add Assign to Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Assign to Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReason() {\n    let state = ((this.props.state: any): CarePlanStart);\n    if (!state.reason) {\n      if( this.state.valueReason !== 'text')\n      {\n        this.setState({valueReason: 'text'});\n      }\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: \"Select Condition/Enter Attribute\"}})}>Add Reason</a>\n          <br />\n        </div>\n      );\n    } else {\n      let conditionOnset = this.props.otherStates.filter((s) => {return s.type === \"ConditionOnset\"});\n      let options = conditionOnset.map((e) => {return {id: e.name, text: e.name}});\n      let inputAttribute = [{id: \"*Input Attribute*\", text: \"*Input Attribute*\"}];\n      let allOptions = options.concat(inputAttribute);\n      let reason = <RIESelect className='editable-text' value={{id: state.reason, text: state.reason}} propName={'reason'}  change={this.props.onChange('reason')} options={allOptions} />\n      if (state.reason === \"*Input Attribute*\") {\n        let displayAttribute;\n\n        if (this.state.displayLabelReason)\n        {\n            displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabelReason}>{state.reason}</label>\n        }\n        else\n        {\n         displayAttribute = <AutoCompleteText onChange={this.handleTextChangeReason} onBlur={this.handleSubmitReason} text={this.state.valueReason} items={Attributes}/>\n        }\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n            Attribute: {displayAttribute}\n            <br/>\n          </div>\n        );\n      } else {\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n          </div>\n        );\n      }\n    }\n  }\n\n  renderActivities() {\n    let state = ((this.props.state: any): CarePlanStartState);\n    if (!state.activities) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('activities')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Activities</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Activities\n          <br />\n          <Codes codes={state.activities} system={\"SNOMED-CT\"} onChange={this.props.onChange('activities')} />\n          <a className='editable-text' onClick={() => this.props.onChange('activities')({val: {id: null}})}>Remove Activities</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderGoals() {\n    let state = ((this.props.state: any): CarePlanStartState);\n    if (!state.goals) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('goals')({val: {id: [getTemplate('Attribute.Goal')]}})}>Add Goals</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Goals\n          <br />\n          <Goals goals={state.goals} onChange={this.props.onChange('goals')} />\n          <a className='editable-text' onClick={() => this.props.onChange('goals')({val: {id: null}})}>Remove Goals</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.assign_to_attribute != this.state.value)\n    {\n      this.props.onChange('assign_to_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.assign_to_attribute});\n    this.setState({lastSubmitted: this.props.state.assign_to_attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n  handleTextChangeReason(value) {\n    this.setState({valueReason: value});\n\n  }\n\n  handleSubmitReason(save) {\n    if (save && this.props.state.reason != this.state.valueReason)\n    {\n      this.props.onChange('reason')({val: this.state.valueReason})\n      this.setState({lastSubmittedReason: this.state.valueReason})\n    }\n    else {\n      this.setState({valueReason: this.state.lastSubmittedReason})\n    }\n    this.toggleLabelReason();\n  }\n\n  toggleLabelReason = () =>  {\n    this.setState({displayLabelReason: !this.state.displayLabelReason});\n  }\n}\n\nclass CarePlanEnd extends Component<Props> {\n\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.referenced_by_attribute,\n      lastSubmitted : this.props.state.referenced_by_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.referenced_by_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): CarePlanEndState);\n    return (\n      <div>\n        {this.renderCarePlan()}\n        {this.renderReferencedByAttribute()}\n        {this.renderCodes()}\n      </div>\n    );\n  }\n\n  renderCarePlan() {\n    let state = ((this.props.state: any): CarePlanEndState);\n    let careplans = this.props.otherStates.filter((s) => {return s.type === \"CarePlanStart\"});\n    let options = careplans.map((e) => {return {id: e.name, text: e.name}});\n    if (!state.careplan) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('careplan')({val: {id: \"text\"}})}>Add Care Plan</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Care Plan: <RIESelect className='editable-text' value={{id: state.careplan, text: state.careplan}} propName={'careplan'}  change={this.props.onChange('careplan')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('careplan')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReferencedByAttribute() {\n    let state = ((this.props.state: any): CarePlanEndState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.referenced_by_attribute]!= undefined)\n        {\n          Object.keys(data[state.referenced_by_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.referenced_by_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.referenced_by_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: \"text\"}})}>Add Referenced by Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Referenced by Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderCodes() {\n    let state = ((this.props.state: any): CarePlanEndState);\n    if (!state.codes) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Codes</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: null}})}>Remove Codes</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.referenced_by_attribute != this.state.value)\n    {\n      this.props.onChange('referenced_by_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.referenced_by_attribute});\n    this.setState({lastSubmitted: this.props.state.referenced_by_attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass Procedure extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChangeReason = this.handleTextChangeReason.bind(this);\n    this.handleSubmitReason = this.handleSubmitReason.bind(this);\n    this.state = {\n      valueReason : this.props.state.reason,\n      lastSubmittedReason : this.props.state.reason,\n      displayLabelReason : true,\n    }\n  }\n\n  legacyGMF() {\n    let state = ((this.props.state: any): ProcedureState);\n    if (state.duration) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  render() {\n    let state = ((this.props.state: any): ProcedureState);\n    let durationEditor;\n    if (this.legacyGMF()) {\n      durationEditor = this.renderLegacyDuration();\n    } else {\n      durationEditor = this.renderDuration();\n    }\n    return (\n      <div>\n        {this.renderReason()}\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <br />\n        </div>\n        {durationEditor}\n      </div>\n    );\n  }\n\n  renderReason() {\n    let state = ((this.props.state: any): Procedure);\n    if (!state.reason) {\n      if( this.state.valueReason !== 'text')\n      {\n        this.setState({valueReason: 'text'});\n      }\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: \"Select Condition/Enter Attribute\"}})}>Add Reason</a>\n          <br />\n        </div>\n      );\n    } else {\n      let conditionOnset = this.props.otherStates.filter((s) => {return s.type === \"ConditionOnset\"});\n      let options = conditionOnset.map((e) => {return {id: e.name, text: e.name}});\n      let inputAttribute = [{id: \"*Input Attribute*\", text: \"*Input Attribute*\"}];\n      let allOptions = options.concat(inputAttribute);\n      let reason = <RIESelect className='editable-text' value={{id: state.reason, text: state.reason}} propName={'reason'}  change={this.props.onChange('reason')} options={allOptions} />\n      if (state.reason === \"*Input Attribute*\") {\n        let displayAttribute;\n\n        if (this.state.displayLabelReason)\n        {\n            displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabelReason}>{state.reason}</label>\n        }\n        else\n        {\n         displayAttribute = <AutoCompleteText onChange={this.handleTextChangeReason} onBlur={this.handleSubmitReason} text={this.state.valueReason} items={Attributes}/>\n        }\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n            Attribute: {displayAttribute}\n            <br/>\n          </div>\n        );\n      } else {\n        return (\n          <div>\n            Reason: {reason}\n            <a className='editable-text' onClick={() => this.props.onChange('reason')({val: {id: null}})}>(remove)</a>\n            <br/>\n          </div>\n        );\n      }\n    }\n  }\n\n  renderDuration() {\n    let state = ((this.props.state: any): ProcedureState);\n    if (state.distribution) {\n      return (\n        <div>\n          <Distribution kind={state.distribution.kind}\n                        parameters={state.distribution.parameters}\n                        onChange={this.props.onChange('distribution')} />\n          Unit: <RIESelect className='editable-text'\n                          value={{id: state.unit, text: state.unit}}\n                          propName=\"unit\"\n                          change={this.props.onChange('unit')}\n                          options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange('distribution')({val: {id: null}})}>(remove)</a>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => {\n            this.props.onChange('distribution')({val: {id: {kind: \"UNIFORM\", parameters:{low: 30, high: 60}}}});\n            this.props.onChange('unit')({val: {id: \"minutes\"}});\n          }}>Add Duration</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderLegacyDuration() {\n    let state = ((this.props.state: any): ProcedureState);\n    if (!state.duration) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('duration')({val: {id: {low: 10, high: 20, unit: 'days'}}})}>Add Duration</a>\n          <br />\n        </div>\n      );\n      return null;\n    } else {\n      return (\n        <div className='section'>\n          Duration Low: <RIENumber className='editable-text' value={state.duration.low} propName={'low'}  change={this.props.onChange('duration.low')} />\n          <br />\n          Duration High: <RIENumber className='editable-text' value={state.duration.high} propName={'high'}  change={this.props.onChange('duration.high')} />\n          <br />\n          Duration Unit: <RIESelect className='editable-text' value={{id: state.duration.unit, text: state.duration.unit}} propName=\"unit\" change={this.props.onChange('duration.unit')} options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => this.props.onChange('duration')({val: {id: null}})}>(remove)</a>\n        </div>\n      );\n    }\n  }\n\n  handleTextChangeReason(value) {\n    this.setState({valueReason: value});\n\n  }\n\n  handleSubmitReason(save) {\n    if (save && this.props.state.reason != this.state.valueReason)\n    {\n      this.props.onChange('reason')({val: this.state.valueReason})\n      this.setState({lastSubmittedReason: this.state.valueReason})\n    }\n    else {\n      this.setState({valueReason: this.state.lastSubmittedReason})\n    }\n    this.toggleLabelReason();\n  }\n\n  toggleLabelReason = () =>  {\n    this.setState({displayLabelReason: !this.state.displayLabelReason});\n  }\n\n}\n\nclass VitalSign extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): VitalSignState);\n    let distroForm;\n    if (this.legacyGMF()) {\n      distroForm = this.renderExactOrRange();\n    } else {\n      distroForm = this.renderDistribution();\n    }\n    return (\n      <div>\n        Vital Sign: <RIEInput className='editable-text' value={state.vital_sign} propName={'vital_sign'} change={this.props.onChange('vital_sign')} />\n        <br/>\n        Unit: <RIEInput className='editable-text' value={state.unit} propName={'unit'} change={this.props.onChange('unit')} />\n        <br/>\n        {distroForm}\n      </div>\n    );\n  }\n\n  legacyGMF() {\n    let state = ((this.props.state: any): VitalSignState);\n    if (state.exact || state.range) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  renderDistribution() {\n    let state = ((this.props.state: any): SymptomState);\n    return (\n      <div>\n        <Distribution kind={state.distribution.kind}\n                      parameters={state.distribution.parameters}\n                      onChange={this.props.onChange('distribution')} />\n        <br />\n      </div>\n    );\n  }\n\n  renderExactOrRange() {\n    let state = ((this.props.state: any): VitalSignState);\n    if (state.exact) {\n      return (\n        <div className='section'>\n          Exact Quantity: <RIENumber className='editable-text' value={state.exact.quantity} propName='quantity' change={this.props.onChange('exact.quantity')} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.Range')}}); this.props.onChange('exact')({val: {id: null}})}}>Change to Range</a>\n          <br />\n        </div>\n      );\n    }\n    else {\n      return (\n        <div className='section'>\n          Range Low: <RIENumber className='editable-text' value={state.range.low} propName='low' change={this.props.onChange('range.low')} />\n          <br />\n          Range High: <RIENumber className='editable-text' value={state.range.high} propName='high' change={this.props.onChange('range.high')} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('exact')({val: {id: getTemplate('Attribute.Exact')}}); this.props.onChange('range')({val: {id: null}})}}>Change to Exact</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n}\n\nclass Observation extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.attribute,//'',\n      lastSubmitted : this.props.state.attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): ObservationState);\n    let options = [\n      {id: 'social-history', text: 'social-history'},\n      {id: 'vital-signs', text: 'vital-signs'},\n      {id: 'imaging', text: 'imaging'},\n      {id: 'laboratory', text: 'laboratory'},\n      {id: 'procedure', text: 'procedure'},\n      {id: 'survey', text: 'survey'},\n      {id: 'exam', text: 'exam'},\n      {id: 'therapy', text: 'therapy'}\n    ];\n    return (\n      <div>\n        Category: <RIESelect className='editable-text' value={{id: state.category, text: state.category}} propName=\"category\" change={this.props.onChange('category')} options={options} />\n        <br/>\n        Unit: <RIEInput className='editable-text' value={state.unit} propName={'unit'} change={this.props.onChange('unit')} />\n        <br/>\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"LOINC\"} onChange={this.props.onChange('codes')} />\n          <br/>\n        </div>\n        {this.renderValueContainer()}\n      </div>\n    );\n  }\n\n  legacyGMF() {\n    let state = ((this.props.state: any): ObservationState);\n    if (state.exact || state.range) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  renderValueContainer() { // renders exact, range, attribute, or vital_sign\n    let state = ((this.props.state: any): ObservationState);\n    if (this.legacyGMF() && state.exact) {\n      let value = state.exact.quantity;\n      if(typeof value === 'boolean'){\n        value = String(value);\n      }\n      return (\n        <div className='section'>\n          Exact Value: <RIEInput className='editable-text' value={value} propName='quantity' change={this.props.onChange('exact.quantity')} />\n          <br />\n          { this.renderToggles('exact') }\n        </div>\n      );\n    } else if (this.legacyGMF() && state.range) {\n      return (\n        <div className='section'>\n          Range Low: <RIENumber className='editable-text' value={state.range.low} propName='low' change={this.props.onChange('range.low')} />\n          <br />\n          Range High: <RIENumber className='editable-text' value={state.range.high} propName='high' change={this.props.onChange('range.high')} />\n          <br />\n          { this.renderToggles('range') }\n        </div>\n      );\n    } else if (state.distribution) {\n      return (\n        <Distribution kind={state.distribution.kind}\n                      round={state.distribution.round}\n                      parameters={state.distribution.parameters}\n                      onChange={this.props.onChange('distribution')}\n                      otherToggles={this.renderToggles('distribution')} />\n      );\n    } else if (state.attribute) {\n      let displayAttribute;\n      if (this.state.displayLabel)\n      {\n          const data = AttributeData;\n          let others = [this.props.moduleName];\n          if (data[state.attribute]!= undefined)\n          {\n            Object.keys(data[state.attribute].read).forEach(i => {others.push(i)})\n            Object.keys(data[state.attribute].write).forEach(i => {others.push(i)})\n          }\n          others = others.filter((x, i, a) => a.indexOf(x) == i)\n          others.splice(others.indexOf[this.props.moduleName], 1);\n\n          if (others.length > 0)\n          {\n            displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.attribute}</label>\n            <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n            </span>\n          }\n          else{\n            displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.attribute}</label>\n          }\n\n      }\n      else\n      {\n       displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n      }\n      return (\n        <div className='section'>\n          Attribute: {displayAttribute}\n          <br/>\n          { this.renderToggles('attribute') }\n        </div>\n      );\n    } else if (state.value_code) {\n      return (\n        <div className='section'>\n          <Code code={state.value_code} system={\"SNOMED-CT\"} onChange={this.props.onChange('value_code')} />\n          { this.renderToggles('value_code') }\n        </div>\n      );\n    } else if (state.vital_sign) {\n      return (\n        <div className='section'>\n          Vital Sign: <RIEInput className='editable-text' value={state.vital_sign} propName={'vital_sign'}  change={this.props.onChange('vital_sign')} />\n          { this.renderToggles('vital_sign') }\n        </div>\n      );\n    } else if (state.attachment) {\n      return (\n        <div className='section'>\n          Observation Attachments Not Supported.\n        </div>\n      );\n    } else if (state.sampled_data) {\n      return (\n        <div className='section'>\n          Observation Sampled Data Not Supported.\n        </div>\n      );\n    }\n  }\n\n  clearProps(...propsToClear) {\n    propsToClear.forEach((propName) => {\n      this.props.onChange(propName)({val: {id: null}});\n    })\n  }\n\n  renderToggles(currentItem) {\n    console.log(currentItem);\n\n    let toggles = [];\n\n    if (currentItem !== 'exact' && currentItem !== 'distribution') {\n      toggles.push(\n                <div key='exact'>\n                  <a className='editable-text' onClick={() => {this.props.onChange('exact')({val: {id: getTemplate('Attribute.Exact')}}); this.clearProps('range', 'attribute', 'vital_sign', 'value_code', 'distribution')}}>Change to Exact</a>\n                  <br />\n                </div>\n        );\n    }\n\n    if (currentItem !== 'range' && currentItem !== 'distribution') {\n      toggles.push(\n                <div key='range'>\n                  <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.Range')}}); this.clearProps('exact', 'attribute', 'vital_sign', 'value_code', 'distribution')}}>Change to Range</a>\n                  <br />\n                </div>\n        );\n    }\n\n    if (currentItem !== 'attribute') {\n      toggles.push(\n                <div key='attribute'>\n                  <a className='editable-text' onClick={() => {this.props.onChange('attribute')({val: {id: \"text\"}}); this.clearProps('exact', 'range', 'vital_sign', 'value_code', 'distribution')}}>Change to Attribute</a>\n                  <br />\n                </div>\n        );\n    }\n\n    if (currentItem !== 'vital_sign') {\n      toggles.push(\n                <div key='vital_sign'>\n                  <a className='editable-text' onClick={() => {this.props.onChange('vital_sign')({val: {id: \"text\"}}); this.clearProps('exact', 'range', 'attribute', 'value_code', 'distribution')}}>Change to Vital Sign</a>\n                  <br />\n                </div>\n        );\n    }\n\n    if (currentItem !== 'value_code') {\n      toggles.push(\n                <div key='value_code'>\n                  <a className='editable-text' onClick={() => {this.props.onChange('value_code')({val: {id:  getTemplate('Type.Code.Snomed')}}); this.clearProps('exact', 'range', 'attribute', 'vital_sign', 'distribution')}}>Change to Value Code</a>\n                  <br />\n                </div>\n        );\n    }\n\n    return toggles;\n  }\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.attribute != this.state.value)\n    {\n      this.props.onChange('attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.attribute});\n    this.setState({lastSubmitted: this.props.state.attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nclass MultiObservation extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): MultiObservationState);\n    let observationCount = (state.observations && state.observations.length) || 0;\n    let options = [\n      {id: 'social-history', text: 'social-history'},\n      {id: 'vital-signs', text: 'vital-signs'},\n      {id: 'imaging', text: 'imaging'},\n      {id: 'laboratory', text: 'laboratory'},\n      {id: 'procedure', text: 'procedure'},\n      {id: 'survey', text: 'survey'},\n      {id: 'exam', text: 'exam'},\n      {id: 'therapy', text: 'therapy'}\n    ];\n    return (\n      <div>\n        Category: <RIESelect className='editable-text' value={{id: state.category, text: state.category}} propName=\"category\" change={this.props.onChange('category')} options={options} />\n        <br />\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"LOINC\"} onChange={this.props.onChange('codes')} />\n          <br />\n        </div>\n        <div className='section'>\n          <b>Observations</b>\n          <br />\n          {state.observations && state.observations.map((observation, i) => {\n            return (\n              <div className='section' key={i}>\n                Observation #{i+1} (<a className='editable-text delete-button' onClick={() => this.props.onChange(`observations.[${i}]`)({val: {id: null}})}>remove</a>)\n                <Observation state={observation} onChange={this.props.onChange(`observations.[${i}]`)} />\n              </div>\n            )\n          })}\n          <a className='editable-text' onClick={() => this.props.onChange(`observations.[${observationCount}]`)({val: {id: _.cloneDeep(getTemplate('Contained.Observation'))}})}>+</a>\n        </div>\n      </div>\n    );\n  }\n\n}\n\nclass DiagnosticReport extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): DiagnosticReportState);\n    let observationCount = (state.observations && state.observations.length) || 0;\n    return (\n      <div>\n        <div className='section'>\n          <b>Codes</b>\n          <br />\n          <Codes codes={state.codes} system={\"LOINC\"} onChange={this.props.onChange('codes')} />\n        </div>\n        <div className='section'>\n          <b>Observations</b>\n          <br />\n          {state.observations && state.observations.map((observation, i) => {\n            return (\n              <div className='section' key={i}>\n                Observation #{i+1} (<a className='editable-text delete-button' onClick={() => this.props.onChange(`observations.[${i}]`)({val: {id: null}})}>remove</a>)\n                <Observation state={observation} onChange={this.props.onChange(`observations.[${i}]`)} />\n              </div>\n            )\n          })}\n        <a className='editable-text' onClick={() => this.props.onChange(`observations.[${observationCount}]`)({val: {id: _.cloneDeep(getTemplate('Contained.Observation'))}})}>+</a>\n\n        </div>\n      </div>\n    );\n  }\n\n}\n\nclass ImagingStudy extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): ImagingStudyState);\n    return (\n      <div>\n        <div className='section'>\n          <b>Procedure Code:</b>\n          <Code code={state.procedure_code} system={\"SNOMED-CT\"} onChange={this.props.onChange('procedure_code')} />\n          <br />\n        </div>\n        <div className='section'>\n          <b>Series:</b>\n          <br />\n          <SeriesList series={state.series} onChange={this.props.onChange('series')} />\n          <br />\n        </div>\n      </div>\n    );\n  }\n\n}\n\nclass Symptom extends Component<Props> {\n\n  render() {\n    let state = ((this.props.state: any): SymptomState);\n    let distroForm;\n    if (this.legacyGMF()) {\n      distroForm = this.renderExactOrRange();\n    } else {\n      distroForm = this.renderDistribution();\n    }\n    return (\n      <div>\n        Symptom: <RIEInput className='editable-text' value={state.symptom} propName={'symptom'} change={this.props.onChange('symptom')} />\n        <br/>\n        {this.renderProbability()}\n        {this.renderCause()}\n        {distroForm}\n      </div>\n    );\n  }\n\n  renderDistribution() {\n    let state = ((this.props.state: any): SymptomState);\n    return (\n      <div>\n        <Distribution kind={state.distribution.kind}\n                      parameters={state.distribution.parameters}\n                      onChange={this.props.onChange('distribution')} />\n        <br />\n      </div>\n    );\n  }\n\n  legacyGMF() {\n    let state = ((this.props.state: any): SymptomState);\n    if (state.exact || state.range) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  renderProbability() {\n    let state = ((this.props.state: any): SymptomState);\n    if (!state.probability) {\n      return (\n        <div>\n          Probability: <RIENumber className='editable-text' value={1} propName={'probability'} editProps={{step: .01, min: 0, max: 1}} change={this.props.onChange('probability')} format={this.formatAsPercentage} validate={this.checkInRange} classInvalid=\"invalid\" />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Probability: <RIENumber className='editable-text' value={state.probability} propName={'probability'} editProps={{step: .01, min: 0, max: 1}} change={this.props.onChange('probability')} format={this.formatAsPercentage} validate={this.checkInRange} classInvalid=\"invalid\"/>\n        </div>\n      );\n    }\n  }\n\n  checkInRange(num: number) {\n    return ((num >= 0) && (num <= 1));\n  }\n\n  formatAsPercentage(num: number) {\n    return (num * 100) + \"%\";\n  }\n\n  renderCause() {\n    let state = ((this.props.state: any): SymptomState);\n    if (!state.cause) {\n      return (\n        <div>\n          Cause: <RIEInput className='editable-text' value={this.props.moduleName} propName={'cause'} change={this.props.onChange('cause')} />\n          <br/>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Cause: <RIEInput className='editable-text' value={state.cause} propName={'cause'} change={this.props.onChange('cause')} />\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderExactOrRange() {\n    let state = ((this.props.state: any): SymptomState);\n    if (state.exact) {\n      return (\n        <div className='section'>\n          Exact Quantity: <RIENumber className='editable-text' value={state.exact.quantity} propName='quantity' change={this.props.onChange('exact.quantity')} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.Range')}}); this.props.onChange('exact')({val: {id: null}})}}>Change to Range</a>\n          <br />\n        </div>\n      );\n    }\n    else {\n      return (\n        <div className='section'>\n          Range Low: <RIENumber className='editable-text' value={state.range.low} propName='low' change={this.props.onChange('range.low')} />\n          <br />\n          Range High: <RIENumber className='editable-text' value={state.range.high} propName='high' change={this.props.onChange('range.high')} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('exact')({val: {id: getTemplate('Attribute.Exact')}}); this.props.onChange('range')({val: {id: null}})}}>Change to Exact</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n}\n\nclass SupplyList extends Component<Props> {\n  render() {\n    let state = ((this.props.state: any): SupplyListState);\n    let supplyCount = (state.supplies && state.supplies.length) || 0;\n    return (\n      <div>\n        <b>Supplies</b>\n        <br />\n        {state.supplies && state.supplies.map((supply, i) => {\n          return (\n            <div className='section' key={i}>\n              Supply #{i+1} (<a className='editable-text delete-button' onClick={() => this.props.onChange(`supplies.[${i}]`)({val: {id: null}})}>remove</a>)\n              { this.renderSupply(supply, i) }\n            </div>\n          )\n        })}\n        <a className='editable-text' onClick={() => this.props.onChange(`supplies.[${supplyCount}]`)({val: {id: _.cloneDeep(getTemplate('Attribute.Supply'))}})}>+</a>\n      </div>\n    );\n  }\n\n  renderSupply(supply, i) {\n    const onChange = this.props.onChange(`supplies[${i}]`);\n    return (\n      <div>\n        Quantity: <RIENumber className='editable-text' value={supply.quantity} propName='quantity' change={onChange('quantity')} />\n        <br />\n        Code:\n        <div className='section'>\n          <Code code={supply.code} system={\"SNOMED-CT\"} onChange={onChange('code')} />\n        </div>\n      </div>\n      );\n  }\n}\n\nclass Device extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.assign_to_attribute,//'',\n      lastSubmitted : this.props.state.assign_to_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.assign_to_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): DeviceState);\n\n    return (\n      <div>\n        Code:\n        <div className='section'>\n          <Code code={state.code} system={\"SNOMED-CT\"} onChange={this.props.onChange('code')} />\n        </div>\n        { this.renderManufacturer(state) }\n        { this.renderModel(state) }\n        { this.renderAssignToAttribute(state) }\n      </div>\n      );\n  }\n\n  renderManufacturer(state) {\n    if (state.manufacturer) {\n      return (\n        <div>\n          Manufacturer: <RIEInput className='editable-text' value={state.manufacturer} propName={'manufacturer'} change={this.props.onChange('manufacturer')} /><br/>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('manufacturer')({val: {id: \"text\"}})}>Add Manufacturer</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderModel(state) {\n    if (state.model) {\n      return (\n        <div>\n          Model: <RIEInput className='editable-text' value={state.model} propName={'model'} change={this.props.onChange('model')} /><br/>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('model')({val: {id: \"text\"}})}>Add Model</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderAssignToAttribute() {\n    let state = ((this.props.state: any): DeviceState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.assign_to_attribute]!= undefined)\n        {\n          Object.keys(data[state.assign_to_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.assign_to_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.assign_to_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.assign_to_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: \"text\"}})}>Add Assign to Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Assign to Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('assign_to_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.assign_to_attribute != this.state.value)\n    {\n      this.props.onChange('assign_to_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.assign_to_attribute});\n    this.setState({lastSubmitted: this.props.state.assign_to_attribute})\n  }\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n}\n\nclass DeviceEnd extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.referenced_by_attribute,\n      lastSubmitted : this.props.state.referenced_by_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.referenced_by_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): DeviceEndState);\n    return (\n      <div>\n        {this.renderDevice()}\n        {this.renderReferencedByAttribute()}\n        {this.renderCodes()}\n      </div>\n    );\n  }\n\n  renderDevice() {\n    let state = ((this.props.state: any): DeviceEndState);\n    let deviceStates = this.props.otherStates.filter((s) => {return s.type === \"Device\"});\n    let options = deviceStates.map((e) => {return {id: e.name, text: e.name}});\n    if (options.length === 1) {\n      options.unshift({}); // blank to make sure the dropdown works when there's only one choice\n    }\n    if (!state.device) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('device')({val: {id: \"text\"}})}>Add Device State</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Device: <RIESelect className='editable-text' value={{id: state.device, text: state.device}} propName={'device'}  change={this.props.onChange('device')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('device')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReferencedByAttribute() {\n    let state = ((this.props.state: any): DeviceEndState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.referenced_by_attribute]!= undefined)\n        {\n          Object.keys(data[state.referenced_by_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.referenced_by_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.referenced_by_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: \"text\"}})}>Add Referenced by Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Referenced by Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderCodes() {\n    let state = ((this.props.state: any): DeviceEndState);\n    if (!state.codes) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Codes</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: null}})}>Remove Codes</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.referenced_by_attribute != this.state.value)\n    {\n      this.props.onChange('referenced_by_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.referenced_by_attribute});\n    this.setState({lastSubmitted: this.props.state.referenced_by_attribute})\n  }\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n}\n\nclass Death extends Component<Props> {\n  constructor (props) {\n    super(props)\n    this.handleTextChange = this.handleTextChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      value : this.props.state.referenced_by_attribute,\n      lastSubmitted : this.props.state.referenced_by_attribute,\n      displayLabel : true,\n    }\n  }\n\n  render() {\n    // check for undo/redo\n    if (this.props.state.referenced_by_attribute != this.state.value && this.state.value == this.state.lastSubmitted)\n    {\n      this.fixTextBox();\n    }\n    let state = ((this.props.state: any): DeathState);\n    return (\n      <div>\n        {this.renderExactOrRange()}\n        {this.renderCodes()}\n        {this.renderConditionOnset()}\n        {this.renderReferencedByAttribute()}\n      </div>\n    );\n  }\n\n  renderExactOrRange() {\n    let state = ((this.props.state: any): DeathState);\n    if (state.exact) {\n      return (\n        <div className='section'>\n          Exact Quantity: <RIENumber className='editable-text' value={state.exact.quantity} propName='quantity' change={this.props.onChange('exact.quantity')} />\n          <br />\n          Exact Unit: <RIESelect className='editable-text' value={{id: state.exact.unit, text: state.exact.unit}} propName=\"unit\" change={this.props.onChange('exact.unit')} options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: getTemplate('Attribute.RangeWithUnit')}}); this.props.onChange('exact')({val: {id: null}})}}>Change to Range</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: null}}); this.props.onChange('exact')({val: {id: null}})}}>Remove Exact/Range</a>\n          <br />\n        </div>\n      );\n    }\n    else if (state.range) {\n      return (\n        <div className='section'>\n          Range Low: <RIENumber className='editable-text' value={state.range.low} propName='low' change={this.props.onChange('range.low')} />\n          <br />\n          Range High: <RIENumber className='editable-text' value={state.range.high} propName='high' change={this.props.onChange('range.high')} />\n          <br />\n          Range Unit: <RIESelect className='editable-text' value={{id: state.range.unit, text: state.range.unit}} propName=\"unit\" change={this.props.onChange('range.unit')} options={unitOfTimeOptions} />\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('exact')({val: {id: getTemplate('Attribute.ExactWithUnit')}}); this.props.onChange('range')({val: {id: null}})}}>Change to Exact</a>\n          <br />\n          <a className='editable-text' onClick={() => {this.props.onChange('range')({val: {id: null}}); this.props.onChange('exact')({val: {id: null}})}}>Remove Exact/Range</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => {this.props.onChange('exact')({val: {id: getTemplate('Attribute.ExactWithUnit')}}); this.props.onChange('range')({val: {id: null}})}}>Add Exact/Range</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderCodes() {\n    let state = ((this.props.state: any): DeathState);\n    if (!state.codes) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: [getTemplate('Type.Code.Snomed')]}})}>Add Codes</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div className='section'>\n          Codes\n          <br />\n          <Codes codes={state.codes} system={\"SNOMED-CT\"} onChange={this.props.onChange('codes')} />\n          <a className='editable-text' onClick={() => this.props.onChange('codes')({val: {id: null}})}>Remove Codes</a>\n          <br />\n        </div>\n      );\n    }\n  }\n\n  renderConditionOnset() {\n    let state = ((this.props.state: any): DeathState);\n    let conditionOnset = this.props.otherStates.filter((s) => {return s.type === \"ConditionOnset\"});\n    let options = conditionOnset.map((e) => {return {id: e.name, text: e.name}});\n    if (!state.condition_onset) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('condition_onset')({val: {id: \"text\"}})}>Add Condition Onset</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Condition Onset: <RIESelect className='editable-text' value={{id: state.condition_onset, text: state.condition_onset}} propName={'condition_onset'}  change={this.props.onChange('condition_onset')} options={options} />\n          <a className='editable-text' onClick={() => this.props.onChange('condition_onset')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  renderReferencedByAttribute() {\n    let state = ((this.props.state: any): DeathState);\n    let displayAttribute;\n    if (this.state.displayLabel)\n    {\n        const data = AttributeData;\n        let others = [this.props.moduleName];\n        if (data[state.referenced_by_attribute]!= undefined)\n        {\n          Object.keys(data[state.referenced_by_attribute].read).forEach(i => {others.push(i)})\n          Object.keys(data[state.referenced_by_attribute].write).forEach(i => {others.push(i)})\n        }\n        others = others.filter((x, i, a) => a.indexOf(x) == i)\n        others.splice(others.indexOf[this.props.moduleName], 1);\n\n        if (others.length > 0)\n        {\n          displayAttribute = <span><label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n          <button className=\"attribute-button\" onClick={this.props.displayAttributes}>See other uses</button>\n          </span>\n        }\n        else{\n          displayAttribute = <label className=\"editable-text\" onClick={this.toggleLabel}>{state.referenced_by_attribute}</label>\n        }\n\n    }\n    else\n    {\n     displayAttribute = <AutoCompleteText onChange={this.handleTextChange} onBlur={this.handleSubmit} text={this.state.value} items={Attributes}/>\n    }\n    if (!state.referenced_by_attribute) {\n      return (\n        <div>\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: \"text\"}})}>Add Referenced by Attribute</a>\n          <br />\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          Referenced by Attribute: {displayAttribute}\n          <a className='editable-text' onClick={() => this.props.onChange('referenced_by_attribute')({val: {id: null}})}>(remove)</a>\n          <br/>\n        </div>\n      );\n    }\n  }\n\n  handleTextChange(value) {\n    this.setState({value: value});\n\n  }\n\n  handleSubmit(save) {\n    if (save && this.props.state.referenced_by_attribute != this.state.value)\n    {\n      this.props.onChange('referenced_by_attribute')({val: this.state.value})\n      this.setState({lastSubmitted: this.state.value})\n    }\n    else {\n      this.setState({value: this.state.lastSubmitted})\n    }\n    this.toggleLabel();\n  }\n\n  fixTextBox() {\n    this.setState({value: this.props.state.referenced_by_attribute});\n    this.setState({lastSubmitted: this.props.state.referenced_by_attribute})\n  }\n\n  toggleLabel = () =>  {\n    this.setState({displayLabel: !this.state.displayLabel});\n  }\n\n}\n\nexport default StateEditor;\n","// @flow\nimport React, { Component } from 'react';\nimport { RIEInput, RIETextArea } from 'riek';\n\nimport './ModuleProperties.css';\n\nimport type { Module } from './types/Module';\n\ntype Props = {\n  module: Module,\n  onRemarksChange: (selectedModuleIndex: number, newName: string) => mixed\n}\n\nclass ModulePropertiesEditor extends Component<Props> {\n\n  constructor(props) {\n    super(props);\n    this.onRemarksChange = this.onRemarksChange.bind(this);\n  }\n\n  onRemarksChange(remarks) {\n    this.props.onRemarksChange(remarks)\n  }\n\n  render() {\n    let remarks = \"No remarks.\" \n    if(Array.isArray(this.props.module.remarks)){ \n      remarks = this.props.module.remarks.join(\"\\n\");\n    }\n\n    // NOTE: WHAT IF REMARKS SET TO BLANK?\n\n    return (\n      <div className='ModuleProperties'>\n        <div className='Editor-panel-title'> \n           Module Remarks\n        </div>\n        <div className='ModuleProperties-remarks'>\n          <RIETextArea value={remarks} propName=\"remarks\" change={(newval) => this.onRemarksChange(newval.remarks)} />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default ModulePropertiesEditor;\n","// @flow\nimport type { Module } from './types/Module';\nimport type { State } from './types/State';\n\nimport { cleanString } from '../utils/stringUtils';\n\nconst STANDARD_COLOR = 'Black';\n/*\nconst HIGHLIGHT_COLOR = '#007bff';\nconst MUTED_COLOR = '#CCCCCC'\n*/\n\nexport function generateDOT(module: Module, selectedState: State, selectedStateTransition: Number) {\n\n  let relatedStates = {};\n\n  if(selectedState) {\n    Object.keys(module.states).forEach( key => {\n      let state = module.states[key];\n\n      let allTransitions = findTransitions(module.states[key])\n\n      if(allTransitions[selectedState.name]){\n        relatedStates[state.name] = true;\n      }\n\n    });\n\n    relatedStates = Object.assign({}, relatedStates, findTransitions(module.states[selectedState.name]))\n\n  }\n\n  let output =  ['digraph G {',\n          nodesAsDOT(module, selectedState, relatedStates),\n          transitionsAsDOT(module, selectedState, selectedStateTransition),\n         '}'\n         ].join('\\n');\n\n  return output;\n\n}\n\nconst nodesAsDOT = (module: Module, selectedState: State, relatedStates: mixed) => {\n\n  return Object.keys(module.states).filter(name => typeof module.states[name] === 'object').map( name => {\n\n    let state = module.states[name]\n    state['name'] = name\n\n    let node = {\n      id: 'node_' + escapeId(name),\n      shape: 'record',\n      style: 'rounded,filled',\n      fillcolor: 'White',\n      fontcolor: STANDARD_COLOR\n    }\n\n    if(state['type'] === 'Initial' || state['type'] === 'Terminal'){\n        node['fillcolor'] = 'Grey'\n        node['style'] = 'rounded,filled'\n        node['fontcolor'] = 'White'\n    }\n\n    if(selectedState && state.name === selectedState.name){\n      node['fillcolor'] = 'White'\n      node['class'] = 'node-highlighted'\n    } else if (selectedState && !relatedStates[state.name]){\n      node['class'] = 'node-muted'\n    }\n\n    let details = stateDescription(state)\n    if(details.length === 0){\n      node['label'] = (name === state['type']) ? state['name'] : `{ ${name} | ${state['type']} }`\n    } else {\n      node['label'] = `{ ${name} | { ${state['type']} | ${details} } }`\n    }\n\n    node['label'] = escapeLabel(node['label']);\n\n    let params = Object.keys(node).map((key) => `${key} = \"${node[key]}\"`).join(\", \");\n\n    return `\"${escapeName(name)}\" [${params};]`\n\n  }).join(\"\\n\");\n\n}\n\nconst transitionsAsDOT = (module: Module, selectedState: State, selectedStateTransition: Number) => {\n\n  return Object.keys(module.states).map( name => {\n\n    let state = module.states[name]\n    let escapedName = escapeName(name);\n\n    let className='';\n\n    if(!!selectedState){\n      className = 'transition-muted'\n    }\n\n    if(selectedState && selectedState.name === name){\n      className='transition-highlighted'\n    }\n\n    if(state.direct_transition !== undefined){\n      if(selectedState && state.direct_transition === selectedState.name && selectedState.name !== name){\n        className='';\n      }\n\n      if(selectedStateTransition === 0 ){\n        className += ' transition-selected';\n      }\n\n      if(module.states[state.direct_transition]){\n        return `  \"${escapedName}\" -> \"${escapeName(module.states[state.direct_transition].name)}\" [class = \"transition transition-index_0 ${className}\"];\\n`\n      } else {\n        console.log(`NO SUCH NODE TO TRANSITION TO: ${state.direct_transition} FROM ${name}`);\n      }\n    } else if(state.distributed_transition !== undefined){\n      let out_transitions = ''\n      state.distributed_transition.forEach( (t, i) => {\n        let transitionClassName = className\n        let distLabel = ''\n        if(typeof t.distribution === 'object'){\n          distLabel = `p(${t.distribution.attribute})`\n          if(t.distribution.default){\n            let pct = t.distribution.default * 100\n            distLabel += `, default ${pct}%`\n          }\n        } else {\n          let pct = t.distribution * 100\n          distLabel = `${pct}%`\n        }\n        if(module.states[t.transition]){\n          if(selectedState && t.transition === selectedState.name && selectedState.name !== name){\n            transitionClassName = '';\n          }\n\n          if(selectedStateTransition === i){\n            transitionClassName += ' transition-selected';\n          }\n          out_transitions += `  \"${escapedName}\" -> \"${escapeName(module.states[t.transition].name)}\" [label = \"${distLabel}\", class = \"transition transition-index_${i} ${transitionClassName}\"];\\n`\n        } else {\n          console.log(`NO SUCH NODE TO TRANSITION TO: ${t.transition} FROM ${name}`);\n        }\n      })\n      return out_transitions\n    } else if(state.lookup_table_transition !== undefined){\n        let out_transitions = ''\n        state.lookup_table_transition.transitions.forEach( (t, i) => {\n        let transitionClassName = className\n        let pct = t.default_probability * 100\n        let distLabel = `${pct}%`\n        if(module.states[t.transition]){\n          if(selectedState && t.transition === selectedState.name && selectedState.name !== name){\n            transitionClassName = '';\n          }\n\n          if(selectedStateTransition === i){\n            transitionClassName += ' transition-selected';\n          }\n          out_transitions += `  \"${escapedName}\" -> \"${escapeName(module.states[t.transition].name)}\" [label = \"See Table (def: ${distLabel})\", class = \"transition transition-index_${i} ${transitionClassName}\"];\\n`\n          } else {\n          console.log(`NO SUCH NODE TO TRANSITION TO: ${t.transition} FROM ${name}`);\n        }\n      })\n      return out_transitions\n    } else if (state.conditional_transition !== undefined){\n      let out_transitions = ''\n      state.conditional_transition.forEach( (t, i ) => {\n        let transitionClassName = className\n        let cnd = t.condition !== undefined ? logicDetails(t.condition) : 'else';\n        if(module.states[t.transition]){\n          if(selectedState && t.transition === selectedState.name){\n            transitionClassName = ''\n          }\n          if(selectedStateTransition === i){\n            transitionClassName += ' transition-selected';\n          }\n          out_transitions += `  \"${escapedName}\" -> \"${escapeName(module.states[t.transition].name)}\" [label = \"${i+1}. ${cnd}\", class = \"transition transition-index_${i} ${transitionClassName}\"];\\n`\n        } else {\n          console.log(`NO SUCH NODE TO TRANSITION TO: ${t.transition} FROM ${name}\\n`);\n        }\n      })\n     return out_transitions\n\n    } else if (state.complex_transition !== undefined){\n      let transitions = {}\n      let nodeHighlighted = {}\n      state.complex_transition.forEach( (t, i) => {\n        let cnd = t.condition !== undefined ? logicDetails(t['condition']) : 'else'\n        if(t.transition !== undefined){\n          if(module.states[t.transition]){\n            let nodes = `  \"${escapedName}\" -> \"${t.transition}\"`\n            if(selectedState && t.transition === selectedState.name){\n              nodeHighlighted[nodes] = 'standard'\n            }\n            if(selectedState && name === selectedState.name){\n              nodeHighlighted[nodes] = 'highlighted'\n            }\n            if(transitions[nodes] === undefined){\n              transitions[nodes] = [];\n            }\n            transitions[nodes].push(cnd)\n          } else {\n            console.log(`NO SUCH NODE TO TRANSITION TO: ${t.transition} FROM ${name}`);\n          }\n        } else {\n          t.distributions.forEach( dist => {\n            if(module.states[dist.transition]){\n              let pct = dist.distribution * 100\n              let nodes = `  \"${escapedName}\" -> \"${dist.transition}\"`\n              if(selectedState && dist.transition === selectedState.name){\n                nodeHighlighted[nodes] = 'standard'\n              }\n              if(selectedState && name === selectedState.name){\n                nodeHighlighted[nodes] = 'highlighted'\n              }\n              if(transitions[nodes] === undefined){\n                transitions[nodes] = [];\n              }\n              transitions[nodes].push(`${cnd}: ${pct}%`)\n            } else {\n              console.log(`NO SUCH NODE TO TRANSITION TO: ${dist.transition} FROM ${name}`);\n            }\n          })\n        }\n      })\n\n      let out_transitions = ''\n      Object.keys(transitions).forEach( (trans, index) => {\n        let transitionClassName = className\n        if(nodeHighlighted[trans] === 'standard'){\n          transitionClassName = ''\n        } else if(nodeHighlighted[trans] === 'highlighted'){\n          transitionClassName='transition-highlighted'\n        }\n        if(selectedStateTransition === index){\n          transitionClassName += ' transition-selected';\n        }\n        out_transitions += `${trans} [label = \"${transitions[trans].join(',\\\\n')}\", class = \"transition transition-index_${index} ${transitionClassName}\"]\\n`\n      })\n\n      return out_transitions;\n\n    }\n\n    return ''\n\n  }).join('')\n\n}\n\nconst distributionString = (distro) => {\n  switch(distro['kind']) {\n    case 'EXACT':\n      return distro['parameters']['value'];\n    case 'UNIFORM':\n      return `${distro['parameters']['low']} - ${distro['parameters']['high']}`;\n    case 'GAUSSIAN':\n      return `Mean: ${distro['parameters']['mean']}, SD: ${distro['parameters']['standardDeviation']}`\n  }\n  return '';\n}\n\nconst stateDescription = (state) =>{\n\n  let details = ''\n\n  switch(state['type']){\n    case 'Initial':\n    case 'Terminal':\n      details = ''\n      break;\n    case 'Guard':\n      details = \"Allow if \" + logicDetails(state['allow'])\n      break;\n\n    case 'Delay':\n    case 'Death':\n      if(state['range'] !== undefined){\n        let r = state['range']\n        details = `${r['low']} - ${r['high']} ${r['unit']}`\n      } else if (state['exact'] !== undefined) {\n        let e = state['exact']\n        details = `${e['quantity']} ${e['unit']}`\n      } else if (state['distribution'] !== undefined && state['unit'] !== undefined) {\n        details = `${distributionString(state['distribution'])} ${state['unit']}`\n      }\n      break;\n    case 'Encounter':\n      if(state['wellness']){\n        details = 'Wait for regularly scheduled wellness encounter\\\\n'\n      }\n      break;\n    case 'EncounterEnd':\n      details = 'End the current encounter'\n      if(state['discharge_disposition']){\n       let code = state['discharge_disposition']\n       details += `\\\\lDischarge Disposition: [${code['code']}] ${code['display']}`\n      }\n      break;\n    case 'SetAttribute':\n      if (state.range) {\n        const r = state.range;\n        details = `Set '${state[\"attribute\"]}': ${r['low']} - ${r['high']}`;\n      } else if (state['value']) {\n        let v = state['value']\n        details = `Set '${state[\"attribute\"]}' = ${(v === undefined || v === null || v === \"\") ? 'nil' : v}`\n      } else if (state.value_code !== undefined) {\n        let v = state['value_code']\n        details = `Set '${state[\"attribute\"]}' = ${v['system']}[${v['code']}]: ${v['display']}\\\\l`\n      } else if (state['distribution'] !== undefined ) {\n        details = `Set '${state[\"attribute\"]}': ${distributionString(state['distribution'])}}`\n      }\n      break;\n\n    case 'Symptom':\n     let s = state['symptom']\n     let p = state['probability']\n      if(state.range !== undefined){\n        let r = state['range']\n        details = `${s}: ${r['low']} - ${r['high']}`\n      } else if (state.exact !== undefined) {\n        let e = state['exact']\n        details = `${s}: ${e['quantity']}`\n      } else if (state['distribution'] !== undefined ) {\n        details = `${s}: ${distributionString(state['distribution'])}}`\n      }\n      if (p && p < 1.0 && p > 0) {\n        let pct = p*100;\n        details += ` (${pct}%)`\n      }\n      break;\n\n    case 'Observation':\n      let unit = state['unit']\n      if(unit){\n        unit = \"in \" + unit.replace('{','(').replace('}',')')\n      }\n\n      if(state.vital_sign !== undefined) {\n        details = `Record value from Vital Sign '${state[\"vital_sign\"]}' ${unit}\\\\l`\n      } else if (state.attribute !== undefined) {\n        details = `Record value from Attribute '${state[\"attribute\"]}' ${unit}\\\\l`\n      } else if(state.range !== undefined){\n        let r = state['range']\n        details = `Record value between: ${r['low']} - ${r['high']} ${unit}\\\\l`\n      } else if (state.exact !== undefined) {\n        let e = state['exact']\n        details = `Record value ${e['quantity']} ${unit}\\\\l`\n      } else if (state.value_code !== undefined) {\n        let v = state['value_code']\n        details = `Record value ${v['system']}[${v['code']}]: ${v['display']}\\\\l`\n      } else if (state['distribution'] !== undefined && state['unit'] !== undefined) {\n        details = `Record value ${distributionString(state['distribution'])} ${state['unit']}`\n      }\n      break;\n\n    case 'Procedure':\n      if (state['distribution'] !== undefined && state['unit'] !== undefined) {\n        details = `Duration: ${distributionString(state['distribution'])} ${state['unit']}\\\\l`\n      }\n      break;\n\n    case 'ImagingStudy':\n      let series = state['series'];\n      if (series.length > 0) {\n        let primarySeries = series[0];\n        let primaryModality = primarySeries['modality'];\n        let primaryBodySite = primarySeries['body_site'];\n\n        details = `DICOM-DCM[${primaryModality['code']}]: ${primaryModality['display']}\\\\l`\n        details += `SNOMED-CT[${primaryBodySite['code']}]: Body Site: ${primaryBodySite['display']}\\\\l`\n      }\n      break;\n\n    case 'Counter':\n      details = `${state['action']} value of attribute '${state[\"attribute\"]}' by ${state['amount'] || 1}`\n      break;\n    case 'VitalSign':\n      let vs = state['vital_sign']\n      let unitv = state['unit']\n      if(state.range !== undefined){\n        let r = state['range']\n        details = `Set ${vs}: ${r['low']} - ${r['high']} ${unitv}`\n      } else if (state.exact !== undefined) {\n        let e = state['exact']\n        details = `Set ${vs}: ${e['quantity']} ${unitv}`\n      } else if (state['distribution'] !== undefined ) {\n        details = `Set ${vs}: ${distributionString(state['distribution'])} ${unitv}`\n      }\n      break;\n    case 'CallSubmodule':\n      details = `Call submodule '${state['submodule']}'`\n      break;\n    case 'MultiObservation':\n    case 'DiagnosticReport':\n      if(state.observations && state.observations.length > 0){\n        let diagType = ['Type']\n        let diagValue = ['Value']\n        let diagUnits = ['Unit'];\n        state.observations.forEach( (s,i) => {\n          let unit = s['unit']\n          if(unit){\n            unit = unit.replace('{','(').replace('}',')')\n          }\n          diagType.push(s.codes.map(c => c.display).join('\\\\l'))\n          diagUnits.push(unit)\n\n          if(s.vital_sign !== undefined) {\n            diagValue.push(`Vital Sign: '${s[\"vital_sign\"]}'`)\n          } else if (s.attribute !== undefined) {\n            diagValue.push(`Attribute: '${s[\"attribute\"]}'`)\n          } else if(s.range !== undefined){\n            let r = s['range']\n            diagValue.push(`${r['low']} - ${r['high']}`)\n          } else if (s.exact !== undefined) {\n            let e = s['exact']\n            diagValue.push(`${e['quantity']}`);\n          } else if (s.value_code !== undefined) {\n            let v = s['value_code']\n            diagValue.push(`${v['system']}[${v['code']}]: ${v['display']}`);\n          }\n        });\n        details += `{${diagType.map(t => t).join('|')}}|`;\n        details += `{${diagValue.map(t => t).join('|')}}|`;\n        details += `{${diagUnits.map(t => t).join('|')}}|`;\n      } else {\n        details = `No Observations\\\\l`;\n      }\n\n      break;\n\n    case 'Device':\n      const c = state.code;\n      details = `${c['system']}[${c['code']}]: ${c['display']}\\\\l`;\n\n      if (state.manufacturer) {\n        details += `Manufacturer: ${state.manufacturer}\\\\l`;\n      }\n      if (state.model) {\n        details += `Model: ${state.model}\\\\l`;\n      }\n      break;\n\n    case 'DeviceEnd':\n      if (state.device) {\n        details = `Added at: ${state.device}\\\\l`;\n      }\n      break;\n\n    case 'SupplyList':\n      if(state.supplies && state.supplies.length > 0){\n        let supplyQuantity = ['Quantity']\n        let supplyCode = ['Code'];\n        state.supplies.forEach( (s,i) => {\n          supplyQuantity.push(s.quantity);\n          const c = s.code;\n          supplyCode.push(`${c['system']}[${c['code']}]: ${c['display']}`);\n        });\n\n        details += `{${supplyCode.map(t => t).join('|')}}|`;\n        details += `{${supplyQuantity.map(t => t).join('|')}}|`;\n      } else {\n        details = `No Supplies\\\\l`;\n      }\n      break;\n\n    default:\n      break;\n\n  }\n\n  if(state.codes !== undefined){\n    state['codes'].forEach( code => {\n      if(code['value_set'] === undefined){\n        code['value_set'] = \"\";\n      }\n\n      let system_val = escapeVerticalBar(code['system']);\n      let code_val = escapeVerticalBar(code['code']);\n      let display_val = escapeVerticalBar(code['display']);\n      let valuSet_val = escapeVerticalBar(code['value_set']);\n\n      details = details + system_val + \"[\" + code_val + \"]: \" + display_val  + \"\\\\l\";\n      if (valuSet_val) {\n      \tdetails += \"Value Set:\" + \"[\" + valuSet_val +\"] \" + \"\\\\l\";\n      }\n    })\n  }\n\n  if(state.target_encounter !== undefined){\n   let verb = 'Perform'\n\n    switch(state['type']){\n      case 'ConditionOnset':\n      case 'AllergyOnset':\n        verb = 'Diagnose'\n        break;\n      case 'MedicationOrder':\n        verb = 'Prescribe'\n        break;\n      default:\n        break;\n    }\n\n    details = details + verb + \" at \" + state['target_encounter'] + \"\\\\l\"\n  }\n\n  if(state.reason){\n    details = details + `Reason: ${state['reason']}\\\\l`\n  }\n  if(state.medication_order){\n    details = details + `Prescribed at: ${state['medication_order']}\\\\l`\n  }\n  if(state.condition_onset){\n    details = details + `Onset at: ${state['condition_onset']}\\\\l`\n  }\n  if(state.allergy_onset){\n    details = details + `Onset at: ${state['allergy_onset']}\\\\l`\n  }\n  if(state.careplan){\n    details = details + `Prescribed at: ${state['careplan']}\\\\l`\n  }\n  if(state.assign_to_attribute){\n    details = details + `Assign to Attribute: '${state['assign_to_attribute']}'\\\\l`\n  }\n  if(state.administration){\n    details = details + `Medication is administered\\\\l`\n  }\n  if(state.referenced_by_attribute){\n    details = details + `Referenced By Attribute: '${state['referenced_by_attribute']}'\\\\l`\n  }\n  if(state.activities){\n    details = details + \"\\\\lActivities:\\\\l\"\n    state['activities'].forEach( activity => {\n      details = details + activity['system'] + \"[\" + activity['code'] + \"]: \" + activity['display'] + \"\\\\l\"\n    })\n  }\n  if(state.goals){\n    details = details + \"\\\\lGoals:\\\\l\"\n    state['goals'].forEach( goal => {\n      if(goal['text']){\n        details = details + goal['text'] + \"\\\\l\"\n      } else if(goal['codes']) {\n        let code = goal['codes'][0]\n        details = details + code['system'] + \"[\" + code['code'] + \"]: \" + code['display'] + \"\\\\l\"\n      } else if(goal['observation']) {\n        let logic = goal['observation']\n        let obs = findReferencedType(logic)\n        details = details + `Observation ${obs} \\\\${logic['operator']}${leaveUndefinedBlank(logic['value'])}\\\\l`\n      }\n    })\n  }\n  if(state.duration){\n    let d = state['duration']\n    details = `${details}\\\\lDuration: ${d['low']} - ${d['high']} ${d['unit']}\\\\l`\n  }\n  if(state.category){\n    details = `${details}Category: ${state['category']}\\\\l`\n  }\n  if(state.allergy_type && state.allergy_type.length > 0) {\n      details += `Type: ${state.allergy_type}\\\\l`\n  }\n  if(state.reactions && state.reactions.length > 0) {\n    state.reactions.forEach(r => {\n      details += `Reaction: ${r.reaction['system']}[${r.reaction['code']}]: ${r.reaction['display']}\\\\l`\n    });\n  }\n\n  return details;\n}\n\nconst logicDetails = logic => {\n\n  switch(logic['condition_type']){\n    case 'And':\n    case 'Or':\n      let subsWhen =logic['conditions'].map( c => {\n        if(c['condition_type'] === 'and' || c['condition_type'] === 'or'){\n          return \"(\\\\l\" + logicDetails(c) + \")\\\\l\"\n        } else {\n          return logicDetails(c)\n        }\n      })\n      return subsWhen.join(logic['condition_type'].toLowerCase() + ' ')\n    case 'At Least':\n    case 'At Most':\n      let threshold = logic['minimum'] || logic['maximum']\n      let subsOr = logic['conditions'].map( c => {\n        if(c['condition_type'] === 'and' || c['condition_type'] === 'or'){\n          return \"(\\\\l\" + logicDetails(c) + \")\\\\l\"\n        } else {\n          return logicDetails(c)\n        }\n      });\n      return `${logic['condition_type']} ${threshold} of:\\\\l- ${subsOr.join('- ')}`\n    case 'Not':\n      let condition = logicDetails(logic['condition'])\n      return `not ${condition}`\n    case 'Gender':\n      return `gender is '${logic['gender']}'\\\\l`\n    case 'Age':\n      return `age \\\\${logic['operator']} ${logic['quantity']} ${logic['unit']}\\\\l`\n    case 'Socioeconomic Status':\n      return `${logic['category']} Socioeconomic Status\\\\l`\n    case 'Race':\n      return `race is '${logic['race']}'\\\\l`\n    case 'Date':\n      if (logic.year !== undefined) {\n        return `Year is \\\\${logic['operator']} ${logic['year']}\\\\l`\n      } else if (logic.month !== undefined) {\n        return `Month is \\\\${logic['operator']} ${logic['month']}\\\\l`\n      } else if (logic.date !== undefined) {\n        let d = logic['date']\n        return `Date is \\\\${logic['operator']} ${d['year']}-${d['month']}-${d['day']} ${d['hour']}:${d['minute']}:${d['second']}.${d['millisecond']}\\\\l`\n      }\n    case 'Symptom':\n      return `Symptom: '${logic['symptom']}' \\\\${logic['operator']} ${logic['value']}\\\\l`\n    case 'PriorState':\n      let prior_description = `state '${logic['name']}' has been processed`\n      if(logic.since !== undefined){\n        prior_description = `${prior_description} since ${logic.since}`\n      }\n      if(logic.within !== undefined){\n        prior_description = `${prior_description} within ${logic.within['quantity']} ${logic.within['unit']}`\n      }\n      return `${prior_description} \\\\l`\n    case 'Attribute':\n      return `Attribute: '${logic['attribute']}' \\\\${logic['operator']}${leaveUndefinedBlank(logic['value'])}\\\\l`\n    case 'Observation':\n      let obs = findReferencedType(logic)\n      if (logic.operator !== 'is nil' && logic.operator !== 'is not nil' && logic.operator.id !== 'is nil' && logic.operator.id !== 'is not nil'){\n        if(logic.value !== undefined){\n          return `Observation ${obs} \\\\${logic['operator']}${leaveUndefinedBlank(logic['value'])}\\\\l`\n        } else if (logic.value_code !== undefined) {\n          return `Observation ${obs} \\\\${logic['operator']} ${logic.value_code['system']}[${logic.value_code['code']}]: ${logic.value_code['display']}\\\\l`\n        }\n      } else {\n        return `Observation ${obs} \\\\${logic['operator']}\\\\l`\n      }\n\n    case 'Vital Sign':\n      return `Vital Sign ${logic['vital_sign']} \\\\${logic['operator']} ${logic['value']}\\\\l`\n    case 'Active Condition':\n      let cond = findReferencedType(logic)\n      return `Condition ${cond} is active\\\\l`\n    case 'Active CarePlan':\n      let plan = findReferencedType(logic)\n      return `CarePlan ${plan} is active\\\\l`\n    case 'Active Medication':\n      let med = findReferencedType(logic)\n      return `Medication ${med} is active\\\\l`\n    case 'Active Allergy':\n      let alg = findReferencedType(logic)\n      return `Allergy ${alg} is active\\\\l`\n    case 'True':\n    case 'False':\n      return logic['condition_type']\n    default:\n      return `Unknown Condition: ${logic['condition_type']}`\n\n  }\n}\n\nconst findReferencedType = (logic) => {\n  if(logic['codes']){\n    let code = logic['codes'][0]\n    return `'${code['system']} [${code['code']}]: ${code['display']}'`\n  } else if (logic['referenced_by_attribute']) {\n    return `Referenced By Attribute: '${logic['referenced_by_attribute']}'`\n  }\n  return `Error with referenced types: ${logic['condition_type']} condition must be specified by code or attribute`\n}\n\nconst findTransitions = (obj, ret) => {\n\n  if(!ret) ret = {};\n  if (!obj) return ret;\n  if (obj instanceof Array) {\n    for (let i in obj) {\n        ret = Object.assign({}, ret, findTransitions(obj[i], {}))\n    }\n    return ret;\n  }\n\n  if (obj['direct_transition']) ret[obj['direct_transition']] = true\n  if (obj['transition']) ret[obj['transition']] = true;\n\n  if ((typeof obj === \"object\") && (obj !== null) ){\n    let children = Object.keys(obj);\n    if (children.length > 0){\n      for (let i = 0; i < children.length; i++ ){\n        ret = Object.assign({}, ret,findTransitions(obj[children[i]], {}));\n      }\n    }\n  }\n  return ret;\n}\n\nconst leaveUndefinedBlank = (value) => {\n  if(value === undefined){\n    return '';\n  } else {\n    return ' ' + value;\n  }\n}\n\nconst escapeId = (name) => {\n  return cleanString(name, {'?': '', '\"': \"\"});\n};\n\nconst escapeName = (name) => {\n  return  cleanString(name, {'\"': '\\\\'});\n};\n\nconst escapeLabel = (label) => {\n\n  // note: order matters; in practice order is retained in browsers but we may want to make an array\n  const mapObj = {\n        \"&\" : \"&amp;\",\n        \"<\" : \"&lt;\",\n        \">\" : \"&gt;\",\n        '\"' : '\\\\\"',\n        };\n\n  return cleanString(label, mapObj);\n\n}\n\nconst escapeVerticalBar = (inputStr) => {\n  inputStr = inputStr.toString();\n  return inputStr.replace(/\\|/g, \"\\\\|\")\n};\n\nexport const svgDefs = `<defs>\n\n  <filter id=\"outershadow\" height=\"200%\" width=\"200%\" x=\"-75%\" y=\"-75%\" color-interpolation-filters=\"sRGB\">\n    <feMorphology operator=\"dilate\" radius=\"3\" in=\"SourceAlpha\" result=\"thicken\" />\n    <feGaussianBlur in=\"thicken\" stdDeviation=\"4\" result=\"blurred\" />\n    <feFlood flood-color=\"#336699\" result=\"glowColor\" />\n    <feComposite in=\"glowColor\" in2=\"blurred\" operator=\"in\" result=\"glowComposite\" />\n    <feMerge>\n      <feMergeNode in=\"glowComposite\"/>\n      <feMergeNode in=\"SourceGraphic\"/>\n    </feMerge>\n  </filter>\n</defs>`;\n\n","// @flow\nimport React, { Component } from 'react';\n\nimport svgPanZoom from  'svg-pan-zoom';\n\nimport Viz from 'viz.js';\nimport {generateDOT,svgDefs} from '../../utils/graphviz';\n\nimport './ModuleGraph.css';\n\nimport type { Module } from './types/Module';\nimport type { State } from './types/State';\n\ntype Props = {\n  module: Module,\n  onClick: (id:string) => mixed,\n  selectedState: State\n}\n\nclass ModuleGraph extends Component<Props> {\n\n  constructor(props) {\n    super(props);\n    this.onPanZoom = this.onPanZoom.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.bold = false;\n    this.lastDOT = '';\n  }\n\n  componentDidMount(){\n    this.writeSVG(this.props.module)\n    this.mount.addEventListener('mouseup', this.onMouseUp);\n    this.mount.addEventListener('mousedown', this.onMouseDown);\n  }\n\n  componentWillReceiveProps(nextProps: Props){\n\n    if(nextProps.module.name !== this.props.module.name){\n      this.panZoomSettings = null\n    }\n\n    this.writeSVG(nextProps.module, nextProps.selectedState, nextProps.selectedStateTransition);\n\n    if(nextProps.fullscreen !== this.props.fullscreen){\n      if(nextProps.fullscreen){\n        this.svgPanZoom.panBy({x: 250, y: 0});\n        this.customPanBy({x: -100, y: 0})\n      }else{\n        this.svgPanZoom.panBy({x: -250, y: 0});\n        this.customPanBy({x: 100, y: 0})\n      }\n    }\n\n    if(this.panZoomSettings){\n      this.blockPanZoomEvent = true\n      this.svgPanZoom.zoom(this.panZoomSettings.zoom, true);\n      this.svgPanZoom.pan(this.panZoomSettings.pan, true);\n      this.blockPanZoomEvent = false\n    }\n\n  }\n\n  customPanBy(amount) { // {x: 1, y: 2}\n    var animationTime = 300 // ms\n      , animationStepTime = 15 // one frame per 30 ms\n      , animationSteps = animationTime / animationStepTime\n      , animationStep = 0\n      , intervalID = null\n      , stepX = amount.x / animationSteps\n      , stepY = amount.y / animationSteps\n\n    intervalID = setInterval(() => {\n      if (animationStep++ < animationSteps) {\n        if(this.svgPanZoom){\n        this.svgPanZoom.panBy({x: stepX, y: stepY})\n        }\n      } else {\n        // Cancel interval\n        clearInterval(intervalID)\n      }\n    }, animationStepTime)\n  }\n\n\n  render() {\n    return (\n        <div ref={mount => this.mount = mount } className={'Module ' + (this.props.fullscreen ? \"Module-fullscreen\" : 'Module-standard-screen')}>\n         <svg width=\"50000px\" height=\"50000px\" xmlns=\"http://www.w3.org/2000/svg\" style={{opacity: .3}}>\n           <defs>\n            <pattern id=\"smallGrid\" width=\"10\" height=\"10\" patternUnits=\"userSpaceOnUse\">\n              <path d=\"M 10 0 L 0 0 0 10\" fill=\"none\" stroke=\"#95b4cf\" strokeWidth=\"0.5\"/>\n            </pattern>\n            <pattern id=\"grid\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\">\n              <rect width=\"100\" height=\"100\" fill=\"url(#smallGrid)\"/>\n              <path d=\"M 100 0 L 0 0 0 100\" fill=\"none\" stroke=\"#95b4cf\" strokeWidth=\"1\"/>\n            </pattern>\n          </defs>\n          <g>\n            <rect width=\"100%\" height=\"100%\" style={{\"transform\": \"translate(-50%, -50%)\"}} fill=\"url(#grid)\" />\n          </g>\n        </svg>\n        <div style={{\"position\":\"absolute\", \"top\": 0, \"left\": 0, \"width\": \"100%\", \"height\": '100%'}} className=\"Module-graph\">\n        </div>\n      </div>\n    )\n  }\n  onMouseUp(e) {\n    if(this.fireClickOnMouseUp){\n      this.props.onClick();\n    }\n  }\n  onMouseDown() {\n    this.fireClickOnMouseUp = true;\n  }\n\n  onPanZoom() {\n    if(this.blockPanZoomEvent) return;\n\n    this.fireClickOnMouseUp = false;\n    this.panZoomSettings = {pan: this.svgPanZoom.getPan(), zoom: this.svgPanZoom.getZoom()};\n\n    this.mount.children[0].children[1].setAttribute('transform', this.mount.children[1].children[0].children[1].attributes['transform'].value)\n\n    let linesShouldBold = Math.max(this.originalWidth, this.originalHeight) / this.svgPanZoom.getZoom() > 1500\n\n    if(linesShouldBold && !this.bold){\n      this.bold = true\n      this.mount.children[1].className = 'Module bold-lines'\n    } else if(!linesShouldBold && this.bold){\n      this.bold = false\n      this.mount.children[1].className = 'Module'\n    }\n\n  }\n\n  writeSVG(module: Module, selectedState: State, selectedStateTransition: Number){\n\n    const dot = generateDOT(module, selectedState, (selectedStateTransition: Number));\n    if(dot === this.lastDOT){\n      return;\n    }\n\n    this.lastDOT = dot;\n\n    /* write SVG */\n    try {\n      this.mount.children[1].innerHTML= Viz(dot).replace('</svg>', svgDefs + '</svg>');\n    } catch (ex) {\n      alert('Invalid module: ' + ex.message)\n      this.mount.children[1].innerHTML = `<svg width=\"10px\" height=\"10px\"/>`;\n    }\n\n    let svg = this.mount.children[1].children[0]\n\n    /* Add event handlers for states */\n    Object.keys(module.states).forEach( s => {\n      let el = document.getElementById(`node_${s.replace('?','')}`);     \n\n      if(el){\n        // force rerender because of a pan bug\n        el.addEventListener('mouseup', (e) => {this.lastDOT = null;e.stopPropagation(); this.props.onClick(s)});\n\n        if(selectedState && s === selectedState.name){\n          // assume path is at index 1 to speed things up.  bad assumption?\n          el.children[1].setAttribute('filter', 'url(#outershadow)')\n        } else {\n          el.children[1].removeAttribute('filter')\n        }\n      }\n\n    })\n\n    // Removes the title elmeent generated by graph viz that causes a \"G\" to always show on mouse hover\n    const unnecessaryGTitle = document.querySelector('svg > g > title');\n    if(unnecessaryGTitle){\n      unnecessaryGTitle.remove();\n    }\n\n    const unnecessaryFill = document.querySelector('svg > g > polygon');\n    if(unnecessaryFill){\n      unnecessaryFill.remove();\n    }\n\n    /* Add event handlers for transitions, and increase their 'hit box' size */\n    document.querySelectorAll('.edge.transition').forEach( group => {\n      let originator = group.querySelector('title').innerHTML.split('-&gt;')[0]\n      let hitLine = group.querySelector('path').cloneNode(true)\n      let transitionIndex = null;\n      let transitionIndexClass = group.className.baseVal.split(' ').find(t => t.startsWith('transition-index'));\n      if(transitionIndexClass){\n        try{\n          transitionIndex = parseInt(transitionIndexClass.split('_')[1])\n        } catch(e){\n          // just ignore if not a number\n        }\n\n      }\n      hitLine.setAttribute('class', 'transition-hitbox');\n      hitLine.setAttribute('stroke-width', 20)\n      hitLine.setAttribute('opacity', 0)\n      group.appendChild(hitLine)\n\n      group.querySelectorAll('path,text').forEach( path => {\n        // force rerender because of a pan bug\n        path.addEventListener('mouseup', (e) => {this.lastDOT = null;e.stopPropagation(); this.props.onClick(originator, transitionIndex)});\n      })\n    })\n\n    /* Bump the transition labels to the right because it is too crowded */\n    document.querySelectorAll('svg .edge text').forEach(t => t.setAttribute('x', parseFloat(t.getAttribute('x'))+5))\n\n    /* add pan/zoom if available */\n    if(typeof svgPanZoom === \"function\"){\n\n      this.originalWidth = svg.attributes.width.value.match(/\\d+/g).map(Number)[0];\n      this.originalHeight = svg.attributes.height.value.match(/\\d+/g).map(Number)[0];\n\n      let offsetLeft = this.mount.children[1].getBoundingClientRect().x\n      let offsetTop = this.mount.children[1].getBoundingClientRect().y\n      let visibleWidth = this.mount.children[1].getBoundingClientRect().width - offsetLeft;\n      let visibleHeight = this.mount.children[1].getBoundingClientRect().height - offsetTop;\n\n      this.mount.children[1].children[0].setAttribute('width', '100%')\n      this.mount.children[1].children[0].setAttribute('height', '100%')\n\n      let zoomFactor = 1\n\n      if(this.originalWidth / this.originalHeight > visibleWidth / visibleHeight){\n        //width constrained\n        zoomFactor = visibleWidth / this.originalWidth;\n      } else {\n        //height constrained\n        zoomFactor = visibleHeight / this.originalHeight;\n      }\n\n      this.svgPanZoom = svgPanZoom(this.mount.children[1].children[0],{\n          controlIconsEnabled: false, // BUGGY BECAUSE OF EVENT HANDLERS \n          minZoom: .1,\n          onPan: this.onPanZoom,\n          onZoom: this.onPanZoom,\n        });\n\n      let panZoomControlsElement = document.getElementById('svg-pan-zoom-controls');\n\n      if(panZoomControlsElement){\n        /* DISABLED BECAUSE BUGGY WITH OTHER EVENT HANDLERS */\n        panZoomControlsElement.setAttribute(\"transform\", `translate(${visibleWidth-100} ${visibleHeight-150}) scale(.75)`)\n        document.getElementById('svg-pan-zoom-zoom-in').addEventListener('mouseup', (e) => {this.svgPanZoom.zoomIn()});\n        document.getElementById('svg-pan-zoom-zoom-out').addEventListener('mouseup', (e) => {this.svgPanZoom.zoomOut()});\n        document.getElementById('svg-pan-zoom-reset-pan-zoom').addEventListener('mouseup', (e) => {\n          e.stopPropagation();\n          this.svgPanZoom.pan({x: this.svgPanZoom.getPan().x - offsetLeft/2 , y: 50}, true)\n          this.svgPanZoom.zoom(Math.pow(.8,zoomFactor), true);\n        });\n      }\n\n      if(!this.panZoomSettings){\n        /* first time load of module */\n        /* center and bump down a bit */\n        this.svgPanZoom.pan({x: this.svgPanZoom.getPan().x - offsetLeft/2 , y: 50}, true)\n        this.svgPanZoom.zoom(Math.pow(.8,zoomFactor), true);\n      }\n\n    }\n\n  }\n}\n\nexport default ModuleGraph;\n","import React, {useMemo} from 'react';\nimport {useDropzone} from 'react-dropzone';\n\nconst baseStyle = {\n  flex: 1,\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n  padding: '25px',\n  borderWidth: 2,\n  borderRadius: '5px',\n  marginBottom: '15px',\n  borderColor: '#666666',\n  borderStyle: 'dashed',\n  backgroundColor: '#ffffff',\n  outline: 'none',\n  transition: 'border .15s ease-in-out'\n};\n\nconst activeStyle = {\n  borderColor: '#336699',\n  backgroundColor: '#dceaef',\n  color: '#336699'\n};\n\nconst acceptStyle = {\n  borderColor: '#339999',\n  cursor: 'hand'\n};\n\nconst rejectStyle = {\n  borderColor: '#ff1744',\n  backgroundColor: '#ffeeee',\n  cursor: 'no-drop'\n};\n\nfunction StyledDropzone(props) {\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    isDragAccept,\n    isDragReject\n  } = useDropzone({accept: 'application/json',onDrop:props.onDrop});\n\n  const style = useMemo(() => ({\n    ...baseStyle,\n    ...(isDragActive ? activeStyle : {}),\n    ...(isDragAccept ? acceptStyle : {}),\n    ...(isDragReject ? rejectStyle : {})\n  }), [\n    isDragActive,\n    isDragReject\n  ]);\n\n  return (\n    <div className=\"LoadModule-dropzone\">\n      <div {...getRootProps({style})}>\n        <input {...getInputProps()} />\n        <p>Drop files here or click to open saved modules.</p>\n      </div>\n    </div>\n  );\n}\n\nexport default StyledDropzone;\n","const LOCAL_STORAGE_KEY = 'modules';\n\n/**\n * Get any existing modules that exist in local storage\n *\n * @returns Object keyed by module name whose values are the module JSON\n */\nexport function getLocalStorageModules() {\n  const existingModules = localStorage.getItem(LOCAL_STORAGE_KEY);\n\n  if (!existingModules) return {};\n\n  return JSON.parse(existingModules);\n}\n\n/**\n * Get a module in local storage by name\n *\n * @param {string} moduleName name to lookup\n * @returns matching entry in the modules object, or null if none found\n */\nexport function getLocalStorageModuleByName(moduleName) {\n  const allModules = getLocalStorageModules();\n\n  return allModules[moduleName] || null;\n}\n\n/**\n * Save a module to local storage\n *\n * @param {Object} module the JSON content of the module being saved\n */\nexport function saveLocalStorageModule(module) {\n  const newModuleObject = { ...getLocalStorageModules() };\n\n  const timestamp = new Date().toLocaleString();\n\n  newModuleObject[module.name] = { module, timestamp };\n\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(newModuleObject));\n}\n\n/**\n * Delete a specific module from the object in localStorage\n *\n * @param {string} moduleName name of the module to remove\n */\nexport function removeLocalStorageModule(moduleName) {\n  const existingModules = getLocalStorageModules();\n\n  if (existingModules[moduleName]) {\n    const newModules = { ...existingModules };\n    delete newModules[moduleName];\n\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(newModules));\n  }\n}\n","import React, { Component } from 'react';\nimport './LoadModule.css';\nimport {generateDOT} from '../../utils/graphviz';\nimport StyledDropzone from './StyledDropZone';\nimport {\n  getLocalStorageModules,\n  removeLocalStorageModule,\n} from \"../../utils/localStorageHelpers\";\n\nclass LoadModule extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {json: '', selectedOption: 'core'}\n  }\n\n  loadModule = (json) => {\n    try {\n      let module = JSON.parse(json)\n\n      if(module.name === undefined){\n        throw new Error('Module must have a name.')\n      }\n\n      if(module.states === undefined || Object.keys(module.states).length === 0){\n        throw new Error('Module must have at least one state.')\n      }\n\n      let tableMessage =  ''\n\n      // need to get the tables for any table transition\n      for (var key in module.states)\n      {\n        if (module.states[key].lookup_table_transition != null)\n        {\n          tableMessage += key.toString() + ' & '\n\n          // this is an awful hack to get around a data model mismatch\n          const lttWrapper = { type: 'Table', transitions: module.states[key].lookup_table_transition };\n          module.states[key].lookup_table_transition = lttWrapper;\n\n\n          // put default data in for state of the table transition\n          module.states[key].lookup_table_transition.lookup_table_name_ModuleBuilder = module.states[key].lookup_table_transition.transitions[0].lookup_table_name;\n          module.states[key].lookup_table_transition.viewTable = false;\n          module.states[key].lookup_table_transition.lookuptable = '';\n        }\n      }\n\n      if (tableMessage.length > 0)\n      {\n        tableMessage = tableMessage.substr(0, tableMessage.length - 2);\n        // make a pop-up to tell the user to enter the table data\n        alert('Table Transition must be filled out in Module Builder for ' + tableMessage)\n      }\n      // this will throw an error if the module is incomprehensible\n      let dot = generateDOT(module);\n\n      this.props.newModule(module)\n      this.setState({...this.state, json: '', selectedOption: 'core'})\n\n    } catch (ex) {\n      alert('Error creating module: ' + ex.message);\n    }\n\n  }\n\n  onClick = (key) => {\n    return () => {\n      this.setState({...this.state, json: '', selectedOption: 'core'})\n      this.props.push('#' + key);\n    }\n  }\n\n  onDrop = (files) => {\n    files.forEach(file => {\n      const reader = new FileReader();\n\n      reader.onload = () => {\n        this.loadModule(reader.result);\n      };\n      reader.readAsText(file);\n    });\n  }\n\n  onLoadJSON = () => {\n    this.loadModule(this.state.json);\n  };\n\n  onOptionClick = (key) =>{\n    return () => {\n      this.setState({...this.state, selectedOption: key});\n    }\n  }\n\n  updateJson = (event) => {\n    this.setState({...this.state, json: event.target.value})\n  }\n\n  renderFooter = () => {\n    let loadButton = <span/>\n    if(this.state.selectedOption === 'json'){\n        loadButton = <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={this.onLoadJSON}>Load</button>\n    }\n    let closeButton = <span/>\n    if(!this.props.welcome){\n      closeButton = <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={this.props.onHide}>Close</button>\n    }\n\n    return <div className=\"modal-footer\" style={{height: 69}}>\n      {loadButton}\n      {closeButton}\n    </div>\n\n  }\n\n  renderDetails = () => {\n\n    switch(this.state.selectedOption){\n      case 'core':\n        return (\n          <ul className='LoadModule-list'>\n            { Object.keys(this.props.library).filter(n => (n.indexOf('/') === -1)).map( (key, index) => {\n              let module = this.props.library[key]\n              return (\n                <li key={key}><button className='btn btn-link' onClick={this.onClick(key)}>{module.name}</button></li>\n              )\n            })}\n          </ul>\n        )\n\n      case 'submodules':\n        return (\n          <ul className='LoadModule-list'>\n            { Object.keys(this.props.library).filter(n => (n.indexOf('/') > -1)).map( (key, index) => {\n              let module = this.props.library[key]\n              return (\n                <li key={key}><button className='btn btn-link' onClick={this.onClick(key)}>{key.split('/')[0] + ': ' + module.name}</button></li>\n              )\n            })}\n          </ul>\n        )\n\n      case 'my':\n        return (\n          <ul className='LoadModule-list'>\n            { Object.keys(this.props.modules).map( (key, index) => {\n              let module = this.props.modules[key]\n              return (\n                <li key={key}><button className='btn btn-link' onClick={this.onClick(key)}>{module.name} ({key})</button></li>\n              )\n            })}\n          </ul>\n        )\n\n\n      case 'json':\n        return (\n          <textarea id='loadJSON' value={this.state.json} onChange={this.updateJson}></textarea>\n        )\n\n      case 'git':\n        const columns = 1 + (this.state.Modules ? 1 : 0) + (this.state.Submodules ? 1 : 0);\n        const colsize = 12 / columns;\n\n        return(\n        <div className='row'>\n          <div className={`col-${colsize} nopadding`}>\n            <ul className='LoadModule-list'>\n              {this.state.Branches}\n            </ul>\n          </div>\n          {this.state.Modules && (\n            <div className={`col-${colsize} nopadding`}>\n              <ul className='LoadModule-list'>\n                {this.state.Modules}\n              </ul>\n            </div>\n            )}\n          {this.state.Submodules && (\n            <div className={`col-${colsize} nopadding`}>\n                <ul className='LoadModule-list'>\n                  {this.state.Submodules}\n                </ul>\n              </div>\n            )}\n        </div>\n        )\n\n    case 'local-storage':\n      return (\n        <ul className=\"LoadModule-list\">\n          {Object.keys(this.state.localStorageModules || {}).map(moduleName => { \n            const moduleEntry = this.state.localStorageModules[moduleName]\n            return (\n              <li key={moduleName}>\n                <div className=\"d-flex\">\n                  <div className=\"flex-grow-1\">\n                    <button className='btn btn-link' onClick={() => {\n                      this.loadModule(JSON.stringify(moduleEntry.module))\n                    }}>\n                      {moduleName} (Last saved: {moduleEntry.timestamp})\n                    </button>\n                  </div>\n                  <div className=\"flex-shrink-1 mx-5\">\n                    <button className=\"close h-100 w-100\" aria-label=\"Close\" onClick={() => {\n                      removeLocalStorageModule(moduleName);\n                      this.updateLocalStorageModules();\n                    }}>\n                      <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                  </div>\n                </div>\n              </li>\n            );\n          })}\n        </ul>\n      );\n    default:\n      return;\n    }\n  }\n\n  changeColor(ID, type) {\n    if (type === 'submodule') return; // as of now, the submodule panel doesn't persist so don't bother coloring it\n\n    document.getElementById(ID).style.backgroundColor = \"#ddd\";\n    let list = []\n    switch(type) {\n      case 'branch':\n        list = this.state.Branches\n        break;\n      case 'module':\n        list = this.state.Modules\n        break;\n      default:\n        break;\n    }\n    list.forEach((i) => {\n      if (i.props.id !== ID) {\n        document.getElementById(i.props.id).style.backgroundColor = \"#eee\";\n      }\n    });\n  }\n\n  updateLocalStorageModules() {\n    const existingModules = getLocalStorageModules();\n\n    this.setState({\n      localStorageModules: existingModules,\n    });\n  }\n\n  fetchBranchList() {\n    fetch(`https://api.github.com/repos/synthetichealth/synthea/branches`)\n    .then(response => response.json())\n    .then(data => {\n      this.setState({\n        Branches: data.map((branch, i) => (\n          <li key={i} id={branch.name}><button className='btn btn-link' onClick={() => {this.changeColor(branch.name, 'branch');this.fetchModuleList(branch.name)}}>{branch.name}</button></li>\n        ))\n      })\n    })\n    .catch(error => console.log('error: ', error));\n  }\n\n  fetchModuleList(branch) {\n    this.setState({\n      currentBranch: branch\n    })\n    fetch(`https://api.github.com/repos/synthetichealth/synthea/contents/src/main/resources/modules?ref=` + branch)\n      .then(response => response.json())\n      .then(data => {\n        this.setState({\n          Modules: this.mapFolderContentsToList(data, [], 'module'),\n          Submodules: null // reset submodules to prevent 404 errors\n        })\n      })\n      .catch(error => console.log('error: ', error));\n  }\n\n  fetchFile(path) {\n    fetch(`https://raw.githubusercontent.com/synthetichealth/synthea/` + this.state.currentBranch + `/src/main/resources/modules/` + path.join('/'))\n      .then(response => response.text())\n      .then(data => this.loadModule(data))\n      .then(this.setState ({\n        Submodules: null,\n        Modules: null\n      }))\n      .catch(error => console.log('error: ', error));\n  }\n\n  fetchFolder(path) {\n    fetch(`https://api.github.com/repos/synthetichealth/synthea/contents/src/main/resources/modules/` + path.join('/') + `?ref=` + this.state.currentBranch)\n      .then(response => response.json())\n      .then(data => this.setState({\n        Submodules: this.mapFolderContentsToList(data, path, 'submodule')\n      }))\n      .catch(error => console.log('error: ', error));\n  }\n\n  mapFolderContentsToList(data, path, type) {\n    data.sort((a, b) => {\n      // sort folders ahead of files, but both groups should use the usual alphabetical order\n      const aIsFile = a.name.endsWith(\".json\");\n      const bIsFile = b.name.endsWith(\".json\");\n\n      if (aIsFile === bIsFile) return a.name.localeCompare(b.name);\n      \n      if (aIsFile) {\n        // then we know B is a folder, B is first\n        return 1;\n      }\n      // now we know A is a folder, A is first\n      return -1;\n    });\n    const list = data.map((item, i) => {\n      const name = item.name;\n      const isFile = name.endsWith(\".json\");\n      const displayName = isFile ? name : name + '/'; \n      return (\n      <li key={i} id={item.name}>\n        <button className='btn btn-link' onClick={() => { this.changeColor(item.name, type); isFile ? this.fetchFile(path.concat(name)) : this.fetchFolder(path.concat(name))}}>\n          {displayName}\n        </button>\n      </li>\n    )});\n\n    if (path.length > 1) {\n      // add a \"go back\" option at the top\n      list.unshift((\n        <li key={-1} id=\"go-up-one\">\n          <button className='btn btn-link' onClick={() => {this.fetchFolder(path.slice(0,-1))}}>\n            ^ up one folder\n          </button>\n        </li>\n        ));\n    }\n\n    return list;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (\n      this.state.selectedOption === \"git\" &&\n      prevState.selectedOption !== \"git\"\n    ) {\n      this.fetchBranchList();\n    } else if (\n      this.state.selectedOption === \"local-storage\" &&\n      prevState.selectedOption !== \"local-storage\"\n    ) {\n      this.updateLocalStorageModules();\n    }\n  }\n\n  renderWelcomeMessage = () => {\n    if(this.props.welcome){\n      return (<div>\n        Welcome to Synthea Module Builder.  Please visit the documentation first.\n        </div>)\n    }\n\n    return <div />\n  }\n\n  render() {\n\n    let classDetails = \" hide\", style = {display: 'none'}\n\n    if(this.props.visible){\n      classDetails = \" show\";\n      style = {display: 'block'}\n    }\n\n    return (\n      <div>\n        <div className={'modal ' +  classDetails} style={style}>\n            <div className=\"modal-content\" style={{width:\"1024px\", marginLeft: '15%', marginRight: '15%', marginTop: 50}}>\n              <div className=\"modal-header\">\n                <h5 className=\"modal-title\">{(!this.props.welcome ? 'Load Module' : 'Synthea Module Builder')}</h5>\n                <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={this.props.onHide} style={{display: (this.props.welcome ? 'none' : '')}}>\n                  <span aria-hidden=\"true\">&times;</span>\n                </button>\n              </div>\n              <div className=\"modal-body LoadModule-body\">\n                <StyledDropzone onDrop={this.onDrop.bind(this)}/>\n                <div className='container'>\n                  <div className='row'>\n                    <div className='col-3 nopadding'>\n                      <ul className='LoadModule-options'>\n                         <li className={(this.state.selectedOption === 'core') ? 'selected' : ''}><button className='btn btn-link' onClick={this.onOptionClick('core')}>Core Modules</button></li>\n                         <li className={(this.state.selectedOption === 'submodules') ? 'selected' : ''}><button className='btn btn-link' onClick={this.onOptionClick('submodules')}>Submodules</button></li>\n                         {Object.keys(this.props.modules).length > 0 ? <li className={(this.state.selectedOption === 'my') ? 'selected' : ''}><button className='btn btn-link' onClick={this.onOptionClick('my')}>My Modules</button></li> : ''}\n                         <li className={(this.state.selectedOption === 'json') ? 'selected' : ''}><button className='btn btn-link' onClick={this.onOptionClick('json')}>Paste JSON</button></li>\n                         <li className={(this.state.selectedOption === 'git') ? 'selected' : ''}><button className='btn btn-link' onClick={this.onOptionClick('git')}>GitHub Modules</button></li>\n                         <li className={this.state.selectedOption === 'local-storage' ? 'selected' : '' }><button className='btn btn-link' onClick={this.onOptionClick('local-storage')} >Local Storage</button></li>\n                      </ul>\n                    </div>\n                    <div className='col-9 nopadding'>\n                      {this.renderDetails()}\n                    </div>\n                  </div>\n                </div>\n              </div>\n              {this.renderFooter()}\n          </div>\n        </div>\n        <div className={`modal-backdrop ${classDetails}`} style={style}/>\n      </div>\n    )\n  }\n}\n\nexport default LoadModule;\n","import React, { Component } from 'react';\nimport FileSaver from 'file-saver';\nimport _ from 'lodash'\nimport { getLocalStorageModuleByName, saveLocalStorageModule } from '../../utils/localStorageHelpers';\n\nimport './Download.css';\n\nclass Download extends Component {\n  constructor(props) {\n    super(props);\n    this.onDownload = this.onDownload.bind(this);\n\n    this.state = {\n      saveSuccess: false,\n    };\n  }\n  \n  onDownload(){\n    let blob = new Blob([this.refs.codeInput.value], {\n       type: \"text/plain;charset=utf-8\"\n    });\n\n    this.downloadCsvs();\n\n    let filename = this.props.module.name.replace(/[^a-z0-9]/gi, '_').toLowerCase();\n\n    FileSaver.saveAs(blob, `${filename}.json`, true); // true = no BOM, see https://github.com/eligrey/FileSaver.js/issues/160\n  }\n\n  downloadCsvs(){\n    \n    let module = _.cloneDeep(this.props.module);\n\n    // Go through the states\n    Object.keys(module.states).map(k => module.states[k]).forEach( s => {\n\n      // find table transitions and download the tables\n      if (s.lookup_table_transition !== undefined){\n        this.downloadCsv(s.lookup_table_transition.lookup_table_name_ModuleBuilder, s.lookup_table_transition.lookuptable);\n      }\n\n    })\n  }\n\n  downloadCsv(filename, data){\n      // the \\n are getting encoded to \\ + n. replace that with a line break\n      data = encodeURIComponent(data);\n      data = data.replace(/%5Cn/g, \"%0D%0A\"); \n\n      \n      var element = document.createElement('a');   \n      element.style.display = 'none';   \n      element.setAttribute('href', 'data:text/csv;charset=utf-8,' + data);\n      element.setAttribute('download', filename);\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n  }\n\n  prepareJSON(){\n    let module = _.cloneDeep(this.props.module);\n\n    // We currently save name in the state for convenience\n    // In lieu of a better solution, we will just remove it here\n    Object.keys(module.states).map(k => module.states[k]).forEach( s => {\n      if(s['name'] !== undefined){\n        delete s.name;\n      }\n\n      // Remove empty code value sets\n      if(s['codes'] !== undefined){\n        s['codes'].forEach( c => {\n          if (c.value_set !== undefined && !c.value_set){\n            delete c.value_set;\n          }\n        })\n      }\n\n      // find table transitions and delete state data\n      if (s.lookup_table_transition !== undefined){\n        let name = s.lookup_table_transition.lookup_table_name_ModuleBuilder;\n        s.lookup_table_transition.transitions.forEach( t => \n          {\n            t.lookup_table_name = name;\n          })\n        delete s.lookup_table_transition.lookup_table_name_ModuleBuilder;\n        delete s.lookup_table_transition.lookuptable;\n        delete s.lookup_table_transition.viewTable;\n        s.lookup_table_transition = s.lookup_table_transition.transitions;\n      }\n\n    })\n\n    return JSON.stringify(module, null, 2)\n  }\n\n  saveToLocalStorage = () => {\n    let shouldSave = true;\n    const localStorageModule = getLocalStorageModuleByName(this.props.module.name)\n\n    if (localStorageModule) {\n      shouldSave = confirm(`Module named \"${localStorageModule.module.name}\" (Last saved: ${localStorageModule.timestamp}) already exists in local storage. Overwrite?`);\n    }\n\n    if (shouldSave) {\n      saveLocalStorageModule(this.props.module);\n\n      this.setState({\n        saveSuccess: true,\n      });\n\n      setTimeout(() => {\n        this.setState({\n          saveSuccess: false,\n        });\n      }, 2000);\n    }\n  };\n\n  render() {\n\n    let classDetails = \"hide\", style = {display: 'none'}\n\n    if(this.props.visible){\n      classDetails = \"show\";\n      style = {display: 'block'}\n    }\n\n    return (\n      <div className='Download'>\n        <div className={`modal ${classDetails}`} style={style}>\n          <div className=\"modal-dialog modal-lg\" role=\"document\">\n            <div className=\"modal-content\">\n              <div className=\"modal-header\">\n                <h5 className=\"modal-title\">Download Module</h5>\n                <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={this.props.onHide}>\n                  <span aria-hidden=\"true\">&times;</span>\n                </button>\n              </div>\n              <div className=\"modal-body Download-body\">\n              <textarea ref=\"codeInput\" disabled value={this.prepareJSON()} />\n              </div>\n              {this.state.saveSuccess && (\n                <div>\n                  Successfully saved {this.props.module.name} to local storage\n                </div>\n              )}\n              <div className=\"modal-footer\">\n                <button type=\"button\" className=\"btn btn-primary\" data-dismiss=\"modal\" onClick={this.onDownload}>Download</button>\n                <button type=\"button\" className=\"btn btn-secondary\" onClick={this.saveToLocalStorage}>Save to Local Storage</button>\n                <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={this.props.onHide}>Close</button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className={`modal-backdrop ${classDetails}`} style={style}/>\n      </div>\n    )\n  }\n}\n\nexport default Download;\n","// @flow\nimport React, { Component } from 'react';\n\nimport './NavTabs.css';\n\nimport type { Module } from './types/Module';\n\nimport CancelButton from './cancel-button.png';\n\ntype Props = {\n  modules: Module[],\n  selectedModuleKey: string,\n  onChange: any\n}\n\n\nclass NavTabs extends Component<Props> {\n\n  constructor(props) {\n    super(props);\n  }\n\n  onClick = (selectedModuleKey) => {\n    if(selectedModuleKey === this.props.selectedModuleKey){\n      return () => {}\n    }\n\n    return () => this.props.onChangeModule(selectedModuleKey);\n  }\n\n  onClose = (selectedModuleKey) => {\n    return () => this.props.onCloseModule(selectedModuleKey);\n  }\n\n\n  render() {\n    return (\n      <div className='NavTabs'>\n        <ul>\n         {\n           Object.keys(this.props.modules).map( m => {\n             return (<li key={m} className={(m === this.props.selectedModuleKey ? 'NavTabs-active' : '')} ><button onClick={this.onClick(m)}>\n                 {/*this.props.modules[m].name*/}\n                 {m}.json\n               </button>\n              <img className=\"NavTabs-close\" src={CancelButton} onClick={this.onClose(m)} alt=\"Close\"/>\n             </li>\n             )})\n           }\n         </ul>\n      </div>\n    );\n  }\n}\n\nexport default NavTabs;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABTCAYAAADjsjsAAAADZ0lEQVR4nO2dTZKbMBBGnycXYJlljsANQm6RpY6inGS22c0RnJwAHyHL7PANyAJIYRsMgpbUyPqqvoVrPDT9Sn80wpyIr7L3F+ArUPSfl3QBrsBv4E//+eLlDBWrAAzwATRAK+imP67p4yQrQ5eoJLwlD2CTUAFY5FvglhZrOWhr1QLx8FAt+iDOQVWrEqiJD8rFNetWDkFliQ9mj600kC0qOF5rfNZKo42lJfrHRlc3ROj2hvRAjoEaKVBLMh4T0WQjg2teJnKCyQA1CpJLAmiKk81ai05KBa8Lcgx0cdn0tsyS85oDJa6CjsNTfVr4uwW+S5xNAvoMnIBfW/65JH730uhN42cql4nSrueAzXVzS+7ec3Lq7j5m7waoCN/a6z6uj3xWTcrWQ+BhnAlZZRpXgXysk+0SSOlWObXgDQF0qpwmDXSxdVrPIEMAfVaXlAZqZ+KAYKA1l2A+gK4p8EoCbeaCGMGkqoWEBkkCdamUV4K5mqkAkhsEXBKTABo63tgfUwGkDh46wZggB9/ENx4ChEhUA8iWu67ucw+Qr4S1gGy56+q+65XSiWsC2TKa1UNVh6QAaAM5uISw93b2gtAKsqUfN23AgHuAaAbZ0l8NnQMH3QLm3fH7MWqxZyIFdgW6VjH3PtVECuwDqIZNZFGDSwHVAFIFzL1AtYBUA3MrUE0gVcFs6WZtF70rOGeVMHPLjAhSI9DoJ5Bnc0UgB2kAmq+ApPJ5o3vMOLQuwLeVsV2uza/9cWM8Kn2FXDWSsoVcz5SygVxpl/L/TRf5HtA+3+zsyHcn9/nm7qTxFOQl75vnHR37/BA/7zXa5oe9RpB3wW21mQuS92e65zkrK5jYy+8cLoSDTQENse6bAioNspmI8SArnNgYaMgrkjFQaZCLrXKQdOscgFYBQY6BVp7yWV0+tIGTPprtWpCDYlettbp2BQn5qd45zy75nj1v/pfugcvqyXdeTT+An3sOkLt7503d+14+Zvej2Wn2XpKPddpRvObS2FlGQWIxbPajm5ZRkFwSIAeZyAkmA3KQId0xtCHCL2inOCl5mWzWSsNmKSn72Pu0SZb4MPbYSgPZq5LjtdIahb+GPZZF/1jaoLA1zqlAJ9QBooqx0VVaoB4a4pQM+a0r4ipI9H1Ap9ABJ1SSyJuq/gG9HAYxsPsSkQAAAABJRU5ErkJggg==\"","// @flow\nimport uuid from 'uuid-js';\n\nimport type { Module } from '../types/Module';\nimport type { State } from '../types/State';\nimport type { DirectTransition, DistributedTransition, ConditionalTransition, ComplexTransition, TableTransition, Transition } from '../types/Transition';\n\nexport function extractModule(data: any): Module {\n  let name = extractName(data);\n  let states = extractStates(data);\n  let remarks = extractRemarks(data);\n  return {name, states, remarks};\n}\n\nexport function extractStates(data: any): State[] {\n  if(!data){\n      return []\n  }\n  let stateNames = Object.keys(data.states);\n  return stateNames.map((name) => {\n    return extractState(name, data.states[name]);\n  })\n}\n\nexport function extractState(name: string, state: any): State {\n  let transition = extractTransition(state);\n  let id = uuid.create().toString();\n  let type = state.type;\n  return {name, transition, id, type, ...state};\n}\n\nexport function extractTransition(state: any): ?Transition {\n  if(state.direct_transition) {\n    return extractDirectTransition(state.direct_transition);\n  }\n  if(state.distributed_transition) {\n    return extractDistributedTransition(state.distributed_transition);\n  }\n  if(state.conditional_transition) {\n    return extractConditionalTransition(state.conditional_transition);\n  }\n  if(state.complex_transition) {\n    return extractComplexTransition(state.complex_transition);\n  }\n  if(state.lookup_table_transition) {\n    return extractTableTransition(state.lookup_table_transition);\n  }\n  return null;\n}\n\nexport function extractDirectTransition(data: any): DirectTransition {\n  return {to: data, type: 'Direct'}\n}\n\nexport function extractDistributedTransition(data: any): DistributedTransition {\n  let transition = data.map((d) => {\n    return {distribution: d.distribution, to: d.transition};\n  });\n  return {type: 'Distributed', transition};\n}\n\nexport function extractConditionalTransition(data: any): ConditionalTransition {\n  let transition = data.map((d) => {\n    return {condition: d.condition, to: d.transition};\n  });\n  return {type: 'Conditional', transition};\n}\n\nexport function extractComplexTransition(data: any): ComplexTransition {\n  let transition = data.map((c) => {\n    return {\n      condition: c.condition,\n      distributions: extractDistributedTransition(c.distributions||[]).transition,\n      transition: extractDirectTransition(c.transition)\n    }\n  })\n  return {type: 'Complex', transition};\n}\n\nexport function extractTableTransition(data: any): TableTransition {\n  let transition = data.transitions.map((d) => {\n    return {\n      default_probability: d.default_probability, \n      transition: d.transition,\n      lookup_table_name: d.lookup_table_name,\n    };\n  });\n  return { \n    type: 'Table', \n    lookuptable: data.lookuptable, \n    viewTable: data.viewTable,\n    lookup_table_name_ModuleBuilder: data.lookup_table_name_ModuleBuilder, \n    transition \n  };\n}\n\nexport function extractRemarks(data: any):string[] {\n  return (data.remarks :string[]);\n}\n\nexport function extractName(data: any): string {\n  return (data.name: string);\n}\n\nexport function extractAttributes(module: Module): string[] {\n  let attributes = Object.keys(module.states).filter((key) => {\n    return module.states[key].type === 'SetAttribute' || module.states[key].type === 'Counter';\n  }).map(key => (module.states[key].attribute))\n\n  attributes = attributes.concat(Object.keys(module.states).filter((key) => {\n    return !!module.states[key].assign_to_attribute\n  }).map(key => (module.states[key].assign_to_attribute)))\n\n\n  return [...new Set(attributes)]\n\n}\n","\nexport function findAvailableKey(root, keys){\n  // eslint-disable-next-line no-sequences\n  let keys_index = keys.reduce((r, i) => (r[i] = true, r), {})\n\n  let next = root;\n  let index = 1;\n\n  // check if this pattern already exists, so we don't chain key_2_2_2 etc\n  let endsInNumber = /_(\\d+)$/g;\n  let matches = endsInNumber.exec(root);\n  if(matches && matches.length > 1){\n    index = parseInt(matches[1]);\n    root = next = next.replace(matches[0], \"\");\n  }\n\n  while(keys_index[next]){\n    index++;\n    next = root + \"_\" + index;\n  }\n\n  return next;\n}\n\nexport function createSafeKeyFromName(name){\n  return name.replace(/[^A-Z0-9]/ig, \"_\");\n}\n","export default { \"example_module\": \n    {\n      \"name\": \"Examplitis\",\n      \"remarks\": [\n        \"Examplitis is a painful condition that affects only males. Most patients \",\n        \"can be cured with Examplitol or an Examplotomy but some never recover.\"\n      ],\n      \"states\": {\n\n        \"Initial\": {\n          \"type\": \"Initial\",\n          \"conditional_transition\": [\n            {\n              \"condition\": {\n                \"condition_type\": \"Gender\",\n                \"gender\": \"M\"\n              },\n              \"transition\": \"Age_Guard\"\n            },\n            {\n              \"transition\": \"Terminal\"\n            }\n          ]\n        },\n\n        \"Age_Guard\": {\n          \"type\": \"Guard\",\n          \"allow\": {\n            \"condition_type\": \"Age\",\n            \"operator\": \">\",\n            \"quantity\": 40,\n            \"unit\": \"years\"\n          },\n          \"distributed_transition\": [\n            {\n              \"distribution\": 0.10,\n              \"transition\": \"Pre_Examplitis\"\n            },\n            {\n              \"distribution\": 0.90,\n              \"transition\": \"Terminal\"\n            }\n          ]\n        },\n\n        \"Pre_Examplitis\": {\n          \"type\": \"Delay\",\n          \"range\": {\n            \"low\": 0,\n            \"high\": 10,\n            \"unit\": \"years\"\n          },\n          \"direct_transition\": \"Examplitis\"\n        },\n\n        \"Examplitis\": {\n          \"type\": \"ConditionOnset\",\n          \"target_encounter\": \"Wellness_Encounter\",\n          \"codes\": [\n            {\n              \"system\": \"SNOMED-CT\",\n              \"code\": \"123\",\n              \"display\": \"Examplitis\"\n            }\n          ],\n          \"direct_transition\": \"Wellness_Encounter\"\n        },\n\n        \"Wellness_Encounter\": {\n          \"type\": \"Encounter\",\n          \"wellness\": true,\n          \"direct_transition\": \"Examplitol\"\n        },\n\n        \"Examplitol\": {\n          \"type\": \"MedicationOrder\",\n          \"reason\": \"Examplitis\",\n          \"codes\": [\n            {\n              \"system\": \"RxNorm\",\n              \"code\": \"456\",\n              \"display\": \"Examplitol\"\n            }\n          ],\n          \"distributed_transition\": [\n            {\n              \"distribution\": 0.2,\n              \"transition\": \"Pre_Examplotomy\"\n            },\n            {\n              \"distribution\": 0.1,\n              \"transition\": \"Last_Days\"\n            },\n            {\n              \"distribution\": 0.7,\n              \"transition\": \"Terminal\"\n            }\n          ]\n        },\n\n        \"Pre_Examplotomy\": {\n          \"type\": \"Delay\",\n          \"range\": {\n            \"low\": 18,\n            \"high\": 36,\n            \"unit\": \"months\"\n          },\n          \"direct_transition\": \"Examplotomy_Encounter\"\n        },\n\n        \"Examplotomy_Encounter\": {\n          \"type\": \"Encounter\",\n          \"encounter_class\": \"ambulatory\",\n          \"codes\": [\n            {\n              \"system\": \"SNOMED-CT\",\n              \"code\": \"ABC\",\n              \"display\": \"Examplotomy Encounter\"\n            }\n          ],\n          \"direct_transition\": \"Examplotomy\"\n        },\n\n        \"Examplotomy\": {\n          \"type\": \"Procedure\",\n          \"duration\": {\n            \"low\": 2,\n            \"high\": 3,\n            \"unit\": \"hours\"\n          },\n          \"codes\": [\n            {\n              \"system\": \"SNOMED-CT\",\n              \"code\": \"789\",\n              \"display\": \"Examplotomy\"\n            }\n          ],\n          \"reason\": \"Examplitis\",\n          \"direct_transition\": \"End_Examplotomy_Encounter\"\n        },\n\n        \"End_Examplotomy_Encounter\": {\n            \"type\": \"EncounterEnd\",\n            \"distributed_transition\": [\n            {\n              \"distribution\": 0.1,\n              \"transition\": \"Death\"\n            },\n            {\n              \"distribution\": 0.9,\n              \"transition\": \"Terminal\"\n            }\n          ]\n        },\n\n        \"Last_Days\": {\n          \"type\": \"Delay\",\n          \"range\": {\n              \"low\": 8,\n              \"high\": 20,\n              \"unit\": \"years\"\n          },\n          \"direct_transition\": \"Death\"\n        },\n\n        \"Death\": {\n          \"type\": \"Death\",\n          \"direct_transition\": \"Terminal\"\n        },\n\n        \"Terminal\": {\n          \"type\": \"Terminal\"\n        }\n      }\n    }\n}\n","// @flow\nimport React, { Component } from 'react';\n\nimport './JsonEditor.css';\nimport { JsonEditor as Editor } from 'jsoneditor-react';\nimport 'jsoneditor-react/es/editor.min.css';\nimport ace from 'brace';\nimport 'brace/mode/json';\nimport {generateDOT} from '../../utils/graphviz';\n\nimport type { Module } from './types/Module';\n\ntype Props = {\n  module: Module,\n  onChange: mixed\n}\n\nclass JsonEditor extends Component<Props> {\n\n  constructor(props) {\n    super(props);\n    this.onChange = this.onChange.bind(this);\n  }\n\n  onChange(module) {\n    \n    if(this.clearTimeout){\n      clearTimeout(this.clearTimeout);\n    }\n\n    this.clearTimeout = setTimeout(()=>{\n\n      try {\n        let dot = generateDOT(module);\n\n        this.props.onChange(module)\n\n      } catch (ex) {\n        // currently silently fails on this\n        // alert('Error creating module: ' + ex.message);\n      }\n\n    }, 1000) // wait a second for user to complete changes\n  }\n\n\n  render() {\n    if(this.props.refreshCodeFlag){\n      return <div/>\n    }\n    return (\n      <div className='JsonEditor'>\n        <Editor\n          value={this.props.module}\n          mode='code'\n          ace={ace}\n          onChange={this.onChange}\n        />\n      </div>\n    );\n  }\n}\n\nexport default JsonEditor;;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABTCAYAAADjsjsAAAADZ0lEQVR4nO2dTZKbMBBGnycXYJlljsANQm6RpY6inGS22c0RnJwAHyHL7PANyAJIYRsMgpbUyPqqvoVrPDT9Sn80wpyIr7L3F+ArUPSfl3QBrsBv4E//+eLlDBWrAAzwATRAK+imP67p4yQrQ5eoJLwlD2CTUAFY5FvglhZrOWhr1QLx8FAt+iDOQVWrEqiJD8rFNetWDkFliQ9mj600kC0qOF5rfNZKo42lJfrHRlc3ROj2hvRAjoEaKVBLMh4T0WQjg2teJnKCyQA1CpJLAmiKk81ai05KBa8Lcgx0cdn0tsyS85oDJa6CjsNTfVr4uwW+S5xNAvoMnIBfW/65JH730uhN42cql4nSrueAzXVzS+7ec3Lq7j5m7waoCN/a6z6uj3xWTcrWQ+BhnAlZZRpXgXysk+0SSOlWObXgDQF0qpwmDXSxdVrPIEMAfVaXlAZqZ+KAYKA1l2A+gK4p8EoCbeaCGMGkqoWEBkkCdamUV4K5mqkAkhsEXBKTABo63tgfUwGkDh46wZggB9/ENx4ChEhUA8iWu67ucw+Qr4S1gGy56+q+65XSiWsC2TKa1UNVh6QAaAM5uISw93b2gtAKsqUfN23AgHuAaAbZ0l8NnQMH3QLm3fH7MWqxZyIFdgW6VjH3PtVECuwDqIZNZFGDSwHVAFIFzL1AtYBUA3MrUE0gVcFs6WZtF70rOGeVMHPLjAhSI9DoJ5Bnc0UgB2kAmq+ApPJ5o3vMOLQuwLeVsV2uza/9cWM8Kn2FXDWSsoVcz5SygVxpl/L/TRf5HtA+3+zsyHcn9/nm7qTxFOQl75vnHR37/BA/7zXa5oe9RpB3wW21mQuS92e65zkrK5jYy+8cLoSDTQENse6bAioNspmI8SArnNgYaMgrkjFQaZCLrXKQdOscgFYBQY6BVp7yWV0+tIGTPprtWpCDYlettbp2BQn5qd45zy75nj1v/pfugcvqyXdeTT+An3sOkLt7503d+14+Zvej2Wn2XpKPddpRvObS2FlGQWIxbPajm5ZRkFwSIAeZyAkmA3KQId0xtCHCL2inOCl5mWzWSsNmKSn72Pu0SZb4MPbYSgPZq5LjtdIahb+GPZZF/1jaoLA1zqlAJ9QBooqx0VVaoB4a4pQM+a0r4ipI9H1Ap9ABJ1SSyJuq/gG9HAYxsPsSkQAAAABJRU5ErkJggg==\"","// @flow\nimport React, { Component } from 'react';\nimport _ from 'lodash';\n\nimport './StateList.css';\nimport CancelButton from './cancel-button.png';\n\ntype Props = {\n  states: State[],\n  selectedState: State,\n  onChange: any,\n}\n\nclass StateList extends Component<Props> {\n\n  constructor(props) {\n    super(props);\n    this.state = {search: ''};\n  }\n\n  onClick(state) {\n    return () => { this.props.onClick(state.name)}\n  }\n\n  onChange(event){\n    this.setState({search: event.target.value});\n  }\n\n  clearSearch(){\n    this.setState({search: ''})\n  }\n\n  stateFilter(state){\n    return state.name.toLowerCase().includes(this.state.search.toLowerCase()) || \n           state.type.toLowerCase().includes(this.state.search.toLowerCase());\n  }\n\n  render() {\n    return (<div className='StateList'>\n          <div className='Editor-panel-title'> \n             State List\n          </div>\n          <div className=\"btn-group\">\n            <input type=\"text\" className=\"form-control\" placeholder=\"Find\" value={this.state.search} onChange={this.onChange.bind(this)}/>\n            <img className=\"search-clear\" src={CancelButton} onClick={this.clearSearch.bind(this)}/>\n          </div>\n          <table className=\"table table-sm table-hover\">\n              <thead className=\"thead-light\">\n                <tr>\n                  <th scope=\"col\">State</th>\n                  <th scope=\"col\">Type</th>\n                </tr>\n              </thead>\n              <tbody>\n              {this.props.states.filter(this.stateFilter.bind(this)).map((state,i) => {\n                return (\n                  <tr key={i} onClick={this.onClick(state)} className={this.props.selectedState && (state.name === this.props.selectedState.name) ? \"table-info\" : \"\"}>\n                    <th scope=\"row\">{state.name}</th>\n                    <td>{state.type}</td>\n                  </tr>\n                )\n              })}\n              </tbody>\n            </table>\n          </div>)\n  }\n}\n\nexport default StateList;\n","// @flow\nimport React, { Component } from 'react';\nimport _ from 'lodash';\n\nimport './AttributeList.css';\nimport CancelButton from './cancel-button.png';\nimport AttributeData from './AttributeData.json';\nimport Attributes from '../editor/Attributes';\nimport Dropdown from 'react-dropdown';\nimport './Dropdown.css';\n\ntype Props = {\n  states: State[],\n  modules: Module[],\n  selectedState: State,\n  onChange: any,\n}\n\nclass AttributeList extends Component<Props> {\n\n  constructor(props) {\n    super(props);\n    this.state = {search: ''};\n  }\n\n  onClick(attribute) {\n    return () => { this.props.onClick(attribute.stateName)}\n  }\n\n  onChange(event){\n    this.setState({search: event.target.value});\n  }\n\n  clearSearch(){\n    this.setState({search: ''})\n  }\n\n  attributeFilter(attribute){\n    return attribute.attribute.toLowerCase().includes(this.state.search.toLowerCase()) || \n           attribute.stateName.toLowerCase().includes(this.state.search.toLowerCase());\n  }\n  \n  onSelect = (option) =>  {\n    // Open this module\n    this.props.loadSelectedModule(option.label)\n  }\n\n  render() {\n    const data = AttributeData;\n    return (<div className='AttributeList'>\n          <div className='Editor-panel-title'> \n             Attribute List\n          </div>\n\n          <div className=\"btn-group\">\n            <input type=\"text\" className=\"form-control\" placeholder=\"Find\" value={this.state.search} onChange={this.onChange.bind(this)}/>\n            <img className=\"search-clear\" src={CancelButton} onClick={this.clearSearch.bind(this)}/>\n          </div>\n          <div>\n            Note: This currently only displays attributes being written in this module.  It does not include referenced attributes\n            or attributes written in other modules.\n          </div>\n          <table className=\"table table-sm table-hover\">\n              <thead className=\"thead-light\">\n                <tr>\n                  <th scope=\"col\">Attribute</th>\n                  <th scope=\"col\">State</th>\n                  <th scope=\"col\">Other Modules</th>\n                </tr>\n              </thead>\n              <tbody>\n              {this.props.attributes.filter(this.attributeFilter.bind(this)).map((attribute, i) => {\n                let others = [this.props.module.name];\n                if (data[attribute.attribute]!= undefined) \n                {\n                  Object.keys(data[attribute.attribute].read).forEach(i => {others.push(i)})                \n                  Object.keys(data[attribute.attribute].write).forEach(i => {others.push(i)})\n                }\n                others = others.filter((x, i, a) => a.indexOf(x) == i)\n                others.splice(others.indexOf[this.props.module.name], 1);\n                let dropDown;\n                if (others.length > 0)\n                {\n                  dropDown = <Dropdown className='code' options={others} onChange={this.onSelect} value=\"Jump To Module...\" />\n                }\n                else\n                {\n                  dropDown = <td className={this.props.selectedState && (attribute.stateName === this.props.selectedState.name) ? \"table-info\" : \"\"} onClick={this.onClick(attribute)} >None</td>\n                }\n\n                \n                return (\n                  <tr key={i}>\n                    <th className={this.props.selectedState && (attribute.stateName === this.props.selectedState.name) ? \"table-info\" : \"\"} onClick={this.onClick(attribute)} scope=\"row\">{attribute.attribute}</th>\n                    <td className={this.props.selectedState && (attribute.stateName === this.props.selectedState.name) ? \"table-info\" : \"\"} onClick={this.onClick(attribute)} >{attribute.stateName} </td>\n                    {dropDown}\n                  </tr>\n                )\n              })}\n              </tbody>\n            </table>\n          </div>)\n  }\n}\n\nexport default AttributeList;\n","// @flow\nimport React, { Component } from 'react';\nimport _ from 'lodash';\n\nimport './WarningList.css';\n\ntype Props = {\n  warnings: mixed,\n  selectedState: State\n}\n\nclass WarningList extends Component<Props> {\n\n  onClick(warning) {\n    return () => { this.props.onClick(warning.stateName)}\n  }\n\n  render() {\n    return (<div className='WarningList'>\n          <div className='Editor-panel-title'> \n            Warnings\n          </div>\n\n          <table className=\"table table-sm table-hover\">\n              <thead className=\"thead-light\">\n                <tr>\n                  <th scope=\"col\">Warning</th>\n                  <th scope=\"col\">State</th>\n                </tr>\n              </thead>\n              <tbody>\n       \n              {this.props.warnings.map( (warning, i) => {\n                return (\n                  <tr key={i} onClick={this.onClick(warning)} className={this.props.selectedState && (warning.stateName === this.props.selectedState.name) ? \"table-info\" : \"\"}>\n                    <th scope=\"row\">{warning.message}</th>\n                    <td>{warning.stateName}</td>\n                  </tr>\n                )\n              })}\n              </tbody>\n            </table>\n          </div>)\n  }\n}\n\nexport default WarningList;\n","// @flow\nimport React, { Component } from 'react';\nimport _ from 'lodash';\n\nimport './RelatedList.css';\n\ntype Props = {\n  related: mixed,\n  selectedState: State\n}\n\nclass RelatedList extends Component<Props> {\n\n  onClick(related) {\n    return () => { this.props.onClick(related.stateName)}\n  }\n\n  render() {\n    return (<div className='RelatedList'>\n          <div className='Editor-panel-title'> \n            Related Modules\n          </div>\n\n          <div>\n            This currently only displays relationships based on submodules.  Additional relationships are in progress.\n          </div>\n\n          <table className=\"table table-sm table-hover\">\n              <thead className=\"thead-light\">\n                <tr>\n                  <th scope=\"col\">Type</th>\n                  <th scope=\"col\">Module</th>\n                  <th scope=\"col\">State</th>\n                </tr>\n              </thead>\n              <tbody>\n       \n              {this.props.related.map( (related, i) => {\n                return (\n                  <tr key={i} onClick={this.onClick(related)} className={this.props.selectedState && (related.stateName === this.props.selectedState.name) ? \"table-info\" : \"\"}>\n                    <th scope=\"row\">{related.type}</th>\n                    <td>{related.moduleKey}</td>\n                    <td>{related.stateName}</td>\n                  </tr>\n                )\n              })}\n              </tbody>\n            </table>\n          </div>)\n  }\n}\n\nexport default RelatedList;\n","export default __webpack_public_path__ + \"static/media/synthea-animated-logo.6aaf309c.svg\";","export default __webpack_public_path__ + \"static/media/synthea-logo.17848c75.png\";","export const analyze = (moduleKey, module) => {\n  return ({\n    type: 'ANALYZE',\n    data: {moduleKey, module}\n  })\n}\n","import {analyze} from  './analysis';\nimport { push } from 'connected-react-router'\n\nconst dispatchThenAnalyze = (action) => {\n  return (dispatch, getState) => {\n    dispatch(action);\n    let moduleKey = getState().editor.selectedModuleKey;\n    let module = getState().editor.modules[moduleKey];\n\n    if(module){\n      if (module.gmf_version === undefined) {\n        dispatch(addGMFVersion(moduleKey))\n      }\n      dispatch(analyze(moduleKey, module));\n    }\n\n    // refresh the editor if the change didn't originate from the editor\n    if(action.type !== 'JSON_EDIT'){\n      dispatch(refreshCode())\n    }\n\n  }\n}\n\nexport const addGMFVersion = (targetModuleKey) => {\n  return ({\n    type: 'ADD_GMF_VERSION',\n    data: {targetModuleKey}\n  })\n}\n\nexport const selectNode = (key, transitionIndex) => {\n  return ({\n    type: 'SELECT_NODE',\n    data: {key, transitionIndex}\n  })\n}\n\nexport const addNode = (currentModuleKey, stateKey, state, selectedState, selectedStateTransition) => {\n   return dispatchThenAnalyze({\n    type: 'ADD_NODE',\n    data: {currentModuleKey, stateKey, state, selectedState, selectedStateTransition}\n  })\n}\n\nexport const addStructure = (currentModuleKey, structureName) => {\n  return dispatchThenAnalyze({\n    type: 'ADD_STRUCTURE',\n    data: {currentModuleKey, structureName}\n  });\n}\n\nexport const addTransition = (currentModuleKey, nodeName, transitionType) => {\n  return dispatchThenAnalyze({\n    type: 'ADD_TRANSITION',\n    data: {currentModuleKey, nodeName, transitionType}\n  });\n}\n\nexport const editNode = (update, path) => {\n  return dispatchThenAnalyze({\n    type: 'EDIT_NODE',\n    data: {\n      update,\n      path\n    }\n  })\n}\n\nexport const renameNode = (targetModuleKey, targetNode, newName) => {\n  return dispatchThenAnalyze({\n    type: 'RENAME_NODE',\n    data:{\n      targetModuleKey,\n      targetNode,\n      newName\n    }\n  })\n}\n\nexport const copyNode = (targetModuleKey, targetNode, newName) => {\n  return {\n    type: 'COPY_NODE',\n    data:{\n      targetModuleKey,\n      targetNode\n    }\n  }\n}\n\nexport const jsonEdit = (module) => {\n  return dispatchThenAnalyze({\n    type: 'JSON_EDIT',\n    data: {module}\n  })\n}\n\nexport const closeModule = (selectedModuleKey) => {\n\n  return (dispatch, getState) => {\n\n    if(Object.keys(getState().editor.modules).length > 1){\n      if(Object.keys(getState().editor.modules)[0] === selectedModuleKey){\n        dispatch(push('#' + Object.keys(getState().editor.modules)[1])); // handling case where first is the one we already have open\n      }else {\n        dispatch(push('#' + Object.keys(getState().editor.modules)[0]));\n      }\n    } else {\n      dispatch({type: 'OPEN_MODULE', data: {}}); // open nothing to force welcome screen\n      dispatch(push('#'));\n    }\n\n\n    return dispatch({type: 'CLOSE_MODULE', data: {selectedModuleKey}});\n\n  }\n}\n\nexport const newModule = (key, module) => {\n  return dispatchThenAnalyze({\n    type: 'NEW_MODULE',\n    data: {key, module}\n  })\n}\n\nexport const editModuleName = (targetModuleKey, newName) => {\n  return ({\n    type: 'EDIT_MODULE_NAME',\n    data: {\n      newName,\n      targetModuleKey\n    }\n  })\n}\n\nexport const editModuleRemarks = (targetModuleKey, newRemarks) => {\n  return ({\n    type: 'EDIT_MODULE_REMARKS',\n    data: {\n      newRemarks,\n      targetModuleKey\n    }\n  })\n}\n\nexport const changeStateType = (targetModuleKey, targetNode, newType) => {\n  return dispatchThenAnalyze({\n    type: 'CHANGE_STATE_TYPE',\n    data:{\n      targetModuleKey,\n      targetNode,\n      newType\n    }\n  })\n}\n\nexport const undo = () => {\n  return dispatchThenAnalyze({\n    type: 'UNDO'\n  })\n}\n\nexport const redo = () => {\n  return dispatchThenAnalyze({\n    type: 'REDO'\n  })\n}\n\nexport const showLoadModule = () => {\n  return ({\n    type: 'SHOW_LOAD_MODULE'\n  })\n}\n\nexport const hideLoadModule = () => {\n  return ({\n    type: 'HIDE_LOAD_MODULE'\n  })\n}\n\nexport const showDownload = () => {\n  return ({\n    type: 'SHOW_DOWNLOAD'\n  })\n}\n\nexport const hideDownload = () => {\n  return ({\n    type: 'HIDE_DOWNLOAD',\n  })\n}\n\n\nexport const changeModulePanel = (targetPanel) => {\n  return dispatchThenAnalyze({\n    type: 'CHANGE_MODULE_PANEL',\n    data:{\n      targetPanel\n    }\n  })\n}\n\nexport const refreshCode = () => {\n  return dispatch => {\n    dispatch({\n      type: 'REFRESH_CODE_FLAG',\n      data:{\n        flag: true\n      }\n    })\n\n    setTimeout(() => {dispatch({\n      type: 'REFRESH_CODE_FLAG',\n      data:{\n        flag: false\n      }\n    })}, 250)\n\n\n  }\n}\n\n","import {analyze} from  './analysis';\n\nexport const openModule = (key) => {\n\n  return (dispatch, getState) => {\n    let action = {type: 'OPEN_MODULE', data: {key}};\n\n    if(!getState().editor.modules[key] && getState().library.modules[key]){\n      action.data.libraryModule = getState().library.modules[key];\n    }\n\n    dispatch(action);\n    if(getState().editor.modules[key]){\n      dispatch(analyze(key, getState().editor.modules[key]));\n    }\n  }\n}\n","import { openModule } from './router'\n\nexport const loadLibrary = (modules) => {\n  return (dispatch, getState) => {\n\n    dispatch ({\n      type: 'LOAD_LIBRARY',\n      data: modules\n    })\n\n    if(getState().router.location.hash.charAt(0) === '#'){\n      dispatch(openModule(getState().router.location.hash.slice(1)));\n    }\n  }\n}\n\n","import React, { Component } from 'react'\nimport { push } from 'connected-react-router'\nimport { bindActionCreators } from 'redux'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport Joyride from 'react-joyride'\nimport ReactTooltip from 'react-tooltip'\nimport Draggable from 'react-draggable'\n\nimport StateEditor from '../components/editor/State';\nimport ModulePropertiesEditor from '../components/editor/ModuleProperties';\nimport ModuleGraph from '../components/graph/ModuleGraph';\nimport LoadModule from '../components/menu/LoadModule';\nimport Download from '../components/menu/Download';\nimport NavTabs from '../components/editor/NavTabs';\nimport { extractStates } from '../transforms/Module';\nimport {cleanString } from '../utils/stringUtils';\n\nimport { findAvailableKey, createSafeKeyFromName } from '../utils/keys';\nimport { getTemplate } from '../templates/Templates';\nimport { BasicTutorial } from '../templates/Tutorial';\n\nimport { RIEInput } from 'riek';\n\nimport examplitis from '../data/example_module'\n\nimport './Editor.css';\n\nimport JsonEditor from '../components/editor/JsonEditor';\n\nimport StateList from '../components/analysis/StateList';\nimport AttributeList from '../components/analysis/AttributeList';\nimport WarningList from '../components/analysis/WarningList';\nimport RelatedList from '../components/analysis/RelatedList';\n\nimport LoadingLogo from './synthea-animated-logo.svg'\n// import SyntheaLogo from './synthea-logo-dark-glow.png'\nimport SyntheaLogo from './synthea-logo.png'\nimport MinimizePanel from './minimize-panel.png'\nimport FullscreenButton from './fullscreen.png'\nimport InfoButton from './Info.png'\nimport StateButton from './state-button.png'\nimport StateListButton from './statelist.png'\nimport CodeButton from './code-button.png'\nimport AttributeButton from './attribute-button.png'\nimport RelatedButton from './related-button.png'\nimport WarningButton from './warning-button.png'\n\nimport {selectNode,\n        addNode,\n        addStructure,\n        addTransition,\n        editNode,\n        renameNode,\n        copyNode,\n        newModule,\n        jsonEdit,\n        showLoadModule,\n        hideLoadModule,\n        showDownload,\n        hideDownload,\n        refreshCode,\n        changeStateType,\n        editModuleName,\n        editModuleRemarks,\n        closeModule,\n        undo,\n        redo,\n        changeModulePanel} from '../actions/editor';\n\nimport {loadLibrary} from '../actions/library';\n\nclass Editor extends Component {\n\n  constructor() {\n    super();\n\n    this.originalPanelWidth = 500;\n    this.state = {\n      joyride: {\n        run: false,\n        steps: BasicTutorial,\n        stepIndex: 0\n      },\n      panelWidth: this.originalPanelWidth,\n    }\n  }\n\n  componentDidMount() {\n    import(\"../data/modules\").then(modules => {\n      this.props.loadLibrary({...examplitis, ...modules.default});\n\n      // see https://github.com/wwayne/react-tooltip/issues/40\n      setTimeout(() => {\n       ReactTooltip.rebuild();\n      }, 1000)\n    });\n\n  }\n\n  /*\n    This is a recursive function to track the path that an edit action took through the Inspector\n    It was written this way because there's multiple ways that one could get to, say, a Conditional Editor\n    By keeping track of where it's been it means that the action can just look into the modules along the path\n  */\n  onChange  = (update, path=[]) => {\n    if(typeof update !== 'object') {\n      return (val) => this.onChange(val, [].concat(path, [update]))\n    }\n    this.props.editNode(update, path)\n  }\n\n  renameNode = (targetModuleKey, targetNode) => {\n    return (newName) => {\n      newName.name = cleanString(newName.name, {'.': '', '\\\\': '', '|': ''});\n      this.props.renameNode(targetModuleKey, targetNode, newName);\n    }\n  }\n\n  copyNode = (targetModuleKey, targetNode) => {\n    return () => {\n      this.props.copyNode(targetModuleKey, targetNode);\n    }\n  }\n\n  pasteNode = (selectedModuleKey, takenKeys, selectedState, selectedStateTransition) => {\n    return () => {\n      let key = findAvailableKey(createSafeKeyFromName(this.props.clipboard.name), takenKeys);\n      let newState = _.cloneDeep(this.props.clipboard);\n      this.props.addNode(selectedModuleKey, key, newState, selectedState, selectedStateTransition);\n    }\n  }\n  \n  changeStateType = (targetModuleKey, targetNode) => {\n    return (newType) => {\n      this.props.changeStateType(targetModuleKey, targetNode, newType);\n    }\n  }\n\n  addTransition = (targetModuleKey, targetNode) => {\n    return (transitionType) => {\n      this.props.addTransition(targetModuleKey, targetNode, transitionType)\n    }\n  }\n\n  newModule = (takenKeys) => {\n    return (module = getTemplate('Module.Blank')) => {\n      let key = findAvailableKey(createSafeKeyFromName(module.name), takenKeys);\n      this.props.newModule(key, module);\n      this.props.push('#' + key)\n    }\n  }\n\n  addNode = (selectedModuleKey, takenKeys, selectedState, selectedStateTransition) => {\n    return () => {\n      let key = findAvailableKey(createSafeKeyFromName('New State'), takenKeys);\n      let newState = {...getTemplate('State.Simple'), direct_transition: key };\n      this.props.addNode(selectedModuleKey, key, newState, selectedState, selectedStateTransition);\n    }\n  }\n\n  startTutorial = (steps) => {\n    return () => {\n      this.joyride.reset(true);\n      this.setState({joyride: {run: true, steps}})\n    }\n  }\n  renderAddStateButton = () => {\n    if(this.props.selectedModuleKey){\n      return <button className='button-clear' data-tip='Add a state to this graph.' onClick={this.addNode(this.props.selectedModuleKey, Object.keys(this.props.module.states), this.props.selectedStateKey, this.props.selectedStateTransition)}> + Add State </button>\n    }\n    return <div/>\n  }\n\n  renderUndoButton = () => {\n    let className = 'button-clear';\n    if(!this.props.undoEnabled){\n      className+=' disabled'\n    }\n    return <button className={className} data-tip='Undo' onClick={() => this.props.undo()}> Undo</button>\n  }\n\n  renderRedoButton = () => {\n    let className = 'button-clear';\n    if(!this.props.redoEnabled){\n      className+=' disabled'\n    }\n    return <button className={className} data-tip='Redo' onClick={() => this.props.redo()}> Redo</button>\n  }\n\n  renderDownloadButton = () => {\n  }\n\n  renderUndoButton = () => {\n    let className = 'button-clear';\n    if(!this.props.undoEnabled){\n      className+=' disabled'\n    }\n    return <button className={className} data-tip='Undo' onClick={() => this.props.undo()}> Undo</button>\n  }\n  \n  renderDeleteButton = () => {\n    let className = 'button-clear';\n    if(!this.props.selectedStateKey){\n      className+=' disabled'\n    }\n    return <button className={className} data-tip='Delete State' onClick={() => this.props.selectedStateKey && this.onChange(`${this.props.selectedModuleKey}.states.${this.props.selectedStateKey}`)({val: {id: null}})}> Delete State</button>\n  }\n\n  renderCopyButton = () => {\n    let className = 'button-clear';\n    if(!this.props.selectedStateKey){\n      className+=' disabled'\n    }\n    return <button className={className} data-tip='Copy State' onClick={this.props.selectedStateKey && this.copyNode(this.props.selectedModuleKey, this.props.moduleState, Object.keys(this.props.module.states))}> Copy State</button>\n  }\n\n  renderPasteButton = () => {\n    let className = 'button-clear';\n    if(!this.props.clipboard){\n      className+=' disabled'\n    }\n    return <button className={className} data-tip='Paste State Here' onClick={this.props.clipboard && this.pasteNode(this.props.selectedModuleKey, Object.keys(this.props.module.states), this.props.selectedStateKey, this.props.selectedStateTransition)}> Paste State</button>\n  }\n\n  renderStateEditor = () => {\n    if(this.props.module){\n      return <StateEditor\n        moduleName={this.props.module.name}\n        helpFunction={this.startTutorial}\n        renameNode={this.renameNode(this.props.selectedModuleKey, this.props.moduleState)}\n        changeType={this.changeStateType(this.props.selectedModuleKey, this.props.moduleState)}\n        copyNode={this.copyNode(this.props.selectedModuleKey, this.props.moduleState, Object.keys(this.props.module.states))}\n        addTransition={this.addTransition(this.props.selectedModuleKey, this.props.moduleState)}\n        state={this.props.moduleState}\n        otherStates={this.props.moduleStates}\n        onChange={this.onChange(this.props.selectedModuleKey)}\n        displayAttributes={this.leftNavClick('attribute')} />\n    }\n    return <div/>\n\n  }\n\n  renderDownload = () => {\n    if(this.props.module){\n      return <Download module={this.props.module}\n        visible={this.props.downloadVisible}\n        onHide={this.props.hideDownload}/>\n    }\n    return <div/>\n  }\n\n  renderLoadModule = () => {\n    return <LoadModule modules={this.props.modules}\n          library={this.props.library}\n          visible={this.props.loadModuleVisible}\n          onHide={this.props.hideLoadModule}\n          push={this.props.push}\n          welcome={!this.props.module}\n          newModule={this.newModule(Object.keys(this.props.modules))}\n          />\n  }\n\n  loadSelectedModule= (key) => \n  {\n    let val;\n    Object.keys(this.props.library).forEach(option => {\n      if (this.props.library[option].name === key)\n      {\n        val = option;\n      }\n    })\n    if (val !== undefined)\n    {\n        this.props.push('#' + val);   \n    }\n  }\n\n  renderModulePropertiesEditor = () => {\n    if(this.props.module){\n      return <ModulePropertiesEditor\n              module={this.props.module}\n              onRemarksChange={(remarks) => this.props.editModuleRemarks(this.props.selectedModuleKey, remarks)}/>\n    }\n    return <div/>\n  }\n\n  renderModuleGraph = () => {\n    if(this.props.module){\n      return <ModuleGraph\n            module={this.props.module}\n            fullscreen={!this.props.modulePanelVisible}\n            onClick={this.props.selectNode}\n            selectedState={this.props.moduleState}\n            selectedStateTransition={this.props.selectedStateTransition}/>\n    }\n    return <div/>\n  }\n\n  onPanelResize = (event, data) => {\n    this.setState({...this.state, panelWidth: this.state.panelWidth + data.deltaX})\n  }\n\n  onPanelResizeDone = () => {\n    this.props.refreshCode();\n    if(this.state.panelWidth <= 250){\n      this.setState({...this.state, panelWidth: 250});\n      this.leftNavClick('hide')();\n    }\n  }\n\n  renderPanelContent = () => {\n    switch(this.props.selectedModulePanel){\n      case 'info':\n        return this.renderModulePropertiesEditor();\n      case 'state':\n        return this.renderStateEditor();\n      case 'statelist':\n        return <StateList selectedState={this.props.moduleState} states={this.props.moduleStates} onClick={this.props.selectNode} />\n      case 'code':\n        return <JsonEditor onChange={(value) => {this.props.jsonEdit(value)}} module={this.props.module} refreshCodeFlag={this.props.refreshCodeFlag}/>\n      case 'attribute':\n        // The attribute list does not show attributes that are referenced \n        // for example BMI is not in the attribute list in the Metabolic Syndrome Standards of Care Module but the state 'Obese Check' uses BMI in the transition\n        return <AttributeList attributes={this.props.attributes} selectedState={this.props.moduleState} modules={this.props.modules} states={this.props.moduleStates} onClick={this.props.selectNode} module={this.props.module} editor={this.props} loadSelectedModule={this.loadSelectedModule}/>\n      case 'warning':\n        return <WarningList warnings={this.props.warnings} selectedState={this.props.moduleState} onClick={this.props.selectNode} />\n      case 'related':\n        return <RelatedList related={this.props.relatedModules} selectedState={this.props.moduleState} onClick={this.props.selectNode} />\n      default:\n        return <div/>\n    }\n  }\n\n  renderStateButton = () => {\n    let className = '';\n    let onClick = this.leftNavClick('state');\n    if(this.props.selectedModulePanel === 'state'){\n      className = 'Editor-left-selected';\n    } else if(!this.props.moduleState){\n      className = 'Editor-left-disabled';\n      onClick = () => {};\n    }\n    let dataTip = 'View currently selected state.'\n\n    if(this.props.moduleStates){\n      dataTip += ' Please selected a state in the graph, state list, or attribute list.'\n    }\n\n    return <li className={className}><button data-tip={dataTip} onClick={onClick}><img src={StateButton} alt=\"\"/></button></li>\n  }\n\n  renderStateListButton = () => {\n   let stateCount = <span className='Editor-button-count'>0</span>\n   if(this.props.moduleStates.length > 0){\n       stateCount = <span className='Editor-button-count'>{this.props.moduleStates.length}</span>\n   }\n   return <li className={this.props.selectedModulePanel === 'statelist' ? 'Editor-left-selected' : ''}><button data-tip='Searchable list of states.' onClick={this.leftNavClick('statelist')}><img src={StateListButton} alt=\"\"/>{stateCount}</button></li>\n\n  }\n\n  renderAttributesButton = () => {\n   let attributesCount = <span className='Editor-button-count'>0</span>\n   if(this.props.attributes.length > 0){\n     attributesCount = <span className='Editor-button-count'>{this.props.attributes.length}</span>\n   }\n   return <li className={this.props.selectedModulePanel === 'attribute' ? 'Editor-left-selected' : ''}><button data-tip='Attributes set in this module.' onClick={this.leftNavClick('attribute')}><img src={AttributeButton} alt=\"\"/>{attributesCount}</button></li>\n\n  }\n\n\n  renderWarningButton = () => {\n   let warningCount = <span className='Editor-button-count'>0</span>\n   if(this.props.warnings.length > 0){\n     warningCount = <span className='Editor-button-count Editor-button-count-warning'>{this.props.warnings.length}</span>\n   }\n   return <li className={this.props.selectedModulePanel === 'warning' ? 'Editor-left-selected' : ''}><button data-tip='Problems in module that need to be resolved.' onClick={this.leftNavClick('warning')}><img src={WarningButton} alt=\"\"/>{warningCount}</button></li>\n\n  }\n\n  renderRelatedModulesButton = () => {\n\n   let relatedCount = <span className='Editor-button-count'>0</span>\n   if(this.props.relatedModules.length > 0){\n     relatedCount = <span className='Editor-button-count'>{this.props.relatedModules.length}</span>\n   }\n   return <li className={this.props.selectedModulePanel === 'related' ? 'Editor-left-selected' : ''}><button data-tip='Related modules, such as those that share attributes. ' onClick={this.leftNavClick('related')}><img src={RelatedButton} alt=\"\"/>{relatedCount}</button></li>\n\n  }\n\n\n  leftNavClick = (nav) => {\n    return () => {\n      if(nav !== 'hide' || (nav === 'hide' && this.props.modulePanelVisible)){\n        this.props.changeModulePanel(nav);\n      } else if (nav === 'hide') {\n        if(this.props.selectedStateKey){\n          this.props.changeModulePanel('state');\n        } else {\n          this.props.changeModulePanel('info');\n        }\n      }\n    }\n  }\n\n  renderNav = () => {\n    return(\n      <div className='Editor-top'>\n        <img src={SyntheaLogo} className='Editor-top-logo' alt='Synthea Logo'/>\n        <div className='Editor-top-title'>Synthea Module Builder</div>\n        <div className='Editor-top-open'>\n          <button className='button-clear' onClick={this.newModule(Object.keys(this.props.modules)).bind(this, undefined)}>New Module</button>\n          <button className='button-clear' onClick={this.props.showLoadModule}>Open Module</button>\n          <button className='button-clear Editor-top-download' onClick={this.props.showDownload}>Download</button>\n        </div>\n        <button className='button-clear Editor-top-help' onClick={this.startTutorial(BasicTutorial)}> ? </button>\n        <NavTabs selectedModuleKey={this.props.selectedModuleKey}\n                 modules={this.props.modules}\n                 onChangeModule={(key) => this.props.push('#' + key)}\n                 onCloseModule={(key) => {this.props.closeModule(key)}}\n                 />\n              \n      </div>\n    )\n\n  }\n\n  renderMainEditor = () => {\n\n    if(!this.props.module){\n      return <img className='Editor-loading-logo' src={LoadingLogo} alt='Loading'/>\n    }\n\n    return (\n      <div className='Editor-main'>\n\n        <div className='Editor-action-bar'>\n              <RIEInput className='Editor-top-module' value={(this.props.module && this.props.module.name) || 'Untitled'} propName=\"name\" change={(name) => {this.props.editModuleName(this.props.selectedModuleKey, name.name)}} />\n             <div className='Editor-graph-buttons'>\n                {this.renderAddStateButton()}\n                {this.renderUndoButton()}\n                {this.renderRedoButton()}\n                {this.renderDeleteButton()}\n                {this.renderCopyButton()}\n                {this.renderPasteButton()}\n                {this.renderDownloadButton()}\n\n             </div>\n        </div>\n\n        <div className='Editor-left'>\n         <ul>\n        <li className={'Editor-left-fullscreen' + (!this.props.modulePanelVisible ? ' Editor-left-fullscreen-active' : '')}><button data-tip='Show/hide editor panel.' onClick={this.leftNavClick('hide')}><img src={FullscreenButton} alt=\"\"/></button></li>\n           <li className='Editor-left-spacer'></li>\n           <li className={this.props.selectedModulePanel === 'info' ? 'Editor-left-selected' : ''}><button data-tip='Module Properties.' onClick={this.leftNavClick('info')}><img src={InfoButton} alt=\"\"/></button></li>\n           {this.renderStateButton()}\n           <li className='Editor-left-spacer'></li>\n           <li className={this.props.selectedModulePanel === 'code' ? 'Editor-left-selected' : ''}><button data-tip='Directly edit module JSON.' onClick={this.leftNavClick('code')}><img src={CodeButton} alt=\"\"/></button></li>\n           <li className='Editor-left-spacer'></li>\n           {this.renderStateListButton()}\n           {this.renderAttributesButton()}\n           {this.renderWarningButton()}\n           {this.renderRelatedModulesButton()}\n\n\n         </ul>\n        </div>\n\n        <div className='Editor-panel' style={{left: this.props.modulePanelVisible ? 50 :  -this.state.panelWidth, width: this.state.panelWidth}}>\n          <div className='Editor-panel-content'>\n            <button className='Editor-panel-minimize button-clear' onClick={this.leftNavClick('hide')} ><img src={MinimizePanel} alt=\"\"/></button>\n            {this.renderPanelContent()}\n          </div>\n\n          <Draggable\n             axis='x'\n             onDrag={this.onPanelResize}\n             onStop={this.onPanelResizeDone}\n             bounds={{left: -250, top: 0, right: Infinity, bottom: 0}}\n            >\n            <div className='Editor-panel-resize' style={{left: this.originalPanelWidth - 8}}></div>\n          </Draggable>\n\n         </div>\n\n\n\n        {this.renderModuleGraph()}\n\n\n      </div>)\n\n  }\n\n  render() {\n\n    return (\n      <div className='Editor'>\n\n        <ReactTooltip\n          className='react-tooltip-customized'\n          effect='solid'\n          delayShow={800}\n          />\n\n        { this.renderNav() }\n\n        { this.renderLoadModule() }\n        { this.renderDownload() }\n\n        { this.renderMainEditor() }\n\n\n        <Joyride\n          ref={c => (this.joyride = c)}\n          showOverlay={true}\n          showSkipButton={true}\n          showStepsProgress={false}\n          type={'continuous'}\n          steps={this.state.joyride.steps}\n          run={this.state.joyride.run}\n          autoStart={true}\n          debug={false}\n          allowClicksThruHole={false}\n          keyboardNavigation={true}\n        />\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n\n  let selectedModuleKey = state.editor.selectedModuleKey;\n\n  let loadModuleVisible = state.editor.loadModuleVisible;\n\n  if(!selectedModuleKey){\n    loadModuleVisible = true;\n  }\n\n  let module = state.editor.modules[selectedModuleKey];\n\n  let moduleStates = selectedModuleKey && extractStates(module);\n  let moduleState =  moduleStates && moduleStates.find(s => (s.name === state.editor.selectedStateKey))\n\n  let undoEnabled = state.editor.historyIndex < state.editor.history.length - 1;\n  let redoEnabled = state.editor.historyIndex > 0;\n\n  return {\n    module,\n    modules: state.editor.modules,\n    library: state.library.modules,\n    selectedModuleKey,\n    moduleState,\n    moduleStates,\n    selectedStateKey: state.editor.selectedStateKey,\n    selectedStateTransition: state.editor.selectedStateTransition,\n    loadModuleVisible: loadModuleVisible,\n    downloadVisible: state.editor.downloadVisible,\n    selectedModulePanel: state.editor.selectedModulePanel,\n    modulePanelVisible: state.editor.modulePanelVisible,\n    warnings: state.analysis.warnings,\n    relatedModules: state.analysis.relatedModules,\n    attributes: state.analysis.attributes,\n    undoEnabled,\n    redoEnabled,\n    refreshCodeFlag: state.editor.refreshCodeFlag,\n    clipboard: state.editor.clipboard\n  }\n}\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n  selectNode,\n  addNode,\n  addStructure,\n  addTransition,\n  editNode,\n  renameNode,\n  copyNode,\n  changeStateType,\n  newModule,\n  loadLibrary,\n  showLoadModule,\n  hideLoadModule,\n  showDownload,\n  hideDownload,\n  refreshCode,\n  editModuleName,\n  editModuleRemarks,\n  changeModulePanel,\n  jsonEdit,\n  closeModule,\n  undo,\n  redo,\n  push\n}, dispatch)\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Editor);\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAADF0lEQVRIiZ3WS4iVZRgH8N8cx+N4osuMkqPZFbEb4aIUwkVWEAUtohZR7oISiqJNi0gwsILatLCCcBPZbREFbaTMRYRdKRcVJdaohVE5MzmHUU9NZ74Wz/M535w5M874h5dzznt5/s/l/z7v6XFmNLABd2AT1mApjuN7fIS9+AH/zsNeV1yNl3AMBVoYwV9J1MYkfsIT6D8bkpvxdRI08Rm24i7chs14MSNpYwJv4dKFkFyPb5LkFzyKVah37GuIqJ/H37l/Fy6cD8lyvJuHfsQtWHyGM+emM8dFZE9iyVwHevAA/kkP7+xYX4SLsQ5rk6BEHU+ngwdxw1xEg9idm18xPVXnYwv2YQgH8DKurey5DF/l+a1zRXUjfsUYbq/MN/CMEEVRGRP4Atd1iWovVs5GdB9OCiVdXpnfJCRddBlt7BB3i1DkWEZ9ZWmgVjHWg/PSqzFxZwgh3Jpr3VATl3kgfw9jXKR6SXVTlaiWn+30ttyzqmNvJ1aYUmZ5tifHDKJJUYOJ9L705j8cMrfEj+JUfh8QahwX6p1BBIcxKuqzpuLhBzgyC0khOsKIkP/GdHQoHe+KlfgwD++oRFHDgxlZVQhNvC1SB5fgS5GdbWZ2ktNYlAab4sJWJV4X/e910Z724DFclOt9eEqk+mesn42kxCDeS4+/S7K+ynq/6A6D6M25hugoo6Iu2zvOzIqNopkW+A2P4IKMuIrFoqk+J2pU4BNT9T2N3s6JRFs0SFgtnoO78T6+FYpaIRruPbginWiKbAzNJ5rVeE0U9JAQx4iQfSFe0ZaoRVUYkzn24CYdQijluBx/iFw/jIfS4At4Fp+K/Pcm4Xj+3i+EcQofiza0IceweOpJ9e5Lr9fhXvyeHu40/QE7R4jgGtFE12b6lglZ9+N+cXmLtHmVqNdmmYYW3jH1dO9OgwtFHY+LVJ/Am2l3v0xBmfsCn4t0ni0G8Kqp/xF/4ljN9C49IR60UTOlPF9MiielJWral3MOm66cYbwh7sdCURdCOpK2SpvNXnFflmY0LdHXyrFQ1MQ71BAd4qTIzOj/E7fg3rTP7r4AAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAaCAYAAAAwspV7AAAAs0lEQVRIie3UMQrCQBCF4S9h8SzxRKbQ0lYrxcYL6BXsbPSEQhotNBBCAmuzSbE/TLGzA/uYfbxiWVULXLFGgTsOaOp6BR6Pp5QEXLDr9HZ44dSbfacSVWIz0N+mEjBEOeXjY5S+HupzG+gVqSrg+Du033jHuaumNXwqAhrsfzULQuotxDBLoxfLqhq9nGqLAaOJ3g7lRJcTPZ6c6LHkRI9llkbPif6PqJzoMczS6DnRY/kAyfw0NPNHfbAAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAYCAYAAAB0kZQKAAABmklEQVRIibWWy3HCMBCGv3HSgFtwC0kJaYEWSAlQgiiBXHNzSoBrbqQEuOZmX7mRA1q0XkvyiJh/RjO2tI9f2ocEY6yAC1BH1v4DsdsBLznBNy+4m5kAQAMcFZEmJXicEpiBSEdmo84vugcREEhYLlxPfoDOj7lzIQYJyzbGbhvT8HB+/aKGPTWn1nIJqJP0hh2J4zEOnJKVIY7sfC60DSYkMtElFGI4GEc6zjvCca8yNgYyS8rLUnSE/NTOY2hFpyIk4qnAwAfQ+2/R3wPrAhvir6kIPaGEBMCX+S8hAGET6JMoxT5ltBTVvYqMk255p53+XhKOcQ9YFNq45WIVmYxhSdhpSziFNSEMDfmStJBN9BC6XKpEdWPRQ7qrM/NCdkU+RFLaDYSaTzWrGInWyBwiMrm+IU+GI8AzIctrv2iz/gS8E0r5h3F5vhqHPbBJEIAQioGd6K32QIi/QXLrW+3RV/mCeEipmXjxzAjJn+g1r2/CklIrgfjIXnT6TVDafKYgVXawC0/m/xM4c62Ab+B3ZiJwrbSznvgDPlufbtfHeLcAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAA5ElEQVRIib3WPQqDQBCG4dc0Qq6Rg6XzXjlDevEIghcQBGtbK9OsYUn8mU/HXRgIMpMHx12dDH3lwDP8fgHjgf8wrztQAlOIMlxLgl2KrmGXoHuYK2rFXNA1bACqEIMXunVndZRXr+RI6F4bLaAZtTyzJspvdnI3UesGaaOa1pC/iCq7UQX/0FzAJqCPwF6oK4NFIRTNx2JeS8diK4rbb29TLLWl8edoFOq+LQX9FTagtfP0TlXC5Sy6YFa0Ax4hurOYBa2ivMoDs6DvEG6YBXXHVDTpXJN0cks6m8pYdgA9Nep/AHdVY2hvGCEdAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAbCAYAAAAULC3gAAABYElEQVRIie2XTU7DMBCFP1dZItFLVGHFujs2CAmxZMdFKBdo4TBhxx04AItyiqgpe7OwKyZR4njCgCrEk0aa+PfZHr+JIWABVMAO8Ea2i2MuALz3WQZQArUhka7VQKkhVP0gmYNVuYQcsAdO4tG9AS/Y4Bo4j37jvT/N7ShXsjIiA7CRY+fu0MyQgAn+PiF5W6bg6HYIdEE9KqBih7LK6QiohlCWgE4g1BJQzZGtgbmivRZzYF0oOlwJP0dAX4FlT/lT51sK6CWMHNnAVq+GbpMo7xXGHrTaFcAHX6njLlakVgRwATxG/15WOOcO7o0obvqYDCGZXL8RpK3kmph/02nLGYnbY0CojnNkEZoBW0LwPRMyvxX2ccxlnCMLRVzlO3CrmOxB+G6w1QRorn0LInhNcXS57J/QGDQxNCagU9EWUMXz5FdeJxpCSQE1sCCgmgcc4Z+oIuQmKyJNHLME+AQWCT3RvS5INwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAAAmCAYAAADz9XSfAAAC00lEQVR4nO2c4XnaMBRF7+NjAEagGzgbOBuQDcgGdAM6QbMBbJBskGwAGyQblA1uf8hNhbAtbPSeGtV3AB0ONu9JnyQApZBckHwlWWsxWphLkgcrXsAuy5dkRfIXXWoVyCVz9YdpwQvYFcl3Y99azZfkmuepk0MumVsfqM0L2Dl8Nyq+TTnZ8TJ1Mkg78zkEavFa+OX4sqnNLUJqUnQlrJWpwQvYi6J86dVmKym6EtbJTM0L2Dl8V33MWwffdA2sJUXyZwyYkhewc/huY8CxA7fWZk0p/p3CR5OC18LeFePLntqsJcXzKXx6qX52X7//er6M1GYNKV5O4dNK9bNz+Q5iDhk8WptTS/H6EjZO6t/zjfb7tsyvGHgB4BnA6A83NA3zFUBlxQzYOwArY+Zo31lk8ArAAbYPsAbwjjwPsIL7Mi0fYIUbfTsfIsk1nNBy7OBDQ3LTMBdWTI+9hvGvv2EeoOE7tjZ3pL6CN2QKH83/5jsPB4f927iE67m5+p91v18ise9nOWWC2jw0JFdw5SRX/8vR75P7zprB19CqzR0huYV7I3P1vwMK6fdzkjsA69QDd4UZpvABvzjf3iXGlK+RmYg8Ani0AorISUQeAPywYgb8XL7ftRizBrQHcAfgpAUKIyJbAA+WTI+9h/P9MGQ+AbiHgu9nORWRI4BvAI6pIV0RkRe4L9OM6bGPDfvNkPkGBd+zntj89O8APKWE9EVEPuDe0L0V02OfROQepfpyxJZIR+oBzGt2zqP5Qr6Dt9naEoMM2pzsyNVSDTN2huU2qbjvkA3gFL7+Gd1R6V1iZOwbpr3ZYx/hSt2LMfMm3+g60esbZksCrzfvrZgB23QJZDoX4XQ8w8pX53iGB5kOSpXgy+nIYjm+nA4PW/jqHB4OINMxfn1fvWP8HmS6UFOCL6erbeX4crpkWhswdS6ZBpDpurc+s1b3ZWl/RBBnZ/P9DWNXeLt4JWYKAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAgCAYAAADud3N8AAABr0lEQVRIib3WsWsUQRTH8c/OnTZRBIkWOUFLG0FjFUgrpLOz0NZ/QNDeXhQbQSxSCVrY2KSwUIgWIgqBNEoOxYhaGS8RxEIuFrsLlzV3mbm97A9esfB+7/tmZuftZuKU4SzmcRodtPEXX/Eer7CC7ciaQzWNm1gviu0V60X+9DiwFm5gKxJWja3C34oFHsfymLBqLBf1RuoEuhMCltEt6u6qQ1iNLHQfl3AvMn+1qP+fFiMLfKr4Pkb6FqvAuYTt+jnQ9RQ2Erxzg9ClBGN5Tg+xluhbKoEd9BPN40YfnYAF+cRpQhkWAmYTjZuFuYzNRP9skG9vk+oEHG4YOhXQaxj6I8gvd5P6HvC6YegbOILf4u9a9Th6Cd4+ZoL8lX+0b+vaqef4Vj6cwp/Ibuus9GK1i+sJ5t5AxHre2WXyZXiSUCR15u74wgzqIJ7uA/T2MGCpFm6Z3JfnJQ7sBS01j7c1gV0ciwWWynABj/ErEfgZJ1OBVbVxDldwTT7JhgE/GPEHWEd3hwBf4OgoY5hwI3fkx7ExKqk9IdgXXMWzmOS6K93GA5yJBdbVZZwfx/gPjrmEGhKRqqEAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAZCAYAAADNAiUZAAABn0lEQVRIic2WwXHCMBBFnzM0QAu04JSQlAAlQAlwk3SDElAJSQmhBFwCtOAS4CAJ1kISdkxm8mc8I9kr/d2V9nsr0pgDS+DDzy2wShkarW5jpc0MOInPG+DbaHWWa94S+6yBL0E4Blvg6J15SvpKTHGZu2ESGcy8UcAG2PXd3aexAlDa/HDPVi3t4khn0dz2JUzgkNs3lV6JdgSpXCuz95T0T1AiHRNlcX3pTEuke+ACXJQ2F6VNqrx6p1fesqZA2gdSEKbSMUm69M9LSH35SOJtEIkJLqWnaE3DgPosYAEc/bgGTkobW2VIq767Su1NQWmzxslhgM3d3mPm/SAobeqIEHBnGqRL/kVquuf7W+zFuAHejVYrGamlK3uj/jI+SlkNK6NVA48lI29srMNDIWuzDYQp0k5tFTZc0hWHlINZofl32luKNMYgnX4FaWu0SpHK9cUe6RzNc2VjuSvWIf6otHloUSTiduWMS1Xwcu+fuBuceodaQZ7qBgM6Op5Kbx/NneMi/JSlkEFL1PbkSBck0iZgvc0zwh1OhTrHdgUMPHWH6hjEpwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABKUlEQVRIieWVzW3DMAxGn4Au4BW8QlbwClnBK2SFrpAV2hG8QlZQR/AKzKEMKsQ0TCoSeggBHgxIfvz7KPgnS+WHiPSBpHQGRuAb+NkcEJGmDsxABkR9erA+OmQ3KHDWLE1rBi6AF2A4Ov8yOKU0KuzsAZoW7N8IXPnrn8cnA+sD6+UlCBQN0q6IY0KjwIz2vPiPD8xWEh6/AfPO//bBWpJLBfAKTAeVM+0BXAOwFfgERueM2EkHPGsbBg+wBXg5KmdrcPaWs0fGK78zUB3AK6UuJ/jUClyzlRZ2NFuj4xPxPbzZUmFwcajmIVj1jjkHLrCxySKLRYAvnqQXAjdYpRmdgyrwUxA1j0f9e7wTgFcJ7cBFAB4ptgc7pdgPfCDF/mBDCYtW403tDn5nUb6eK9JxAAAAAElFTkSuQmCC\"","// @flow\nimport React from 'react';\nimport { Provider } from 'react-redux'\nimport { Route, Switch } from 'react-router-dom'\nimport { ConnectedRouter} from 'connected-react-router'\n\nimport createAppStore, { history } from './store';\nimport Editor from './containers/Editor';\n\nimport { openModule } from './actions/router';\n\nconst store = createAppStore(history)\n\nconst App = () => {\n  return (\n    <Provider store={store}>\n      <ConnectedRouter history={history}>\n        <Switch>\n          <Route exact path=\"/\" component={Editor} />\n        </Switch>\n      </ConnectedRouter>\n    </Provider>\n  );\n}\n\nconst dispatchLocationChange = location => {\n  if(location.hash.charAt(0) === '#'){\n    store.dispatch(openModule(location.hash.slice(1)));\n  }\n}\n\nhistory.listen(dispatchLocationChange);\n\ndispatchLocationChange(history.location);\n\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport '../node_modules/bootstrap/dist/css/bootstrap.min.css'\n\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// Do not use service workers because they cause unexpected behavior and we\n// are not interested in offline modes currently. Unregister to clear out\n// previous registered service workers for people that have already visited\n// the app.\nserviceWorker.unregister();\n"],"sourceRoot":""}